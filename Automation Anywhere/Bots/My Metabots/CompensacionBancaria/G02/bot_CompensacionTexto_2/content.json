{"nodes":[{"uid":"b55535ac-17f3-4764-bdcb-67f252c1c314","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"2dc104f8-f354-45d4-bf41-9587348ce780","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"3ae1ead9-4409-4485-9c6b-d52b99d93c0c","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Tasks\\ConBanc\\Logs\\logfile.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogFile"}},{"uid":"ecdfeaf6-5ae4-41b0-b1b6-b2effc7b2ac4","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogFile"}},{"uid":"a30d11f5-4a56-45c6-a70c-0327992c53e8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------"}}]},{"uid":"b9e26e07-4a92-4dbe-8531-00147da40233","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"b9591c1d-7fb7-494c-85d0-62ad6613da42","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Conexion a la BD"}}]},{"uid":"160773a4-5a68-402b-8c9b-47d2ef43fff8","commandName":"connect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Persist Security Info=False;Extended Properties=\"DSN=PostgreSQL35W;DATABASE=rpa-desa;SERVER=10.100.14.49;PORT=5432;UID=postgres;SSLmode=disable;ReadOnly=0;Protocol=7.4;FakeOidIndex=0;ShowOidColumn=0;RowVersioning=0;ShowSystemTables=0;Fetch=100;UnknownSizes=0;MaxVarcharSize=255;MaxLongVarcharSize=8190;Debug=0;CommLog=0;UseDeclareFetch=0;TextAsLongVarchar=1;UnknownsAsLongVarchar=0;BoolsAsChar=1;Parse=0;ExtraSysTablePrefixes=;LFConversion=1;UpdatableCursors=1;TrueIsMinus1=0;BI=0;ByteaAsLongVarBinary=1;UseServerSidePrepare=1;LowerCaseIdentifier=0;D6=-101;XaOpt=1\""}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f7b766db-cfe0-457f-bdfd-75d7d88586d7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Realiza la unión completa entre todas las tablas."}}]},{"uid":"d247c283-71fe-46f4-acfb-64d58247083e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"SELECT * FROM $vTableNameA$ T1\nunion\nSELECT * FROM $vTableNameB$ T2\nunion\nSELECT * FROM $vTableNameC$ T3"}}],"returnTo":{"type":"VARIABLE","variableName":"vQuery"}},{"uid":"ddc78b21-dcd4-4e2a-85d4-94f4c47e60d4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vQuery.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vQuery"}},{"uid":"b866abdd-0fb9-4e8f-8aea-6507808ac851","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo la cantidad total de registros para luego crear un array y"}}]},{"uid":"5f3a191f-f559-4e42-a943-b05b3924d497","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"almacenar los numeros de boleta y texto "}}]},{"uid":"02507f13-dd57-40de-86da-92bbfc3a01be","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"con la finalidad de poder obtener luego ese movimiento para compensar."}}]},{"uid":"822b60a4-a357-43b3-b8ff-c223a080d7f7","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"2e986fc0-2d16-4970-8390-e5880e140564","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"9a279cef-af55-4098-8668-211f5a8f74c0","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"97a38d84-f121-491b-9017-1e8b6d97a2ac","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"04bddd3b-9f90-4298-a509-b391d66154b9","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"c8c17fc3-f723-42f2-9c73-54a76f64e2d3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantTotalRegistros"}}]},{"uid":"b5215ff0-feed-456a-928f-c3bfe1dcbb07","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Inicialización de matriz (Cantidad total de registros,2)"}}]},{"uid":"82391b7b-d955-4ccf-a8d7-f98fabb4a7a8","commandName":"assign","packageName":"DataTable","attributes":[{"name":"rowSize","value":{"type":"NUMBER","expression":"$vCantTotalRegistros.String:toNumber$"}},{"name":"columnSize","value":{"type":"NUMBER","expression":"2"}},{"name":"option","value":{"type":"STRING","string":"resize"}}],"returnTo":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"uid":"c3d6a234-6b72-44b8-8444-651bb873ada1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Cantidad de registros EX a verificar"}}]},{"uid":"693db057-51aa-4459-8078-1cd4194ff3f9","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t \nwhere blart='EX';\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"fe547aa1-7c64-46aa-8670-a0cb225c318c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"d6ea7654-d9b7-4afb-a27b-5ecb17c36974","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"fceccf54-3edd-4b4f-8e87-c17ed36bb155","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"df01f8e9-5820-4c32-9c06-fe97eb879041","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"f23049fb-c2d5-4b29-85f8-84c178e7ad7f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantidadEX"}}]},{"uid":"0e14b9cd-1e3c-4381-9e9c-c62d93d2c119","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Cantidad de registros PS a verificar"}}]},{"uid":"8fc47f92-88db-4f3d-b291-1e7286f8f901","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t \nwhere blart='PS';\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"4eb65084-7326-4c3a-859e-f337e83bf3e5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"9de2d320-bb32-4036-ab39-cfc07d2e179f","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"ad5b47b5-52ec-427c-899a-1c42092e577d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"09a75389-ca12-482e-81f8-840481006784","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"5b366096-6ac5-4444-90ad-c867cca2613b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantidadPS"}}]},{"uid":"544bace8-cc1b-48d0-8af9-5aa8241094cf","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"036ec249-10f3-4afa-9b3b-61f388fb0042","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"################################################\nvCantidadEX = $vCantidadEX$\nvCantidadPS = $vCantidadPS$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"a0cc0196-d603-4b9a-b365-76045f119b83","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Year.Number:toString$-1"}}],"returnTo":{"type":"VARIABLE","variableName":"vAnio"}},{"uid":"a35614f0-3610-4d2b-9ca1-ac3fb61a5cd1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vAnio.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAnio"}},{"uid":"6535d86b-7664-474e-a299-d137cb2cf247","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"AND"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCantidadEX$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThan"}},{"name":"value","value":{"type":"STRING","string":"1"}}],"operatorAttribute":{"operator":"AND","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCantidadPS$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThan"}},{"name":"value","value":{"type":"STRING","string":"1"}}]}}],"children":[{"uid":"d0cb0a46-e3ab-4695-8237-58449cfbb5e2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"-----------------------------------------------"}}]},{"uid":"7e674536-36f0-4992-a853-1936df530b8a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo todas las EX ordenadas , luego recorro uno a uno"}}]},{"uid":"a5dd95e1-8b54-4f44-8991-3d364e80bfb8","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere blart='EX' \norder by bldat ASC;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"28479b17-3811-4c52-95de-7427911faea9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Pivote, para cuando encuentre que el monto total de varias PS "}}]},{"uid":"6facb23c-d817-4caf-940a-ca3457415317","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Sea igual al monto de la EX, entonces ya no tener en cuenta las mismas PS para otra EX"}}]},{"uid":"8845f6b0-e08b-4303-853a-82d772a6eafd","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"46f3e372-1356-4fbc-a976-343c59fc08aa","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"46e4bf5f-97d2-4637-978c-2f9543e00bdc","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"e7b3f4ae-0e1e-46c0-8c55-4de2ab8632ce","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"aa5a1b80-7a79-44cc-829d-1dd59b22928d","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"ed4b9077-fe48-465b-b42d-4fbf919f23c1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"3126fc01-6911-433a-a113-d81796e00c0c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFecha"}},{"uid":"fb63bf56-b34c-4a8d-a967-0ef9d8c41952","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaEX"}},{"uid":"4ec8787f-e657-46f8-a5f9-73e342bb9697","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extraer mes de Fecha de la EX"}}]},{"uid":"add52ac8-aa6e-4fd3-a84a-a2d2a5451b47","commandName":"beforeAfter","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaEX$"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":false}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes1"}},{"uid":"0b309d4a-b6fb-49e2-be22-5868e973051b","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"01"}}]}],"children":[{"uid":"0c325f88-3a71-4827-8f47-b3d427c7e0cd","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"12"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}],"branches":[{"uid":"e755d9e7-fe77-414b-8fe7-b96cb977f979","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"02"}}]}],"children":[{"uid":"4bdffa29-9cc7-46ec-8179-4857f421727e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"01"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"376882f9-fd3c-4dbe-9bf1-36a0484d1e81","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"03"}}]}],"children":[{"uid":"84328904-207c-4a89-ae4a-328673d361f4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"02"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"0bfb17ac-945e-4d7c-80c3-19eff35e36b0","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"04"}}]}],"children":[{"uid":"a18a17ba-93b6-4147-8964-d1488a696c99","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"03"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"9cc465a2-51ff-43ac-8907-33b1b9e4f822","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"05"}}]}],"children":[{"uid":"17ac4031-cd0a-4ef6-a49f-58799f02f554","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"04"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"b7d1e2d3-161c-4cb4-9d48-c4fd48caff12","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"06"}}]}],"children":[{"uid":"dfbb44d7-7b01-4485-a216-dcc1509d496d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"05"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"6e3a034d-0e38-4292-b011-58e61f100761","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"07"}}]}],"children":[{"uid":"e41c18b6-c241-47b8-82df-3b46fb4ff745","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"06"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"dd4cb6ca-3680-4b90-8c5a-23e47ed29c03","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"08"}}]}],"children":[{"uid":"d1032390-e7d1-48dc-8434-f93df47f4ede","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"07"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"fb274a8d-e2a3-4891-be60-e4335becc0a9","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"09"}}]}],"children":[{"uid":"259bf269-cd7c-47f3-bf15-afa78fdeafbf","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"08"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"56aef697-0761-40ce-82c5-6fe75cee8f71","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"10"}}]}],"children":[{"uid":"42d301fa-80a9-456b-a172-dc96ab915794","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"09"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"262b1400-928e-4ee9-a43d-fba38285f62e","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"11"}}]}],"children":[{"uid":"425d78bf-dc2e-4ed9-bbe7-8449daac087b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"10"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"b08d55b9-ce5d-420e-92a7-f3b207fa4335","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"12"}}]}],"children":[{"uid":"7a22ded0-6891-4851-85d5-8fe86274fdfb","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"11"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]}]},{"uid":"425c3ef7-bf0f-4d8d-884f-438117d9872f","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"vMes1 = $vMes1$\nvMes2 = $vMes2$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"6ca204a0-0788-4057-8a1d-64a2717410e5","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosFinal$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"25edf12a-6ed6-4de7-9354-74594236072e","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vAnio$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$System:Year.Number:toString$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}]}}],"children":[{"uid":"a3431bf0-00a4-42a3-a33d-a9f7c06959f0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"504d5f38-234d-472a-a26e-7c9b28790c1b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"658f6e4c-db8c-485a-9358-ff978a28520b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el texto(7) y número de boleta(8) de la EX"}}]},{"uid":"37f9b626-6b5f-4854-81d6-883e4babad47","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[6]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"30ee54e3-a5a0-45ff-b9e7-081c9dffc485","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"0"}}]},{"uid":"e20b863e-1769-42f8-b50a-80c0644c3f16","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"c3ee9e67-fd69-496d-80a9-73aa9b75247f","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"1"}}]},{"uid":"0a8b7637-a497-40b5-920c-00458aab283e","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"add72f55-178d-4f81-8018-c2ae1fd0edad","commandName":"setCellValue","packageName":"DataTable","disabled":true,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"2"}}]},{"uid":"713eacc9-ebe7-4572-82ca-363f7b2f46bb","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el monto y lo convierte a negativo para luego comparar con la suma de PS´s"}}]},{"uid":"7d72f632-b567-4716-ac43-12bbde5af54d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[4]$*(-1)"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"abe7ef00-4414-426f-a8a7-84011046ff1e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"a626c65d-b8e0-4b79-8542-5a4b8660f75d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo todas las PS ordenadas , luego recorro uno a uno"}}]},{"uid":"0d37cf74-81c5-4d94-980d-0bd4f9555d69","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere blart='PS' \norder by bldat ASC;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"3db731d7-665f-43c8-abf7-fbe2997a7432","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"7af120e3-93a9-4e6d-aee8-d755e7f5e5ce","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"cdf9a0e9-771e-47ca-b4ec-07fc34eeabea","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"51b14fed-c691-4b81-b710-d2dcb6120196","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"7a324b7a-3460-4edd-b1c4-c64476aee9bd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"840e3dbd-730b-4024-b4e4-2f0626c76781","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"NO DEBE DE EXISTIR"}}]},{"uid":"fcbcddac-2ae8-40fd-8d59-97d18403dc84","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFecha"}},{"uid":"b792fb7c-39b9-443c-be5b-5cf75b4db985","commandName":"beforeAfter","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":false}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes3"}},{"uid":"c473663f-8e9a-47cb-8409-889a1d362517","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\nOperator : \nOperator : 1\nValue : 1\nThen : \n\n\n\n\n\n\n\n\n"}}]},{"uid":"7e71d75b-d519-410b-a1b4-f4a3cac30cbe","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vAnio$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$System:Year.Number:toString$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}]}}],"children":[{"uid":"6c00cce4-9ecb-4c7d-9ba5-96ae9c738790","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"33d42ec9-ec0c-401a-988f-0b11691cbddf","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[4]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoPS"}},{"uid":"9643cc83-f786-49b5-bd5d-94bc3f6e0ddd","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"c4acbecd-c5f8-4470-9184-31906875465c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"93ae171d-44f3-41ec-b5c8-6444f344dd8e","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\nOperator : \nValue : 1\nThen : \n\n\n\n\n\n\n"}}]},{"uid":"085382d4-b1b0-437a-92e1-acb7f76fdb56","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"91780679-9b89-41f7-9fd5-bb3338cde5f7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"NO DEBE DE EXISTIR"}}]},{"uid":"9120d5f4-81a6-4636-aa2d-50b3a7059de7","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes3$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMes1$"}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes3$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMes2$"}}]}}],"children":[{"uid":"593a4ff0-0c4a-4bf8-991d-5d8ef7e8c7b0","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vIndice$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThanOrEqualTo"}},{"name":"value","value":{"type":"STRING","expression":"$vPosFinal$"}}]}],"children":[{"uid":"551ad0eb-e988-4e53-ac33-019d341d2d3e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$i$+1"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"eadda793-d744-4e41-b24d-e42ea5227dbe","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$i.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"2e102468-5ebb-4fe5-a392-b65b683634f9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el texto(7) y número de boleta(8) de la EX"}}]},{"uid":"d8ceebcc-590d-43f4-9f79-22f74e1f0400","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[6]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"e78b8784-dd70-482c-b8a7-6621bf551596","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"0"}}]},{"uid":"a61dd663-75b6-44fd-8604-7a5d933f01f6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"34bc654b-98cb-4e21-8222-4dc2d449b999","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"1"}}]},{"uid":"ab0a608f-0a0e-414b-bd83-46967b46c53b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"a9f7f180-72f7-4354-bcf5-da40983cc78a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Sumo el valor del registro PS y luego verifico si coicide con la de EX"}}]},{"uid":"b4db1144-c9e2-4501-8c11-ad5e10b5664d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoPS$ + $vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"161bed5a-72ed-4920-9163-5455ca5db7f8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"4bccc940-016b-4e3c-a8a6-c958e4e357f3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"9bf3dace-4e23-4f00-8b9c-03dedc86202f","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"\nvPosFinal  =  $vPosFinal$\nvIndice      =  $vIndice$\nvMontoEX = $vMontoEX$\nvMontoPS = $vMontoPS$\nvSumatoria = $vSumatoria$\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"a3f52fd0-f374-480d-86d2-600ea19d7183","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vSumatoria$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMontoEX$"}}]}],"children":[{"uid":"b2fe94b8-83f7-4e95-b227-c1a8b0815707","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"13ae1eff-991a-4d2a-9aff-d4ff839603be","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosFinal.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"7ba3a6b9-d001-4574-ae4a-1ed06ad29d75","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX$*(-1)"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"46505797-1552-4a1c-8a93-222a57210845","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"5d3c3679-8901-4089-bf96-b533fe417281","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX$ + $vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"6df7238a-2bfb-43b6-b0ba-a4b433a3d016","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"680f8331-36c5-4a79-8277-2ab3a8a7956d","commandName":"loop.commands.break","packageName":"Loop","attributes":[]}]}]}]},{"uid":"23e163ed-ae5a-4ac7-bc9c-ab38463177e4","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"dddd"}}]}]}]},{"uid":"2f35ff39-62b1-4df5-9250-2340617945c4","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Continua con el proceso, porque encontró una EX con varias PS"}}]},{"uid":"f2d183e2-8440-4cc0-85c0-89660a485df5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"1734ce75-b0c4-4e46-92bc-98d0f9aa19da","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Sumatoria de partidas : $vSumatoria$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5137bffc-183c-49bb-9ef4-5fc91e02fc14","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Sumatoria de partidas : $vSumatoria$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"8fdb8409-d586-47d0-87b3-d7b8f4833188","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"78869900-28c8-48d9-96dc-7cdfec0f997a","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDiferencia"}},{"uid":"5c4accf7-6809-4ade-8867-f64a5ad4ec61","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vDiferencia$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"0"}}]}],"children":[{"uid":"fe63e81e-7e37-4526-95bf-9b309039d747","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---- Obtiene la fecha de compensación(Fecha de la EX)"}}]},{"uid":"f71e44de-9e28-42a9-9fe2-e83111a40c62","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vAugtx"}},{"uid":"c4d93b39-43b2-4097-8138-e4ecd5222954","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaEX$"}}],"returnTo":{"type":"VARIABLE","variableName":"vBudat"}},{"uid":"16613886-c260-4917-9397-34d8b2091a5b","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vBudat$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"replaceWith","value":{"type":"STRING","string":"-"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vBudat"}},{"uid":"30ab6c12-2885-4043-a2ca-3ae9c7bb2d2e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---- Arma Json con las partidas a compensar"}}]},{"uid":"0506aa78-937d-424b-bc2d-8ce607234f1f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosicion"}},{"uid":"94d70161-77e2-42d5-ab22-4f7844b64bfb","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosicion"}},{"uid":"bd6fb9f8-38c8-4138-b0ec-2016b87cd40b","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDmbtr$"}},{"name":"find","value":{"type":"STRING","string":",00"}},{"name":"replaceWith","value":{"type":"STRING","string":""}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"574fec41-cd65-445d-830c-7da5d628c0e8","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDmbtr$"}},{"name":"find","value":{"type":"STRING","string":","}},{"name":"replaceWith","value":{"type":"STRING","string":"."}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"2444b3b3-b062-4fc9-b335-aacb695fc18e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"-------------------------------------Definir tipo de cambio a dolares------------------------------"}}]},{"uid":"a36e4be5-7bfb-48c8-a986-8acb8e16ffa1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vTipoCambio"}},{"uid":"8cbd70d2-c49a-4a12-810a-983ccceec9bf","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Recorro el vector que tiene [los números de documentos y texto](uso estos dos parámetros como pivote de selección) a compensar"}}]},{"uid":"9b6e114f-be79-454a-abd9-d95889f6c2b0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"i: El valor de i, sería la posición final en la que guardó datos en la matriz vNumeroBoleta"}}]},{"uid":"85ac1b73-bae2-4a4b-88b6-ce4d71327ebd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Entonces uso como cantidad de repeticiones en el loop."}}]},{"uid":"20e6126d-3e8c-46ea-93ed-4c7069ad9c0f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"j: Uso para seleccionar cada registro dentro de la matriz vNumeroBoleta"}}]},{"uid":"37947c9c-8dca-4a57-8180-a7d384e94f6a","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"43a18151-ee62-4522-b00d-cf598839b7aa","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"5d02e8c1-eede-4d61-9206-160fb79ebcb1","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"},"attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$i.String:toNumber$"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"9eefdf95-8b1a-45ba-8218-5ceb36ec01f1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"08772e90-143e-4be8-8a83-fba916b64a67","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Por cada loop, realizo una búsqueda específica y luego genero el proceso de armar Json a compensar"}}]},{"uid":"a028ee11-09d3-47a8-a2f3-e2dd99a7ed4f","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere sgtxt='$vNumeroBoleta[$j.LegacyAutomation:getDecrementedNumber$][0]$' and belnr='$vNumeroBoleta[$j.LegacyAutomation:getDecrementedNumber$][1]$'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"859deaa9-22ed-42ff-bb01-17fb1afa0188","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$j$+1"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"4be7dc94-823f-4b22-afd9-8569db04555b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$j.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"546c745c-8bfb-4c92-9474-d0385e910ae5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-3"}},{"uid":"c22534fa-21c7-476c-8cfa-c10241ab2eef","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"4216ce9c-f342-43a9-afac-2a44cf31aa88","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-3.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-3"}},{"uid":"fa7ada8d-b87e-45ab-be87-4771671de356","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"33869c73-9718-4176-8b86-4883687692e4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"posnr\":\"$vPosicion$\",\"saknr\":\"$Loop-Dataset-Column-2[0]$\",\"belnr\":\"$Loop-Dataset-Column-2[7]$\",\"buzei\":\"$Loop-Dataset-Column-2[10]$\",\"gjahr\":\"$Loop-Dataset-Column-2[11]$\",\"dmbtr\":\"0\",\"augtx\":\"$vAugtx$\",\"blart\":\"$vBlart$\",\"xblnr\":\"\",\"bmbtr\":\"$Loop-Dataset-Column-2[8]$\",\"kursf\":\"$vTipoCambio$\",\"bktxt\":\"\",\"budat\":\"$vBudat$\",\"zoper\":\"\"},"}}],"returnTo":{"type":"VARIABLE","variableName":"vConcatenador"}},{"uid":"8015dcf5-7ff1-4ae9-b47d-3deb5f1b8066","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vConcatenador.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vConcatenador"}},{"uid":"1a9f1e52-485f-40c4-a6dd-0eafa23a1479","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion$ . $Loop-Dataset-Column-2[0]$ . $Loop-Dataset-Column-2[7]$ . $Loop-Dataset-Column-2[10]$ . $Loop-Dataset-Column-2[11]$ . 0 . $vBudat$"}}],"returnTo":{"type":"VARIABLE","variableName":"vReportCompensadas"}},{"uid":"d0ef864d-6a35-4bd4-9b35-9e186c2b1551","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vReportCompensadas.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vReportCompensadas"}},{"uid":"de9dbc45-be26-4d13-9573-f02c6666d73e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDetailString$$vConcatenador$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDetailString"}},{"uid":"f7ded7fb-250a-4e0e-b6fc-632c0d5174db","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDetailString.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDetailString"}},{"uid":"859a8bd4-0dd0-4e84-a3e5-9fa5019d0406","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vJsonDetallexRegla$\n$vConcatenador$"}}],"returnTo":{"type":"VARIABLE","variableName":"vJsonDetallexRegla"}},{"uid":"d2ddd1dd-306b-4092-ae06-581c67e0ff7f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vJsonDetallexRegla.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vJsonDetallexRegla"}},{"uid":"46ed55b9-a4c7-4563-a116-256add4fd3d9","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas$\n$vReportCompensadas$"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}},{"uid":"7ddca266-d6fe-4578-bc7b-aba4767208a2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}},{"uid":"e41f0fd5-0130-40e3-af03-19ab4ef26f3d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[7]$,$vDoc_compensados$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"4622ec07-44f5-4cfa-a4eb-5c3dfb8ea434","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDoc_compensados.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"d73a9065-fb5f-48dc-871c-84cdd343d451","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"4ca885d8-9b67-4777-abb8-5b1c42f1acea","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$vPosicion$;$Loop-Dataset-Column-2[0]$;$Loop-Dataset-Column-2[7]$;$Loop-Dataset-Column-2[10]$;$Loop-Dataset-Column-2[11]$;$Loop-Dataset-Column-2[12]$;0;;AB;;$Loop-Dataset-Column-2[8]$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]},{"uid":"40439018-7660-4d23-8971-74aa7756a2c3","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"\n[vJsonDetallexRegla]\n$vJsonDetallexRegla$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"024579d0-e1f4-463d-b06e-dd134f35ff22","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"replaceWith","value":{"type":"STRING","string":"-"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}}]}]}]}]},{"uid":"131b216b-ab20-4fe9-9389-753dc4c89a59","commandName":"insertUpdateDelete","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"DROP TABLE $vTableNameA$;\nDROP TABLE $vTableNameB$;\nDROP TABLE $vTableNameC$;"}}]},{"uid":"bd86f437-7c5e-42fc-a242-ccc1de339911","commandName":"disconnect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"dosaveData","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"8f935276-6950-453d-a2fd-90c2d1569e8a","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"a4cf5cef-e769-43e4-a60f-d4c68bdbc33c","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Borra las tablas $vTableNameA$, $vTableNameB$ y $vTableNameC$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"8ed42199-b48e-46da-b4c8-d3a88b434d96","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"19324446-e3f9-4505-ac2a-41851bf7e299","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"a242d518-b677-4b88-9854-07b9555b15a3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"1ec363e4-10eb-497c-a5be-cffe8a3f0119","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Metabot error:\n[ $Error-LineNumber.Number:toString$ - $Error-Description$ ]"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]}],"branches":[{"uid":"75d7d60e-6ebf-43b5-89f1-005532fdf42f","commandName":"finally","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"1d3e2924-ad8a-4e6f-8639-ed75c4e5221b","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}]}],"children":[{"uid":"3dbd3270-bc0b-4a59-8980-3fb5495020bb","commandName":"throw","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vDetailString","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantTotalRegistros","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameB","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDiferencia","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vJsonDetallexRegla","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBlart","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vConcatenador","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameA","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPosFinal","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantidadEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMontoPS","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTipoCambio","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameC","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFecha","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"PartidasCompensadas","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIndice","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPosicion","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAnio","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"j","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"aMatrizPA","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vMes3","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogFile","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vNumeroBoleta","description":"","type":"TABLE","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vMontoEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vReportCompensadas","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSumatoria","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantidadPS","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"i","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDmbtr","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBudat","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vQuery","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAugtx","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDoc_compensados","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Loop-Dataset-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-2","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-3","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"M-TableCellValue","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"ErrorHandler","version":"2.10.0-20220929-040735"},{"name":"Number","version":"3.6.0-20220928-104414"},{"name":"String","version":"5.5.2-20221006-094641"},{"name":"System","version":"3.10.0-20220921-062556"},{"name":"LegacyAutomation","version":"5.6.1-20221027-080331"},{"name":"Comment","version":"2.12.0"},{"name":"Database","version":"4.10.5-20221119-112148"},{"name":"Loop","version":"3.6.0-20220928-191723"},{"name":"Record","version":"1.6.3-20220919-051027"},{"name":"DataTable","version":"4.6.0-20220920-155212"},{"name":"LogToFile","version":"3.5.0-20220416-233918"},{"name":"If","version":"3.5.0-20220928-201537"},{"name":"MessageBox","version":"3.4.0-20220416-233919"},{"name":"Boolean","version":"2.6.4-20220919-050851"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_HIGH","timeout":"0s"}}