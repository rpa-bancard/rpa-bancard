{"nodes":[{"uid":"f1cc9142-d6af-40bd-8b76-dc1c66537f15","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"c0212ae6-401c-49e2-baab-cfe070cdccff","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"ee67f34f-0a36-46fe-a70b-be0a6bcb7e33","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Tasks\\ConBanc\\Logs\\logfile.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogFile"}},{"uid":"7bdcf2fd-bc67-42bf-a639-b009a29dfbbd","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogFile"}},{"uid":"6b0ce473-de7c-4f15-acc5-be46b472624b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------"}}]},{"uid":"a84a6d30-2162-4682-97a1-e47b9c4625bd","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"662a4d40-056c-4878-8e57-cda7e4580fe8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Conexion a la BD"}}]},{"uid":"4f0e523f-fdd8-4d07-97bd-7727545b6a08","commandName":"connect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Persist Security Info=False;Extended Properties=\"DSN=PostgreSQL35W;DATABASE=rpa-desa;SERVER=10.100.14.49;PORT=5432;UID=postgres;SSLmode=disable;ReadOnly=0;Protocol=7.4;FakeOidIndex=0;ShowOidColumn=0;RowVersioning=0;ShowSystemTables=0;Fetch=100;UnknownSizes=0;MaxVarcharSize=255;MaxLongVarcharSize=8190;Debug=0;CommLog=0;UseDeclareFetch=0;TextAsLongVarchar=1;UnknownsAsLongVarchar=0;BoolsAsChar=1;Parse=0;ExtraSysTablePrefixes=;LFConversion=1;UpdatableCursors=1;TrueIsMinus1=0;BI=0;ByteaAsLongVarBinary=1;UseServerSidePrepare=1;LowerCaseIdentifier=0;D6=-101;XaOpt=1\""}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"fdf2cc0d-1b25-4ee0-8e00-e7f1bcb17e92","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Realiza la unión completa entre todas las tablas."}}]},{"uid":"d10826b1-2b73-4774-94ef-ff35ea75b075","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"SELECT * FROM $vTableNameA$ T1\nunion\nSELECT * FROM $vTableNameB$ T2\nunion\nSELECT * FROM $vTableNameC$ T3"}}],"returnTo":{"type":"VARIABLE","variableName":"vQuery"}},{"uid":"29b6d00b-8079-4f90-8163-a7095797253e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vQuery.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vQuery"}},{"uid":"8e0a3faa-02b4-4a57-9842-ca81fe881049","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo la cantidad total de registros para luego crear un array y"}}]},{"uid":"e38bd998-306d-4fe9-9a5e-868fdcafe421","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"almacenar los numeros de boleta y texto "}}]},{"uid":"ec68085c-5efb-464a-9798-6e1f8e2252a0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"con la finalidad de poder obtener luego ese movimiento para compensar."}}]},{"uid":"70e7f07c-4195-4f26-83f1-7bcbe00daa6d","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"07d7ba8b-2cd4-4737-8fdf-1cac10fb90c0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"3d101be5-5b1d-42f1-a883-8d1636d1d991","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"f77abb25-932c-4bd0-9eef-1cd396ddd644","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"29a430c9-1861-45e5-9f62-2e9bd46ca845","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"9ef43b51-85f0-4b56-9b33-3e84e94e5c7a","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantTotalRegistros"}}]},{"uid":"bf3284cb-4363-40ab-bb6e-8d7ea31904ad","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Inicialización de matriz (Cantidad total de registros,2)"}}]},{"uid":"9bc720fb-5dcf-4d85-a128-8026fcf0d6c3","commandName":"assign","packageName":"DataTable","attributes":[{"name":"rowSize","value":{"type":"NUMBER","expression":"$vCantTotalRegistros.String:toNumber$"}},{"name":"columnSize","value":{"type":"NUMBER","expression":"2"}},{"name":"option","value":{"type":"STRING","string":"resize"}}],"returnTo":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"uid":"f73222ac-6050-4de6-ad28-d743968aa359","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Cantidad de registros EX a verificar"}}]},{"uid":"e99adf30-d9fc-401e-8a43-2aa924fb0fbf","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t \nwhere blart='EX';\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"dc86cf39-7433-4a8d-8223-5c6678641848","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"0aa8443f-b457-4918-b6e8-fb14260fee94","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"7192b677-6e76-4640-83f8-fe0f4f82dd44","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"a7f7c47e-7d74-4518-93e5-1405ce89b4ef","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"f5999571-20da-4fea-a1d4-a5c5dd4cf3f1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantidadEX"}}]},{"uid":"61b538e0-0390-45e5-9c83-d97b3ca92880","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Cantidad de registros PS a verificar"}}]},{"uid":"7cee088b-e8fe-4898-81bb-b499bca978ef","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t \nwhere blart='PS';\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"26a6c79a-4ef8-47f9-a090-645b0170072b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"38de35a9-c567-4e39-bf24-750fb5907382","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"aa9264f0-fa1e-478b-9526-7397a9124d70","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"88fccf2d-4faf-4ea8-911f-6a07dd22a20a","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"7964f0e6-f6bc-4d93-a01d-8d8e2219497f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantidadPS"}}]},{"uid":"25b29109-d67f-41f9-a7dd-2c6c7d714eb9","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"172e88d1-1433-4ce1-a24e-4030a8f23d29","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"################################################\nvCantidadEX = $vCantidadEX$\nvCantidadPS = $vCantidadPS$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"cf8d85f8-9b1c-4c3e-a779-a8e8036e0192","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Year.Number:toString$-1"}}],"returnTo":{"type":"VARIABLE","variableName":"vAnio"}},{"uid":"52bf14ed-4eb9-4b6d-89ca-75ecca201963","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vAnio.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAnio"}},{"uid":"8fa2aa13-31da-46c0-b213-cd2475728131","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"AND"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCantidadEX$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThan"}},{"name":"value","value":{"type":"STRING","string":"1"}}],"operatorAttribute":{"operator":"AND","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCantidadPS$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThan"}},{"name":"value","value":{"type":"STRING","string":"1"}}]}}],"children":[{"uid":"75b36f13-8d87-43d9-aedb-7d03882f636a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"-----------------------------------------------"}}]},{"uid":"cc2e92c8-eccd-45f2-9b91-fa4e6f6d097c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo todas las EX ordenadas , luego recorro uno a uno"}}]},{"uid":"a05fc479-418b-44fc-8cd9-481a404f8359","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere blart='EX' \norder by bldat ASC;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"aa1d6612-6bca-4b70-a1c5-d8b5ebb93f30","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Pivote, para cuando encuentre que el monto total de varias PS "}}]},{"uid":"a4a35f22-eed1-4af0-8a8a-a15b08fff435","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Sea igual al monto de la EX, entonces ya no tener en cuenta las mismas PS para otra EX"}}]},{"uid":"71616e17-13cd-4752-a5d0-a8b269fbdc0b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"b0ab18f6-f624-403e-afb3-dcd37f76f643","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"0aaab833-c598-4766-aa73-8769e98cd863","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"13347c0f-e120-47d0-a399-b3dc630809e8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"3c7df50f-c2ef-4367-a15c-9bb063e5d06a","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"2e60d1f0-441c-4fa2-b640-4ca1536b29fe","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"ea7f1d99-bfe1-42fb-a928-a1beca603578","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFecha"}},{"uid":"1db65509-f234-464c-ab1b-c544bbf0d002","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaEX"}},{"uid":"b2012a7f-7d63-48a1-bf0a-e897e56fbcb3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extraer mes de Fecha de la EX"}}]},{"uid":"d8815907-8f63-4ff5-9a70-06d2c673d7aa","commandName":"beforeAfter","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaEX$"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":false}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes1"}},{"uid":"522a39f9-cd2c-41bb-8a8b-3b48899da6eb","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"01"}}]}],"children":[{"uid":"43c34329-47c7-411f-bcd4-8f149383b3cf","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"12"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}],"branches":[{"uid":"37f883c7-8ad2-40e9-8b82-2a08a500e85b","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"02"}}]}],"children":[{"uid":"d29e8cce-5ba3-420a-9f97-385a0a2c7b3c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"01"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"76fb5a2f-e791-4f2e-9938-26db5b4b640b","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"03"}}]}],"children":[{"uid":"7c1d7e82-66ec-4794-908c-96bfea546adc","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"02"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"ea235fb4-0bda-41f9-9764-33595c11fb61","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"04"}}]}],"children":[{"uid":"bf8cceee-88d5-49bc-b5e7-b5e9e1b618d9","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"03"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"cdc4810f-b476-4a77-815a-8746a013a1e3","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"05"}}]}],"children":[{"uid":"174d9d98-f6d5-4404-82f5-d7ebc2586f35","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"04"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"fc09f1b2-76d1-4dcb-9914-bb17f5563eb0","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"06"}}]}],"children":[{"uid":"3aceb403-714e-4d97-9b09-6e8fdf52d258","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"05"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"333b5507-9d8d-4341-b105-2f5406133120","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"07"}}]}],"children":[{"uid":"289fbd4b-47f0-4cc9-b1d1-755f331c45f8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"06"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"5559a0c5-b108-42d7-b1a3-e92af0228491","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"08"}}]}],"children":[{"uid":"5e7efd2b-3d90-403d-9c70-ec0bf34b0099","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"07"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"48d96116-775a-45f0-bfee-616028a54c5f","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"09"}}]}],"children":[{"uid":"84fab541-9937-4f9e-b425-668c1dcc4d4f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"08"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"e85af6ea-4a66-4cba-b402-ee344175e693","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"10"}}]}],"children":[{"uid":"9a2834ec-400e-4347-83be-b9dd6d979892","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"09"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"7639fb7b-5cf5-4282-95e7-74eecb44bc82","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"11"}}]}],"children":[{"uid":"4144cefd-1360-4a00-869c-8afe03ec5117","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"10"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"9555d172-dea6-400b-96d3-3ce9a41ba0fa","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"12"}}]}],"children":[{"uid":"a5cb1b60-47c6-4b2c-8d55-1865d3825a88","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"11"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]}]},{"uid":"3026e820-15af-47ff-905d-ef9a429f0d51","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"vMes1 = $vMes1$\nvMes2 = $vMes2$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"db605af4-8ee0-4029-b08e-af0ef13deae5","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosFinal$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"71ddda74-9168-48c0-8c1b-f310a598166b","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vAnio$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$System:Year.Number:toString$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}]}}],"children":[{"uid":"04d3981c-c761-4b5f-b3a5-1c74df9055e0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"8d3141c6-a4f5-4ea6-90be-fd4004af41d7","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"5a4dc2d6-ddd8-4981-a541-69ee35d1ad02","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el texto(7) y número de boleta(8) de la EX"}}]},{"uid":"653d4de2-995b-4331-a40d-41da6f1ef787","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[6]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"808a759e-a665-43bf-9a70-a213d8a2f270","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"0"}}]},{"uid":"3cc91271-31b0-457f-ada8-ba7c8d6b098c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"1dc42658-bbe4-4f95-b611-5d943448994b","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"1"}}]},{"uid":"5e276bd1-3113-4086-88f8-3c1ca9f7d3a5","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"228ad3d2-335e-48a6-9ef3-13ff3b7ff4b5","commandName":"setCellValue","packageName":"DataTable","disabled":true,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"2"}}]},{"uid":"070c237d-9573-461c-9147-b025af41c3bb","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el monto y lo convierte a negativo para luego comparar con la suma de PS´s"}}]},{"uid":"894d3a7a-9b29-4ecd-9329-401a5bfbff08","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[4]$*(-1)"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"dd874358-d8e2-42ff-80ee-054eccc398ee","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"9c82d34a-8d82-4ed5-bcf7-c88c2c7b3d50","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo todas las PS ordenadas , luego recorro uno a uno"}}]},{"uid":"05965c0e-1e47-4136-ba42-d5445d409767","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere blart='PS' \norder by bldat ASC;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"3e2e735e-8b01-4113-a12b-173c4be439b0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"c3e368bf-ae87-4271-b96f-6f4b7a68178c","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"3ae0d2aa-4cb6-4407-aadf-2fafc3942759","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"bda5faa5-45af-418b-8807-30a09fc36d6d","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"f7451fcd-b561-426f-b3e0-f210fa73dd21","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"5d284b94-54df-4c59-8245-673bd71d56c6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"NO DEBE DE EXISTIR"}}]},{"uid":"878d38d8-cfbb-498f-8e8e-0fcb19823ee2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFecha"}},{"uid":"5c9c6727-1cdc-43f7-bb9a-96525656d041","commandName":"beforeAfter","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":false}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes3"}},{"uid":"fb91dea5-d716-4f03-aad1-060247c5468a","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\nOperator : \nOperator : 1\nValue : 1\nThen : \n\n\n\n\n\n\n\n\n"}}]},{"uid":"764fc454-bef3-4a34-a0a8-e04d882e3a67","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vAnio$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$System:Year.Number:toString$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}]}}],"children":[{"uid":"270b4135-a443-4470-bbaf-7a1034c5ded6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"03fc81f7-b3b7-4488-85f2-c5da715f93b5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[4]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoPS"}},{"uid":"e4f25ba2-d145-430e-b651-b874739c4c92","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"dbbbb8d6-6814-4606-a0ed-401125cc5c56","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"910f6cb5-5096-42aa-9e08-73df9d566dff","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\nOperator : \nValue : 1\nThen : \n\n\n\n\n\n\n"}}]},{"uid":"eb5e286e-ddd1-48f6-b9de-e6351fe2b394","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"006699a7-e208-4467-8dad-0f4128891a60","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"NO DEBE DE EXISTIR"}}]},{"uid":"4c0ad11b-0d25-4dfa-a2e3-b48b28339410","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes3$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMes1$"}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes3$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMes2$"}}]}}],"children":[{"uid":"93f93a28-10e4-410a-89ae-1ba4ae11b35e","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vIndice$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThanOrEqualTo"}},{"name":"value","value":{"type":"STRING","expression":"$vPosFinal$"}}]}],"children":[{"uid":"60aa252e-c0e2-4b23-aaa7-59ccf028c62c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$i$+1"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"7038f166-5714-4057-bb6a-8622ddef40b3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$i.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"8d9dfe5c-8c2d-4070-ab89-9dbda8824517","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el texto(7) y número de boleta(8) de la EX"}}]},{"uid":"c9ea3997-ce8f-44c8-94c7-f6a59f49d915","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[6]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"867e9c3e-d3c2-4f51-8d63-c05bcf869da9","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"0"}}]},{"uid":"edca4e32-1d95-4139-a9d0-cbf1fb846952","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"2cfcd0bd-787b-46be-b55e-be173fc047ac","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"1"}}]},{"uid":"1fc63829-9ee5-4e9d-9a37-33a515378e74","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"6f1d67c9-8599-44cc-ab45-7d20aa883185","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Sumo el valor del registro PS y luego verifico si coicide con la de EX"}}]},{"uid":"18e53e56-aec6-481a-b8fa-9c1f7ca18b18","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoPS$ + $vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"699b4e41-0854-4489-8c68-5697d55d4482","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"d5cc270b-f74a-44bf-838c-5af16e2472f0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"c1b627dd-710f-4ddf-b2f1-4f0f0522c2be","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"\nvPosFinal  =  $vPosFinal$\nvIndice      =  $vIndice$\nvMontoEX = $vMontoEX$\nvMontoPS = $vMontoPS$\nvSumatoria = $vSumatoria$\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"bb91b701-090e-407d-9242-c7f115b5bb7f","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vSumatoria$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMontoEX$"}}]}],"children":[{"uid":"8c0b5168-6cde-4272-8f37-046c5582f885","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"11035fe0-b3c0-4548-bf69-6ff950f096c3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosFinal.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"9aa3e75d-796f-4ae3-974a-e54d687292cb","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX$*(-1)"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"1531b207-cd10-4937-b128-8acc2532e747","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"c5f264b4-ed4c-4266-b704-bc6618153851","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX$ + $vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"bd53cdf8-62d1-4254-a7f2-f14108df9c00","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"74728766-d224-4c72-a78d-8ce359d12dbe","commandName":"loop.commands.break","packageName":"Loop","attributes":[]}]}]}]},{"uid":"c96d04b1-3b76-4a2f-8472-f9b0fd34406a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"dddd"}}]}]}]},{"uid":"df777dcf-3791-4605-b598-00d49a1107d3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Continua con el proceso, porque encontró una EX con varias PS"}}]},{"uid":"742bcc78-b076-4c04-bc80-007413199b99","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"2ef47070-17f4-41d9-8687-9751537e4ac4","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Sumatoria de partidas : $vSumatoria$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"47787138-ede0-49bd-bcab-260f1dae2633","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Sumatoria de partidas : $vSumatoria$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"35f2990e-f0c9-4a09-a7b6-3756fb001f95","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"50dcafb6-c00b-4835-8deb-7c8222b2bb14","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDiferencia"}},{"uid":"a6ac24d6-213f-4afc-b066-5a4555673941","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vDiferencia$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"0"}}]}],"children":[{"uid":"b60979be-1e59-4faa-acd8-72f2afa6301f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---- Obtiene la fecha de compensación(Fecha de la EX)"}}]},{"uid":"255e1b7b-c837-48e2-ac0e-ba267a3f94e4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vAugtx"}},{"uid":"74d687ce-e2e7-416a-8e31-cd3b0804306e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaEX$"}}],"returnTo":{"type":"VARIABLE","variableName":"vBudat"}},{"uid":"51d23b84-c51f-4fcf-8fe5-c0ccf60c810d","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vBudat$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"replaceWith","value":{"type":"STRING","string":"-"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vBudat"}},{"uid":"dd65eaed-3396-4f15-be85-aa023a660d16","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---- Arma Json con las partidas a compensar"}}]},{"uid":"3163c442-dd9b-40eb-9a9b-8c7397c4f0f7","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosicion"}},{"uid":"675f0d72-71b2-4137-8c64-3d4f6519d080","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosicion"}},{"uid":"e58c7159-1ccd-4a13-8efc-c3235916e9a3","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDmbtr$"}},{"name":"find","value":{"type":"STRING","string":",00"}},{"name":"replaceWith","value":{"type":"STRING","string":""}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"db69e5a5-44df-4564-afae-7b1e885396bb","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDmbtr$"}},{"name":"find","value":{"type":"STRING","string":","}},{"name":"replaceWith","value":{"type":"STRING","string":"."}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"de761f87-ffd2-4f06-a888-17f4935f6cfc","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"-------------------------------------Definir tipo de cambio a dolares------------------------------"}}]},{"uid":"ef45c9a4-9674-484d-a62f-6f0296feae90","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vTipoCambio"}},{"uid":"cbff5abb-2031-4126-ac15-afa05690ccf0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Recorro el vector que tiene [los números de documentos y texto](uso estos dos parámetros como pivote de selección) a compensar"}}]},{"uid":"de66d765-e727-48e0-a208-a7f904a60bc3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"i: El valor de i, sería la posición final en la que guardó datos en la matriz vNumeroBoleta"}}]},{"uid":"896cfdce-0663-4014-893f-738b0ae1e081","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Entonces uso como cantidad de repeticiones en el loop."}}]},{"uid":"1c2cbd15-fbb6-4805-948b-25433cef99cf","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"j: Uso para seleccionar cada registro dentro de la matriz vNumeroBoleta"}}]},{"uid":"60b4c29a-07c3-4e81-8797-59bc20b9d081","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"85eda246-6af0-498c-ae6c-eec34b83b7eb","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"6e209aca-b763-4376-adbe-cab636a7d575","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"},"attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$i.String:toNumber$"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"fc51e148-78d6-4717-afb0-9ac59b3e1220","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"398d8c85-043f-4d21-8380-f9fcc84689a7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Por cada loop, realizo una búsqueda específica y luego genero el proceso de armar Json a compensar"}}]},{"uid":"cd25e6b9-3863-4be4-8fce-655c97343702","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere sgtxt='$vNumeroBoleta[$j.LegacyAutomation:getDecrementedNumber$][0]$' and belnr='$vNumeroBoleta[$j.LegacyAutomation:getDecrementedNumber$][1]$'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"ff0970eb-f30f-474e-8d29-97ec82242157","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$j$+1"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"b4d42794-03bd-4c11-8859-1bec25ac8c81","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$j.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"ee9b98de-aa6d-4d3c-bd8c-a9a061aacea9","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-3"}},{"uid":"0afb5c60-c4bf-400f-a9db-d38beaaf88e9","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"6b04479c-03a8-4c57-9c09-440c40f7a653","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-3.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-3"}},{"uid":"68d7a366-79b7-456c-b102-3aca5220a4d8","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"d55391d9-6c11-4251-a200-411493576416","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"posnr\":\"$vPosicion$\",\"saknr\":\"$Loop-Dataset-Column-2[0]$\",\"belnr\":\"$Loop-Dataset-Column-2[7]$\",\"buzei\":\"$Loop-Dataset-Column-2[10]$\",\"gjahr\":\"$Loop-Dataset-Column-2[11]$\",\"dmbtr\":\"0\",\"augtx\":\"$vAugtx$\",\"blart\":\"$vBlart$\",\"xblnr\":\"\",\"bmbtr\":\"$Loop-Dataset-Column-2[8]$\",\"kursf\":\"$vTipoCambio$\",\"bktxt\":\"\",\"budat\":\"$vBudat$\",\"zoper\":\"\"},"}}],"returnTo":{"type":"VARIABLE","variableName":"vConcatenador"}},{"uid":"f3f1d6e9-9d7d-44ce-966f-fb73123a984d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vConcatenador.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vConcatenador"}},{"uid":"10d0a2be-d5e8-42bd-915d-ad3346c3691d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion$ . $Loop-Dataset-Column-2[0]$ . $Loop-Dataset-Column-2[7]$ . $Loop-Dataset-Column-2[10]$ . $Loop-Dataset-Column-2[11]$ . 0 . $vBudat$"}}],"returnTo":{"type":"VARIABLE","variableName":"vReportCompensadas"}},{"uid":"3c403e5e-3728-46da-b4b4-3aa2207f76a7","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vReportCompensadas.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vReportCompensadas"}},{"uid":"0645968d-18fe-4df0-9bcb-bef837784e82","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDetailString$$vConcatenador$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDetailString"}},{"uid":"03374e90-d36e-420d-ae34-a7cc8ac2639e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDetailString.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDetailString"}},{"uid":"a05737f2-79ce-4df3-bcb3-d6d01fbf9c38","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vJsonDetallexRegla$\n$vConcatenador$"}}],"returnTo":{"type":"VARIABLE","variableName":"vJsonDetallexRegla"}},{"uid":"932793a4-d30b-4e58-8c31-6fa8d2f62153","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vJsonDetallexRegla.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vJsonDetallexRegla"}},{"uid":"42e4cc10-7c2e-42da-b2ff-3eecc04180a6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas$\n$vReportCompensadas$"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}},{"uid":"fc228540-a91e-4d94-ae65-93355047f094","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}},{"uid":"811a6f75-abe3-4afa-8689-38affb941bf7","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[7]$,$vDoc_compensados$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"46149095-e210-46bb-819a-79f579baae42","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDoc_compensados.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"0fca5345-b922-4eaa-9e9c-9c304621c28f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"f5a8547c-974d-45ce-a0de-39e7c617cd68","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$vPosicion$;$Loop-Dataset-Column-2[0]$;$Loop-Dataset-Column-2[7]$;$Loop-Dataset-Column-2[10]$;$Loop-Dataset-Column-2[11]$;$Loop-Dataset-Column-2[12]$;0;;AB;;$Loop-Dataset-Column-2[8]$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]},{"uid":"7c1034ce-4ca0-420c-a769-3cbaff6e7e20","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"\n[vJsonDetallexRegla]\n$vJsonDetallexRegla$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"934c477e-31d2-429d-aa8e-4f54ecd499bf","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"replaceWith","value":{"type":"STRING","string":"-"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}}]}]}]}]},{"uid":"1b3ca08c-1880-4b28-955e-554e439deeb7","commandName":"insertUpdateDelete","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"DROP TABLE $vTableNameA$;\nDROP TABLE $vTableNameB$;\nDROP TABLE $vTableNameC$;"}}]},{"uid":"d2bc5fdc-9a87-4718-8cda-b7963c411fee","commandName":"disconnect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"dosaveData","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"8e507bf4-3517-43c0-a979-a4019e1a5801","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"201a75f6-af75-4c53-9b32-c3075bc236ec","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Borra las tablas $vTableNameA$, $vTableNameB$ y $vTableNameC$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"e8748a2c-6e3e-4076-8aa5-1ebe588d4628","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"727a34ca-503b-49ef-a7e3-15d6cbbf5fe8","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"64f2274d-9f10-49cd-ad71-10b6e8614a88","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"70ffddb7-436e-4b84-a264-297f75ddb463","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Metabot error:\n[ $Error-LineNumber.Number:toString$ - $Error-Description$ ]"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]}],"branches":[{"uid":"87d9b5ba-39c4-4b27-acac-8d2fb485edba","commandName":"finally","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"d1eec670-86d6-471c-959a-ea54060e1ebf","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}]}],"children":[{"uid":"bae7c029-cf37-4255-8121-cbb4010c0cd6","commandName":"throw","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vDetailString","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantTotalRegistros","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameB","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDiferencia","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vJsonDetallexRegla","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBlart","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vConcatenador","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameA","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPosFinal","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantidadEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMontoPS","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTipoCambio","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameC","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFecha","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"PartidasCompensadas","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIndice","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPosicion","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAnio","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"j","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"aMatrizPA","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vMes3","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogFile","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vNumeroBoleta","description":"","type":"TABLE","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vMontoEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vReportCompensadas","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSumatoria","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantidadPS","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"i","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDmbtr","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBudat","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vQuery","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAugtx","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDoc_compensados","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Loop-Dataset-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-2","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-3","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"M-TableCellValue","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"ErrorHandler","version":"2.10.0-20220929-040735"},{"name":"Number","version":"3.6.0-20220928-104414"},{"name":"String","version":"5.5.2-20221006-094641"},{"name":"System","version":"3.10.0-20220921-062556"},{"name":"LegacyAutomation","version":"5.6.1-20221027-080331"},{"name":"Comment","version":"2.12.0"},{"name":"Database","version":"4.10.5-20221119-112148"},{"name":"Loop","version":"3.6.0-20220928-191723"},{"name":"Record","version":"1.6.3-20220919-051027"},{"name":"DataTable","version":"4.6.0-20220920-155212"},{"name":"LogToFile","version":"3.5.0-20220416-233918"},{"name":"If","version":"3.5.0-20220928-201537"},{"name":"MessageBox","version":"3.4.0-20220416-233919"},{"name":"Boolean","version":"2.6.4-20220919-050851"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_HIGH","timeout":"0s"}}