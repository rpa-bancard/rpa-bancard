{"nodes":[{"uid":"2cb31bfc-96b4-4f5b-9c5e-52cc9c6cc2eb","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"34cb11b4-e829-4a8d-b873-f13dabfdcffe","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"7b244c33-1c90-49e4-b762-def9dd8c32ef","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Tasks\\ConBanc\\Logs\\logfile.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogFile"}},{"uid":"42dcd91c-1cde-4fda-9198-b92419bf1393","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogFile"}},{"uid":"5205fa84-aff0-4d3f-8a5a-614fbfa9c55b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------"}}]},{"uid":"6be99a87-47c5-4c6a-9188-5dc6c03ca797","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"63586c7c-1a9b-4442-a72f-293b2aa3cd95","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Conexion a la BD"}}]},{"uid":"0f4060db-2bc0-484a-a1e0-bb4718dd5160","commandName":"connect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Persist Security Info=False;Extended Properties=\"DSN=PostgreSQL35W;DATABASE=rpa-desa;SERVER=10.100.14.49;PORT=5432;UID=postgres;SSLmode=disable;ReadOnly=0;Protocol=7.4;FakeOidIndex=0;ShowOidColumn=0;RowVersioning=0;ShowSystemTables=0;Fetch=100;UnknownSizes=0;MaxVarcharSize=255;MaxLongVarcharSize=8190;Debug=0;CommLog=0;UseDeclareFetch=0;TextAsLongVarchar=1;UnknownsAsLongVarchar=0;BoolsAsChar=1;Parse=0;ExtraSysTablePrefixes=;LFConversion=1;UpdatableCursors=1;TrueIsMinus1=0;BI=0;ByteaAsLongVarBinary=1;UseServerSidePrepare=1;LowerCaseIdentifier=0;D6=-101;XaOpt=1\""}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"5df2c033-8d22-463e-9d62-aa2c55fd5dfa","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Realiza la unión completa entre todas las tablas."}}]},{"uid":"1daf3c9c-e264-438c-9817-b90316956cda","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"SELECT * FROM $vTableNameA$ T1\nunion\nSELECT * FROM $vTableNameB$ T2\nunion\nSELECT * FROM $vTableNameC$ T3"}}],"returnTo":{"type":"VARIABLE","variableName":"vQuery"}},{"uid":"79cc7c46-1828-40d9-ad1c-f999db8b202c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vQuery.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vQuery"}},{"uid":"74803d0a-691d-4b0b-9cc6-1aca364bda52","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo la cantidad total de registros para luego crear un array y"}}]},{"uid":"125708cf-3bc1-4311-82d8-3954529ffa71","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"almacenar los numeros de boleta y texto "}}]},{"uid":"bdb7be51-7140-4963-bd5f-ac35b834faf6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"con la finalidad de poder obtener luego ese movimiento para compensar."}}]},{"uid":"7498b451-4f3b-4349-9704-284ab6e9ec3d","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"2dde0dd8-8e16-4c38-808a-c2c818f04f32","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"037f9f74-1385-4562-af0a-c700db3d39c5","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"e065bf6d-446f-4926-a433-7a311fe68230","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"ae570f76-f2da-4771-b902-ad24de9141f1","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"0d155014-24c1-4207-8256-5204b7c84ea2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantTotalRegistros"}}]},{"uid":"aeaab5f3-1b27-4102-acab-aec0e204df14","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Inicialización de matriz (Cantidad total de registros,2)"}}]},{"uid":"178c0c21-ed75-46d1-8e8b-18464f4d3408","commandName":"assign","packageName":"DataTable","attributes":[{"name":"rowSize","value":{"type":"NUMBER","expression":"$vCantTotalRegistros.String:toNumber$"}},{"name":"columnSize","value":{"type":"NUMBER","expression":"2"}},{"name":"option","value":{"type":"STRING","string":"resize"}}],"returnTo":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"uid":"429878c5-4a20-4cf0-af98-3288c5402613","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Cantidad de registros EX a verificar"}}]},{"uid":"7c48dc6a-731b-4fce-b046-34f167a31e6d","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t \nwhere blart='EX';\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"3fe9c3a3-df86-47c7-bbf5-a50088814797","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"638dc392-41fb-4075-912a-9cf95cde6dd2","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"c1685759-2fe2-4acd-8e06-3cab275f0868","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"cc1d34f4-e47c-4567-a34c-57045c0f01e0","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"5f1a7200-95df-4d44-be89-94caed644905","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantidadEX"}}]},{"uid":"9b0c0228-2794-4b0c-a771-fbf90d6e72f0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Cantidad de registros PS a verificar"}}]},{"uid":"44c699d5-e951-47d6-a012-c48605f92daf","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select count(*) from ($vQuery$) t \nwhere blart='PS';\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"a2394502-e4b8-41dd-b2b7-a87c30cb8034","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"9b9d4ad2-9c83-49f7-8239-a0ed8286659b","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"fdc6c60c-1911-45f2-8cde-2e44dc3ee0fe","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"6605d132-4b96-4482-b4bf-e60e922c1acb","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"914ae6ce-5b31-4105-874b-f13aca848193","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCantidadPS"}}]},{"uid":"519de292-6f35-4d92-9c85-20d54bac8cf1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"aac860b8-18b1-4d01-b3bb-70ed71f9f8ee","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"################################################\nvCantidadEX = $vCantidadEX$\nvCantidadPS = $vCantidadPS$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f4d49adb-a9b6-48be-b88a-6473d790f170","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Year.Number:toString$-1"}}],"returnTo":{"type":"VARIABLE","variableName":"vAnio"}},{"uid":"5b66609d-2752-4c8a-95f4-e5a9410a73f5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vAnio.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAnio"}},{"uid":"2aff17f6-743a-4d68-8e06-c91165115d6a","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"AND"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCantidadEX$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThan"}},{"name":"value","value":{"type":"STRING","string":"1"}}],"operatorAttribute":{"operator":"AND","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCantidadPS$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThan"}},{"name":"value","value":{"type":"STRING","string":"1"}}]}}],"children":[{"uid":"f0a3c5fe-699e-4c30-8f72-bfab67c41901","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"-----------------------------------------------"}}]},{"uid":"b5321122-744a-495e-8b57-8fe4996cab7e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo todas las EX ordenadas , luego recorro uno a uno"}}]},{"uid":"b8e6c142-b07c-444e-bacf-b1654d6dd73e","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere blart='EX' \norder by bldat ASC;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"1505d612-e330-4171-9ab9-54ce49c261e7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Pivote, para cuando encuentre que el monto total de varias PS "}}]},{"uid":"1a3164d8-c5f1-480d-acf4-f8f72a4f2418","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Sea igual al monto de la EX, entonces ya no tener en cuenta las mismas PS para otra EX"}}]},{"uid":"da063951-6d2d-4539-a234-8f066ca55202","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"f64b3b8e-472c-4c95-b1e3-af5d6ad0b16a","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"84c7f1a4-d112-4b90-b50c-52ce6192b9b6","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"e2b4e127-31a2-412e-acab-03dbc08ab572","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"ad17ad78-995d-477f-b49e-2323de47a025","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"3c9ed6fb-2c7d-4e00-895c-5d8b4ce91396","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"4323cca1-101d-470e-9cc5-81079c6949cc","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFecha"}},{"uid":"4a8fd871-a4fd-4783-826d-b915ab477cd6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaEX"}},{"uid":"224efeb5-1d3d-4bde-ad04-8e7087487e8a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extraer mes de Fecha de la EX"}}]},{"uid":"bf1be33d-d6df-42eb-be75-ccce21844188","commandName":"beforeAfter","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaEX$"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":false}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes1"}},{"uid":"1fda8e7d-93c3-485f-97a4-526e21d4d07d","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"01"}}]}],"children":[{"uid":"b96d92a4-2d68-4f80-9c86-7b1a96b99868","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"12"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}],"branches":[{"uid":"9505c383-bc1b-4105-ac47-112084689279","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"02"}}]}],"children":[{"uid":"a23b1855-e476-4a79-a444-6962ef017ae0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"01"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"eeec4f55-0399-4007-9123-ff420507ae0c","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"03"}}]}],"children":[{"uid":"048fd8e1-8679-440b-a426-72b21332b797","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"02"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"2cc38635-1bb9-405b-9cec-b4abc97f9f87","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"04"}}]}],"children":[{"uid":"e6febad9-2b4e-4375-9aaf-2cc49d450339","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"03"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"77301d81-10c1-436f-92e3-2ffbf08095e3","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"05"}}]}],"children":[{"uid":"8f38210e-c1c0-4509-825e-54c87d2b30d2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"04"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"e178aa85-dd06-4ca7-b725-697408028308","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"06"}}]}],"children":[{"uid":"a87b5b8d-602c-4cba-89fb-d3efda79a833","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"05"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"dd54b2fb-500b-4ee0-904a-fdba34279ac4","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"07"}}]}],"children":[{"uid":"1b0fac1f-6d45-45f4-8263-08f446d34f2c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"06"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"5451c7ea-dbcf-4d0d-b54e-0e26543c6669","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"08"}}]}],"children":[{"uid":"b2b78c11-1546-4bab-9875-b610fff6b5df","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"07"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"694ee153-5cff-4f95-940b-b72fe14ae5ab","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"09"}}]}],"children":[{"uid":"a7bb92e7-018b-400d-8344-15daf8247724","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"08"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"954e9bc2-97e2-499e-b767-af842d9f2e46","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"10"}}]}],"children":[{"uid":"3cb6e9be-1d23-471e-8555-59178efcd8d3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"09"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"823cd8d7-9ea1-4e2a-a430-98834763463b","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"11"}}]}],"children":[{"uid":"0b07db78-36f6-4d73-99e3-0bbca5ce8eec","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"10"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]},{"uid":"e36953b3-0914-49ab-8c67-b119c5cec1a0","commandName":"elseIf","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"12"}}]}],"children":[{"uid":"f91af6ab-9952-4a36-bc8d-6fb3373b386e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"11"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}}]}]},{"uid":"ed5dec05-a8b4-4561-bfae-57d146120483","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"vMes1 = $vMes1$\nvMes2 = $vMes2$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"09cacb97-4291-4cfb-80f1-e81ef2257428","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosFinal$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"22f5a691-d417-4e10-9c0d-5c03f46faee0","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vAnio$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$System:Year.Number:toString$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}]}}],"children":[{"uid":"557ff6aa-2d53-44d2-b95f-1a0b84caaf67","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"3a0192cd-76e2-468c-b9bf-b94fd11c6d70","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"b73228d3-ad95-4041-b897-cf9327fd3949","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el texto(7) y número de boleta(8) de la EX"}}]},{"uid":"bcd4b8fb-b37b-443b-aece-d8fa563c1ff3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[6]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"fa2bae73-f591-425d-a9ae-76a49e0bb0bf","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"0"}}]},{"uid":"a3f9578c-2bb1-4998-b0bc-acf00bc1ee9f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"63726750-60e4-43c1-9709-aef3c4a43e89","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"1"}}]},{"uid":"71c4403d-9a7c-48d4-a02c-af1d0fcb6552","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"760c7e12-53c9-4c17-bceb-8bbc2298465a","commandName":"setCellValue","packageName":"DataTable","disabled":true,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"2"}}]},{"uid":"c83fc003-35d5-4686-9acd-5e453e5807f6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el monto y lo convierte a negativo para luego comparar con la suma de PS´s"}}]},{"uid":"a4118f2e-c022-44e5-8a62-b4769afa09b4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[4]$*(-1)"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"36f94b36-7084-45de-aa40-93c10290c8dc","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"43625a8d-51b4-4e00-b07a-a57fdda811de","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtengo todas las PS ordenadas , luego recorro uno a uno"}}]},{"uid":"7291828d-9a4c-456d-b802-5a55827db169","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere blart='PS' \norder by bldat ASC;\n"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"95d67b9b-6f52-482a-98e7-8813f7aa1480","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"947c9c13-0f54-4135-be6c-ef685887484e","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"34ded21f-a0e9-4a98-aabc-ff5d9e006979","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"f470c11a-2336-431a-90d3-9ba2f03fbf77","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"35c4ba92-fb06-4e1e-9482-537797904cbb","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"9b8732e2-fe1e-4d87-8aeb-0b0301397952","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"NO DEBE DE EXISTIR"}}]},{"uid":"2846d40d-1f27-4ea6-a3a8-a5756f87bfa0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFecha"}},{"uid":"221d0421-d4af-45c0-899f-14d9551c6983","commandName":"beforeAfter","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":false}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes3"}},{"uid":"c646da41-29d2-4801-8e10-7d518f1240e6","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\nOperator : \nOperator : 1\nValue : 1\nThen : \n\n\n\n\n\n\n\n\n"}}]},{"uid":"47e0a5d0-691f-4603-8cb2-4ee68476660b","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vAnio$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFecha$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$System:Year.Number:toString$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}]}}],"children":[{"uid":"08814e97-04b0-4cb0-acb9-d5998059a578","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"e115a6d1-230f-4e98-a0f7-cf11b93639a6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[4]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoPS"}},{"uid":"6e0d6d4f-d6ee-4225-a221-dcca68b68d28","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"bc6510c6-2720-4bfe-aa0f-6bb1e3cfdde4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIndice"}},{"uid":"ec5a6009-8b0e-42be-a3de-6dd81bf57008","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\nOperator : \nValue : 1\nThen : \n\n\n\n\n\n\n"}}]},{"uid":"b4167d5a-d5e6-4515-8058-5fc29a824bc3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"015499a2-ec80-486f-837e-c228c2cb3f1f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"NO DEBE DE EXISTIR"}}]},{"uid":"7e308ddf-48e7-43ad-8852-ef0f7146dccd","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"OR"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes3$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMes1$"}}],"operatorAttribute":{"operator":"OR","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vMes3$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMes2$"}}]}}],"children":[{"uid":"0b6e3703-7072-4b88-a5a9-ca1cbf6683e9","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vIndice$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThanOrEqualTo"}},{"name":"value","value":{"type":"STRING","expression":"$vPosFinal$"}}]}],"children":[{"uid":"ea9c817a-2f55-48ed-a3e7-4233adb42098","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$i$+1"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"535d17c6-1117-4e34-bd4a-79ebc5c53896","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$i.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"i"}},{"uid":"36c49f62-d141-42f1-9035-812009f766d8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Extrae el texto(7) y número de boleta(8) de la EX"}}]},{"uid":"76f9be6e-c093-4c1a-9d31-1c55a19f63b8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[6]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"bbdc4c11-94db-4727-9856-9c2f08904f89","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"0"}}]},{"uid":"04f7092f-e0d9-4303-83ad-a029fc18b51a","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[7]$"}}],"returnTo":{"type":"VARIABLE","variableName":"M-TableCellValue"}},{"uid":"b0a49e91-0b0b-48f8-9caa-d2dd4e74d466","commandName":"setCellValue","packageName":"DataTable","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vNumeroBoleta"}},{"name":"value","value":{"type":"STRING","expression":"$M-TableCellValue$"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$i.String:toNumber$- 1"}},{"name":"columnType","value":{"type":"STRING","string":"colIndex"}},{"name":"columnIndex","value":{"type":"NUMBER","number":"1"}}]},{"uid":"ad0e2d22-5db1-4f95-a767-e65d1cfcb9c9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------------------------------------------------------------------------------------"}}]},{"uid":"e49fca76-f68a-4893-8cb3-f84af37abebe","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Sumo el valor del registro PS y luego verifico si coicide con la de EX"}}]},{"uid":"522013a1-b5a3-4b7e-8dc2-09fcbaf9c8eb","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoPS$ + $vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"5eb6ac9f-7595-46e5-803e-ae3413b200ff","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"f7bfb6a6-3c2d-4843-ac82-5f2617af28ea","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"d9c57010-f1dd-48a8-910d-930af054af2a","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"\nvPosFinal  =  $vPosFinal$\nvIndice      =  $vIndice$\nvMontoEX = $vMontoEX$\nvMontoPS = $vMontoPS$\nvSumatoria = $vSumatoria$\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8a49d7f0-e987-49d7-bca2-77f80f774421","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vSumatoria$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vMontoEX$"}}]}],"children":[{"uid":"98c13142-d949-40fc-8cb3-7ac6834424c7","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIndice$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"e8059c2d-1f6b-4b54-90bd-fd9a357b6648","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosFinal.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosFinal"}},{"uid":"a771dc9c-189e-4c52-9634-5c488c12a251","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX$*(-1)"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"88fe3214-63b7-404c-909b-c18db7a35248","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoEX"}},{"uid":"85e04d7a-148f-42b0-801e-426bf85a9120","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoEX$ + $vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"857faf61-d755-48e5-906a-aef1b55b87e5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSumatoria"}},{"uid":"52d6289b-88e0-451e-95dc-6b3c4113df4b","commandName":"loop.commands.break","packageName":"Loop","attributes":[]}]}]}]},{"uid":"6135bbf9-cf22-4506-857c-ea4b56cf4fef","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"dddd"}}]}]}]},{"uid":"03d460ef-25a7-49e0-8bc5-a07032e99613","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Continua con el proceso, porque encontró una EX con varias PS"}}]},{"uid":"dc788ce4-07be-4da6-a550-20a2ef78a7ae","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"87a7ab7b-58ac-40fa-8306-1a93d208d4e9","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Sumatoria de partidas : $vSumatoria$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f592e65a-0939-477f-8d42-b31a6c3d48eb","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Sumatoria de partidas : $vSumatoria$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"9703f8e5-2699-43b2-9ac8-bce395aba1c1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"cf443c7a-4130-4dff-890a-3bf30d5a2074","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSumatoria$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDiferencia"}},{"uid":"0b985ab8-8d7d-4557-a2a0-9e364b764200","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vDiferencia$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"0"}}]}],"children":[{"uid":"58203cf8-36a5-4e36-bdce-d5941b7f9587","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---- Obtiene la fecha de compensación(Fecha de la EX)"}}]},{"uid":"bde98c89-7991-4c00-b688-baf498e0aa5f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vAugtx"}},{"uid":"7c23a824-db34-40b5-995c-62b94ae245ca","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaEX$"}}],"returnTo":{"type":"VARIABLE","variableName":"vBudat"}},{"uid":"2e490d30-4655-4324-988b-ce4cfb92c324","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vBudat$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"replaceWith","value":{"type":"STRING","string":"-"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vBudat"}},{"uid":"51976ae6-0298-4526-a0ce-e4b907ea9426","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---- Arma Json con las partidas a compensar"}}]},{"uid":"b786fb6c-a691-4b67-8070-43c62364a558","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosicion"}},{"uid":"8d021a09-d17d-4a54-8ee5-7412a0b5b470","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPosicion"}},{"uid":"d2a3b8d0-79ee-4b44-8f8d-fe7a08c50009","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDmbtr$"}},{"name":"find","value":{"type":"STRING","string":",00"}},{"name":"replaceWith","value":{"type":"STRING","string":""}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"02005aa2-255a-4de9-b4f7-cbd23f546a4f","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDmbtr$"}},{"name":"find","value":{"type":"STRING","string":","}},{"name":"replaceWith","value":{"type":"STRING","string":"."}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vDmbtr"}},{"uid":"b3679102-2ce9-4370-9fb4-aa6f33275307","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"-------------------------------------Definir tipo de cambio a dolares------------------------------"}}]},{"uid":"75f9e009-9049-48b0-b8c1-9d756f3858aa","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vTipoCambio"}},{"uid":"ed1a29ea-68c5-41ff-8c90-56d4cc40ae24","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Recorro el vector que tiene [los números de documentos y texto](uso estos dos parámetros como pivote de selección) a compensar"}}]},{"uid":"39fe4f0c-4b79-49be-a683-4f08bed91301","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"i: El valor de i, sería la posición final en la que guardó datos en la matriz vNumeroBoleta"}}]},{"uid":"3fcdebb6-b2b7-449f-aa4a-416e6d941c12","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Entonces uso como cantidad de repeticiones en el loop."}}]},{"uid":"a3bd6678-e5eb-4055-a24e-22835a659d2c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"j: Uso para seleccionar cada registro dentro de la matriz vNumeroBoleta"}}]},{"uid":"eea24373-55c8-4f8a-aab0-2a6f70181fb6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"3178c095-9114-4e41-826a-1b4ffe2711a0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"4644919a-ef3e-4dbf-8301-7d03765f823d","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"},"attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$i.String:toNumber$"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"3c424aeb-c6e9-46f2-aa40-94def31c3cb1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"e6953630-9bf4-4624-b3fe-f206d67829f5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Por cada loop, realizo una búsqueda específica y luego genero el proceso de armar Json a compensar"}}]},{"uid":"9c8a1007-968a-4b1f-aaf0-b2b5c265a5dd","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"select * from ($vQuery$) t \nwhere sgtxt='$vNumeroBoleta[$j.LegacyAutomation:getDecrementedNumber$][0]$' and belnr='$vNumeroBoleta[$j.LegacyAutomation:getDecrementedNumber$][1]$'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"59532843-3a7f-4740-b9fa-accc1424fd9b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$j$+1"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"80ee3d93-82df-4827-9896-63a0d0d151da","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$j.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"j"}},{"uid":"809a5022-038b-4480-9b35-b8d6b5018af5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-3"}},{"uid":"6e661309-daca-45f3-bfce-f78c159ac487","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"9c1ad798-6ff1-42c9-8cbc-dccb32e329e7","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-3.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-3"}},{"uid":"9175f066-c2a3-4a31-b137-3991261ea216","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-2"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"5011207c-9dcd-43f6-97b4-5ac0224feb81","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"{\"posnr\":\"$vPosicion$\",\"saknr\":\"$Loop-Dataset-Column-2[0]$\",\"belnr\":\"$Loop-Dataset-Column-2[7]$\",\"buzei\":\"$Loop-Dataset-Column-2[10]$\",\"gjahr\":\"$Loop-Dataset-Column-2[11]$\",\"dmbtr\":\"0\",\"augtx\":\"$vAugtx$\",\"blart\":\"$vBlart$\",\"xblnr\":\"\",\"bmbtr\":\"$Loop-Dataset-Column-2[8]$\",\"kursf\":\"$vTipoCambio$\",\"bktxt\":\"\",\"budat\":\"$vBudat$\",\"zoper\":\"\"},"}}],"returnTo":{"type":"VARIABLE","variableName":"vConcatenador"}},{"uid":"032e3c4e-1247-4676-b43d-dc7c94da171c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vConcatenador.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vConcatenador"}},{"uid":"fa24cac4-1943-483a-a7d8-af07844e1f43","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPosicion$ . $Loop-Dataset-Column-2[0]$ . $Loop-Dataset-Column-2[7]$ . $Loop-Dataset-Column-2[10]$ . $Loop-Dataset-Column-2[11]$ . 0 . $vBudat$"}}],"returnTo":{"type":"VARIABLE","variableName":"vReportCompensadas"}},{"uid":"29103e41-2c08-4b66-8c08-9142f7dc1a32","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vReportCompensadas.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vReportCompensadas"}},{"uid":"3e03d4fb-007f-48b8-876f-5adf0c82ecc2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDetailString$$vConcatenador$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDetailString"}},{"uid":"2396a068-be3c-4248-b343-b39aca99be76","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDetailString.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDetailString"}},{"uid":"76ecf924-572e-4a26-b2eb-8c6dbbf22edf","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vJsonDetallexRegla$\n$vConcatenador$"}}],"returnTo":{"type":"VARIABLE","variableName":"vJsonDetallexRegla"}},{"uid":"2fb1cf7e-5a24-47fb-b77e-ce5414ab4bc8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vJsonDetallexRegla.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vJsonDetallexRegla"}},{"uid":"9e9940d7-71d6-4a0c-8f5a-a7cbcb762ac4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas$\n$vReportCompensadas$"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}},{"uid":"4cb230b7-a737-4e2d-90c4-5da97da0e191","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}},{"uid":"c0997004-052d-4727-91fc-002042a64785","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-2[7]$,$vDoc_compensados$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"fa296722-e5b0-4933-84c2-82f68bc642f3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDoc_compensados.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDoc_compensados"}},{"uid":"fe779ac8-dc2e-41ea-95c0-9889c3691fdf","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"244c2a98-3d1b-4cef-8fc2-a16bbc800613","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$vPosicion$;$Loop-Dataset-Column-2[0]$;$Loop-Dataset-Column-2[7]$;$Loop-Dataset-Column-2[10]$;$Loop-Dataset-Column-2[11]$;$Loop-Dataset-Column-2[12]$;0;;AB;;$Loop-Dataset-Column-2[8]$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]},{"uid":"47d11bcf-33cd-4048-8315-ef2f700b3ab4","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"\n[vJsonDetallexRegla]\n$vJsonDetallexRegla$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"3e8ca216-c246-422b-bc55-78ecfa075e55","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$PartidasCompensadas$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"replaceWith","value":{"type":"STRING","string":"-"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"PartidasCompensadas"}}]}]}]}]},{"uid":"8119ba44-f5c7-4717-9549-3fd5fed5e702","commandName":"insertUpdateDelete","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"DROP TABLE $vTableNameA$;\nDROP TABLE $vTableNameB$;\nDROP TABLE $vTableNameC$;"}}]},{"uid":"8426a8f8-2c6b-4f4b-a643-1c4ba2891929","commandName":"disconnect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"dosaveData","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"97d968ac-bec9-4504-850c-e73ca70525ad","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"ad925fbf-9713-4560-9220-641d7afd7d5c","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Borra las tablas $vTableNameA$, $vTableNameB$ y $vTableNameC$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"df21cff2-b536-4fa8-b43b-d3f5513c4ee9","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"6a4a9738-ccfc-4353-b797-3715e67c0796","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"8e9729e2-6825-4844-8988-9a000354633f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"400bf43d-7666-4e86-ad07-33a409e4d01f","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Metabot error:\n[ $Error-LineNumber.Number:toString$ - $Error-Description$ ]"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]}],"branches":[{"uid":"b60204a4-fb80-4cb0-8932-dd0e686388ce","commandName":"finally","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"f2e84703-a860-47be-b6eb-8ec194ad129c","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}]}],"children":[{"uid":"ff727066-4b39-4aa7-a5c9-a31c1d867ec8","commandName":"throw","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vDetailString","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantTotalRegistros","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameB","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDiferencia","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vJsonDetallexRegla","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBlart","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vConcatenador","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameA","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPosFinal","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantidadEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMontoPS","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTipoCambio","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameC","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFecha","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"PartidasCompensadas","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIndice","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPosicion","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAnio","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"j","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"aMatrizPA","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vMes3","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogFile","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vNumeroBoleta","description":"","type":"TABLE","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vMontoEX","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vReportCompensadas","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSumatoria","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCantidadPS","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"i","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDmbtr","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBudat","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vQuery","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAugtx","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDoc_compensados","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Loop-Dataset-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-2","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-3","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"M-TableCellValue","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"ErrorHandler","version":"2.10.0-20220929-040735"},{"name":"Number","version":"3.6.0-20220928-104414"},{"name":"String","version":"5.5.2-20221006-094641"},{"name":"System","version":"3.10.0-20220921-062556"},{"name":"LegacyAutomation","version":"5.6.1-20221027-080331"},{"name":"Comment","version":"2.12.0"},{"name":"Database","version":"4.10.5-20221119-112148"},{"name":"Loop","version":"3.6.0-20220928-191723"},{"name":"Record","version":"1.6.3-20220919-051027"},{"name":"DataTable","version":"4.6.0-20220920-155212"},{"name":"LogToFile","version":"3.5.0-20220416-233918"},{"name":"If","version":"3.5.0-20220928-201537"},{"name":"MessageBox","version":"3.4.0-20220416-233919"},{"name":"Boolean","version":"2.6.4-20220919-050851"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_HIGH","timeout":"0s"}}