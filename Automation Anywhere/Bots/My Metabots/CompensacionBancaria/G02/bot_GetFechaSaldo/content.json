{"nodes":[{"uid":"e3093ca9-acf3-4237-8875-0bdb64db4a9e","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"8299243b-972b-4199-b476-3764eae67e86","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"fddfbfb4-e98e-4348-b1ee-5fcca41fe4f6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------"}}]},{"uid":"ffd67687-5057-4d33-8ba3-ec49961ed74f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Conexion a la BD"}}]},{"uid":"c0a0f5c6-6145-4234-af02-79ddf6bcc8b2","commandName":"connect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Persist Security Info=False;Extended Properties=\"DSN=PostgreSQL35W;DATABASE=rpa-desa;SERVER=10.100.14.49;PORT=5432;UID=postgres;SSLmode=disable;ReadOnly=0;Protocol=7.4;FakeOidIndex=0;ShowOidColumn=0;RowVersioning=0;ShowSystemTables=0;Fetch=100;UnknownSizes=0;MaxVarcharSize=255;MaxLongVarcharSize=8190;Debug=0;CommLog=0;UseDeclareFetch=0;TextAsLongVarchar=1;UnknownsAsLongVarchar=0;BoolsAsChar=1;Parse=0;ExtraSysTablePrefixes=;LFConversion=1;UpdatableCursors=1;TrueIsMinus1=0;BI=0;ByteaAsLongVarBinary=1;UseServerSidePrepare=1;LowerCaseIdentifier=0;D6=-101;XaOpt=1\""}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"1f11bb38-0971-4ed7-a293-57e43aa39ebc","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Select para obtener la Fecha de compensacion, asigna la fecha mas reciente de todas"}}]},{"uid":"25224041-1578-4c30-a01f-29d5b37e925b","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"SELECT T1.sgtxt, T1.bldat FROM $vTableNameA$ T1\nwhere tableaux1 like '%$vTextoSaldo$%'\nunion\nSELECT T2.sgtxt, T2.bldat FROM $vTableNameB$ T2\nwhere tableaux1 like '%$vTextoSaldo$%'\nunion\nSELECT T3.sgtxt, T3.bldat FROM $vTableNameC$ T3\nwhere tableaux1 like '%$vTextoSaldo$%'\norder by bldat desc;"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"5e45e14a-d236-4fe7-8072-f15d30f0e168","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"$vQueryFecha$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"3652ce3a-7ed0-4e37-beb6-b3057ee055d4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"7748946f-9433-4531-b052-5929d0fd3f98","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"29c1734f-0598-47f2-9182-2afe35107e2f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"b78797d6-9308-47b7-990c-927f9208e1d6","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"a0c0c8dd-9da4-45cb-b66e-b128f11e7148","commandName":"replace","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}},{"name":"find","value":{"type":"STRING","expression":"$vTextoSaldo$"}},{"name":"replaceWith","value":{"type":"STRING","string":""}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaSaldo"}},{"uid":"5f95ed2f-1350-46c5-a895-286256a69f47","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaSaldo"}},{"uid":"f88b27de-96e2-4d43-acf8-4a3e4ceeda60","commandName":"loop.commands.break","packageName":"Loop","attributes":[]}]},{"uid":"0612a1d0-9c8e-42fd-9f2c-2ff0167bccb1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------"}}]},{"uid":"f5fa27d4-d03f-476c-9b53-c5f29f55a86d","commandName":"trim","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaSaldo$"}},{"name":"trimAtBeginning","value":{"type":"BOOLEAN","boolean":true}},{"name":"trimAtEnd","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaSaldo"}},{"uid":"5b418ae9-bcfb-49f4-8cec-a462faa7e6ad","commandName":"replace","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaSaldo$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"replaceWith","value":{"type":"STRING","string":"/"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaSaldo"}},{"uid":"ba5886d5-2981-49bf-9863-a6753510e84c","commandName":"disconnect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"dosaveData","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[{"uid":"7469fccd-9952-49d9-a5c3-9ed5e6a9c17b","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"ffac723b-c3a2-4f4a-bd83-bed849f3e6d2","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"80c70f82-b67c-4af0-8a31-8f76fa3875b7","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"a9b81ae3-3e73-400c-ab8c-9b250fc68ed0","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Metabot error:\n[ $Error-LineNumber.Number:toString$ - $Error-Description$ ]"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]}],"branches":[{"uid":"49e5fbdc-8cd7-4df4-9669-97199e58f96c","commandName":"finally","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"929aaccd-53a7-4875-8b7d-a3778860bdea","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}]}],"children":[{"uid":"2bc6561f-87f8-40e8-a435-cfad420166d6","commandName":"throw","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vLogFile","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaSaldo","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTextoSaldo","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vQueryFecha","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameA","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameB","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableNameC","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Loop-Dataset-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"ErrorHandler","version":"2.10.0-20220929-040735"},{"name":"Number","version":"3.6.0-20220928-104414"},{"name":"Comment","version":"2.12.0"},{"name":"Database","version":"4.10.5-20221119-112148"},{"name":"String","version":"5.5.2-20221006-094641"},{"name":"Loop","version":"3.6.0-20220928-191723"},{"name":"LegacyAutomation","version":"5.6.1-20221027-080331"},{"name":"Record","version":"1.6.3-20220919-051027"},{"name":"Boolean","version":"2.6.4-20220919-050851"},{"name":"LogToFile","version":"3.5.0-20220416-233918"},{"name":"If","version":"3.5.0-20220928-201537"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_HIGH","timeout":"0s"}}