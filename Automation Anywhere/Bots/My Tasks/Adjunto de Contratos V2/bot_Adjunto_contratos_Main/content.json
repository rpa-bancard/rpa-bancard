{"nodes":[{"uid":"0c091f6a-4661-4846-a8e8-4f0e72de8015","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"96d8e347-5c86-472a-b327-2d8ef1ba4449","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"dd748baa-8415-4e52-8cf4-ba147ff893e6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"9f120979-6fb4-42ad-8936-0ae89c574f24","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Módulo main para envío a Contratos a Domus"}}]},{"uid":"83dd9029-4951-4b24-90c2-5d754426c304","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"f4be594e-da48-469c-bacf-9b2f3076667e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\automarpa_des\\Documents\\Automation Anywhere Files\\Automation Anywhere\\My Tasks\\Adjunto de Contratos V2\\Logs\\Log.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogFile"}},{"uid":"cb654564-5a4f-4c9f-a454-2756c62cdd79","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path-condition-1-1"}},{"uid":"1294a533-c5ec-4d6e-8490-46f1ba6dc707","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"},"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path-condition-1-1.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"2"}}]}],"children":[{"uid":"35b277a1-df37-4827-b472-2e67f71c7430","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Limpia el archivo log."}}]},{"uid":"d4672225-fd79-4ad2-bb99-e32e5a48e9b6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"85597516-a69e-4a1c-8080-d60f616977c1","commandName":"deleteFiles","packageName":"File","attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}]},{"uid":"d43e758d-c705-48d9-be6e-f18fc9bb7775","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"98a1ab01-964d-42bd-98bf-9fbf283f3f41","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Carga las variables, obtiene Bearer Token y datos de Adjuntos"}}]},{"uid":"a2b098e9-5c1a-48f3-b1a7-46a14aa049e4","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"a7949ddc-8feb-4098-a3c1-b941885b84f3","commandName":"runTask","packageName":"TaskBot","attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Adjunto%20de%20Contratos%20V2/Configuracion_adjuntos_contratos"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"vPathProcesados","value":{"type":"STRING","expression":"$vPathProcesados$"}},{"key":"vPathNoProcesados","value":{"type":"STRING","expression":"$vPathNoProcesados$"}},{"key":"vPathReportes","value":{"type":"STRING","expression":"$vPathReportes$"}},{"key":"vPathReporteProcesados","value":{"type":"STRING","expression":"$vPathReporteProcesados$"}},{"key":"vPathReporteNoProcesados","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}},{"key":"vTemplateId","value":{"type":"STRING","expression":"$vTemplateId$"}},{"key":"vStatus","value":{"type":"STRING","expression":"$vStatus$"}},{"key":"vFechaEjecucion","value":{"type":"STRING","expression":"$vFechaEjecucion$"}},{"key":"vMailError","value":{"type":"STRING","expression":"$vMailError$"}},{"key":"vMailFrom","value":{"type":"STRING","expression":"$vMailFrom$"}},{"key":"vMailTo","value":{"type":"STRING","expression":"$vMailTo$"}},{"key":"vLogFile","value":{"type":"STRING","expression":"$vLogFile$"}},{"key":"vEntorno","value":{"type":"STRING","expression":"$vEntorno$"}},{"key":"vPathAdjuntos","value":{"type":"STRING","expression":"$vPathAdjuntos$"}},{"key":"vFlagEjecucion","value":{"type":"STRING","expression":"$vFlagEjecucion$"}},{"key":"vContratoValue","value":{"type":"STRING","expression":"$vContratoValue$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"vPathProcesados","value":{"type":"VARIABLE","variableName":"vPathProcesados"}},{"key":"vPathNoProcesados","value":{"type":"VARIABLE","variableName":"vPathNoProcesados"}},{"key":"vPathReportes","value":{"type":"VARIABLE","variableName":"vPathReportes"}},{"key":"vPathReporteProcesados","value":{"type":"VARIABLE","variableName":"vPathReporteProcesados"}},{"key":"vPathReporteNoProcesados","value":{"type":"VARIABLE","variableName":"vPathReporteNoProcesados"}},{"key":"vTemplateId","value":{"type":"VARIABLE","variableName":"vTemplateId"}},{"key":"vStatus","value":{"type":"VARIABLE","variableName":"vStatus"}},{"key":"vFechaEjecucion","value":{"type":"VARIABLE","variableName":"vFechaEjecucion"}},{"key":"vMailError","value":{"type":"VARIABLE","variableName":"vMailError"}},{"key":"vMailFrom","value":{"type":"VARIABLE","variableName":"vMailFrom"}},{"key":"vMailTo","value":{"type":"VARIABLE","variableName":"vMailTo"}},{"key":"vLogFile","value":{"type":"VARIABLE","variableName":"vLogFile"}},{"key":"vEntorno","value":{"type":"VARIABLE","variableName":"vEntorno"}},{"key":"vPathAdjuntos","value":{"type":"VARIABLE","variableName":"vPathAdjuntos"}},{"key":"vFlagEjecucion","value":{"type":"VARIABLE","variableName":"vFlagEjecucion"}},{"key":"vContratoValue","value":{"type":"VARIABLE","variableName":"vContratoValue"}}]}},{"uid":"e7c4c740-2f95-44a4-a005-f62d432ce844","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"e2c375b0-9c89-4b8c-910c-1e271f2e7534","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":" "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"0452e8c5-379f-47c3-bdb1-4d57cecf8d30","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"09904850-b88e-45f5-9329-ee202a823244","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"---------------> Entorno de ejecución: $vEntorno$ <---------------"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"fec1ab8d-e27e-4159-a408-a381b5c6b8ef","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"9a8b03e8-db91-47b3-950a-213904653988","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"** FLAG DE EJECUCIÓN: $vFlagEjecucion$**"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4e4afeeb-68b1-493d-a942-8a11a3039214","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFlagEjecucion$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":"True"}}]}],"children":[{"uid":"60d82225-b7e7-435d-9b5f-6e52370fbd71","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Se detiene el task y envía el correo al Soporte RPA."}}]},{"uid":"734c8b94-505e-4e25-ab50-9ecbb4fa12fc","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"826508f2-601d-4375-a144-270cb98518b4","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"El flag de ejecución es $vFlagEjecucion$, se procede a detener el proceso. No se pudo obtener el Bearer Token o el value del Tiop de Adjunto."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"c9783cc6-6386-492d-87d4-ba98c0576a72","commandName":"SendMailV2","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vMailFrom$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vMailError$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"ERROR - Carga de Adjuntos de Contratos"}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"ERROR - Carga de Adjuntos de Contratos:\n\nNo se pudo obtener el Bearer Token o el value del Tipo de Adjunto del C4C.\n\nVerificar los logs en el url: $vLogFile$\n y la documentación del proceso: $vDocumentacion$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"bfd4aaaf-6ae1-4815-a3d5-a4f4b3ab1751","commandName":"stopTask","packageName":"TaskBot","attributes":[]}]},{"uid":"c25803b6-1c0e-4b74-a17d-dea43845e599","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"True"}}],"returnTo":{"type":"VARIABLE","variableName":"vFlagCarpetaVacia"}},{"uid":"736897b0-9961-4992-88b5-dca9e5963b3a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Establece en cero los contadores de Adjuntos, Procesados y no Procesados."}}]},{"uid":"a276158b-17f7-4285-9e35-24662b8409c1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorAdjuntos"}},{"uid":"ed97d1f0-ad5f-4b37-b69d-681ea3376c8c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorProcesados"}},{"uid":"606bdb42-11f1-438c-a011-4af54a33aab6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorNoProcesados"}},{"uid":"739fa351-fa85-41c8-a3f1-92ef64ddcbea","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Escribe la cabecera del Log Principal."}}]},{"uid":"a91e7d14-1ee4-41ea-9bdd-6aab7f65c978","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"03d201b1-01cf-4f01-8e14-c14c860795bb","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"56863aa8-99c0-411c-a4a3-6cfd0f05cc17","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"8caa5444-7d5a-4d39-b1e3-d14be2c3b802","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"INICIA MÓDULO DE ENVÍO A DOMUS"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"d418d053-6750-423c-988d-1474c3419582","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"c1073a70-3205-4ba6-ad82-5c9e41e1a35f","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"13f78124-234b-495f-b580-2610c244d143","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Escribe la cabecera del log de Procesados."}}]},{"uid":"d2da646d-cbe6-4cb3-9a2f-c0b4877b6cc2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"2a85ef76-b0b7-4307-9a7b-874d15906e99","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5b70b5de-3c8b-44a2-9016-a8d97a67fbf2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"a48f78ea-2b29-4331-9c10-c3685e00800a","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"INICIA INFORME DE PROCESADOS "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"25ea5b5d-5507-43e5-b1f5-3e5d00bef433","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"efbfefb0-6850-4f56-a36f-65cb885039bf","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"7661fbb0-704e-4243-8eca-6e015e3206b1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Escribe la cabecera del log de No Procesados."}}]},{"uid":"8277e0de-5213-4fa4-81ee-d3ffe4644967","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"105c2b9c-cb18-4d59-91a6-68bcf14f2df8","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"6ff817d3-e537-488e-9798-b93a8dc7c590","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"26c4232c-fce6-4482-ae5f-3f9943fff2ac","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"INICIA INFORME DE NO PROCESADOS "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"aa29685f-d87e-4b3a-aed9-8a58302d05a3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"4ebd2939-989d-4c55-9303-dd17e14e2edf","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"1b0fe8c3-50c1-47b5-9225-1e501ede39a0","commandName":"connect","packageName":"Database","attributes":[{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Password=SLKDILA583;Persist Security Info=True;User ID=RPAODBC;Extended Properties=\"DSN=Conti Procesadora Nuevo;SYSTEM=192.168.109.149;UID=RPAODBC;DBQ=QGPL *usrlibl;DFTPKGLIB=QGPL;LANGUAGEID=ENU;PKG=QGPL/DEFAULT(IBM),2,0,1,0,512;QRYSTGLMT=-1;\";Initial Catalog=S106C98E"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"redis"},"sessionTarget":"LOCAL"}},{"uid":"68c65fd7-6930-4b8f-9375-aeab7101fad5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path-condition-1-1"}},{"uid":"05a1f346-3b2b-4358-8c61-7958c6ea1b0a","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$m-string-start-in-path-condition-1-1.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"809ca397-7969-4032-8732-a03c8efa934e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"b68461c7-979f-4bd3-9efa-e4d9a47a1bec","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"82767fd7-4b34-4b52-9db6-40a61357f4e0","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Files-1"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"d80199cd-3fb2-48cf-9a2a-11bfd7d9d3d5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"94919a65-98bf-4f57-8dcd-c1fb99f4bee1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Encuentra un archivo, por lo que la carpeta no está vacia. "}}]},{"uid":"02584c5a-b5a1-44ea-828a-3c1d57d0da95","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"False"}}],"returnTo":{"type":"VARIABLE","variableName":"vFlagCarpetaVacia"}},{"uid":"823d13d4-e0a6-4a97-8fd7-d7e2a13a9711","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vContadorAdjuntos$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorAdjuntos"}},{"uid":"183adf8e-b127-4fc5-9ac7-0eaff9b2a084","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vContadorAdjuntos.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorAdjuntos"}},{"uid":"5100152b-e7e1-4d25-86b1-ab627f7074d0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"81b90884-ebf8-4081-9661-f2755d8ff2e5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Inicio de preprocesamiento de Datos correspondiente a la lógica de cada iniciativa."}}]},{"uid":"5b2013ef-2a3a-442f-aba0-2f8bd3500188","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"0bb11092-2a81-4ad1-922d-e585c168b5f0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"12b19e08-8fb4-41ab-9ebf-e3c8fa11925a","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"Inicia preprocesamiento de Datos previo al envio a DOMUS."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"34714740-16dd-49aa-9d12-72a2a3c2138c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$\\$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathAdjuntoIndividual"}},{"uid":"1af33327-5dad-463c-a107-718066cef0a0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntoIndividual.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathAdjuntoIndividual"}},{"uid":"28021e0b-06ee-4782-af4a-8c1eddf2bb6f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"79687f76-b92a-492b-a633-fd91a22bc9a3","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":" "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"7d8ec99d-32b6-4c83-bc29-11a56c75d719","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"ee50b1ee-fade-4747-8e20-97028fabdd66","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Se procesa: $vPathAdjuntoIndividual$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"e75d46cd-8844-4841-b7fa-13e50dfee285","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Files-1{name}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNombreArchivo"}},{"uid":"108ff790-c705-40ac-83bd-39aba6d6dda5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNombreArchivo.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNombreArchivo"}},{"uid":"bae6b025-d6a6-4a87-b21b-f37eb36f4757","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Files-1{extension}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vExtensionArchivo"}},{"uid":"1bc76f07-08ea-4c8f-9304-96f007c53dc8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vExtensionArchivo.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vExtensionArchivo"}},{"uid":"f8ac01e0-42b1-42ad-8156-11d303609a09","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vCodCliente"}},{"uid":"dca2f8c1-38c3-4a39-a103-01c4300cfb90","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vCodSucursal"}},{"uid":"74dccfbc-02f1-4d46-a86c-7280f44bcd89","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"84bee663-bf52-4044-b0e1-d9b883e1d28e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtiene datos del Cliente en Rediseño, utilizando el Código de Procesadora que se tiene como nombre de archivo."}}]},{"uid":"e1d05e44-6cfb-4436-ba6d-a8b7b62b2078","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"abb77735-c895-4b6a-acbe-99b35901a620","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"4fe4dd04-f2d5-4276-8a08-5888365b1218","commandName":"sqlQuery","packageName":"Database","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"redis"}}},{"name":"query","value":{"type":"STRING","expression":"SELECT ge23clicod, ge24clisuc FROM gxgedta.get024 where ge24codpro=$vNombreArchivo$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[{"uid":"81f53487-e27b-436f-9748-dbac90a33057","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"6e0c5b34-e412-4ca8-bdcc-3105b141cce0","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}}]}]},{"uid":"d2eef28e-7187-49d6-a5b1-239db7925634","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"88d29a67-5acc-4dcf-9e23-9e5e94e33611","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"redis"}}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"529d88df-5372-46d5-9010-397b2823f803","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"afc71113-341a-4038-bb83-767b264acb92","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"7a664348-77eb-45b6-b8cc-2b0167ecc00d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCodCliente"}},{"uid":"8e7a8e0a-984e-4af9-8fcc-676f1582a8a8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCodSucursal"}}]},{"uid":"575fb865-57cb-41a5-9241-ab7308273c2b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"0fc16b8c-99f9-46df-91b4-d24eb941dff8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Fin de preprocesamiento de Datos correspondiente a la lógica de cada iniciativa."}}]},{"uid":"a6e22e9e-c3d8-4671-b8eb-ee4c2fc9814a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"9dd5ce35-2d50-403b-a552-c910e718c853","commandName":"if","packageName":"If","attributes":[{"name":"operator","value":{"type":"STRING","string":"AND"}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCodCliente$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}],"operatorAttribute":{"operator":"AND","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCodSucursal$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}]}}],"children":[{"uid":"d0b397fc-d676-4d17-9214-af35ea550a57","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Se obtuvieron ambos datos mediante el query a Rediseño."}}]},{"uid":"0e233816-dbc7-4524-a8ee-eacc8b9249c9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"93a23033-92cd-49fa-8470-9e21153e30a9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Envía a DOMUS"}}]},{"uid":"0d73b26f-69ab-4ba1-8229-bde214c7cea9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"2cfbc07e-51df-4349-bc1d-fddbaa32ddb5","commandName":"runTask","packageName":"TaskBot","attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Adjunto%20de%20Contratos%20V2/DOMUS_post"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"vCodCliente","value":{"type":"STRING","expression":"$vCodCliente$"}},{"key":"vCodSucursal","value":{"type":"STRING","expression":"$vCodSucursal$"}},{"key":"vOCid","value":{"type":"STRING","expression":"$vOCid$"}},{"key":"vPathAdjuntoIndividual","value":{"type":"STRING","expression":"$vPathAdjuntoIndividual$"}},{"key":"vTemplateId","value":{"type":"STRING","expression":"$vTemplateId$"}},{"key":"vLogFile","value":{"type":"STRING","expression":"$vLogFile$"}},{"key":"vExtensionArchivo","value":{"type":"STRING","expression":"$vExtensionArchivo$"}},{"key":"vNombreArchivo","value":{"type":"STRING","expression":"$vNombreArchivo$"}},{"key":"vPathProcesados","value":{"type":"STRING","expression":"$vPathProcesados$"}},{"key":"vContratoValue","value":{"type":"STRING","expression":"$vContratoValue$"}},{"key":"vEntorno","value":{"type":"STRING","expression":"$vEntorno$"}},{"key":"vPathReporteProcesados","value":{"type":"STRING","expression":"$vPathReporteProcesados$"}},{"key":"vPathReporteNoProcesados","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"vCodCliente","value":{"type":"VARIABLE","variableName":"vCodCliente"}},{"key":"vCodSucursal","value":{"type":"VARIABLE","variableName":"vCodSucursal"}},{"key":"vOCid","value":{"type":"VARIABLE","variableName":"vOCid"}},{"key":"vPathAdjuntoIndividual","value":{"type":"VARIABLE","variableName":"vPathAdjuntoIndividual"}},{"key":"vTemplateId","value":{"type":"VARIABLE","variableName":"vTemplateId"}},{"key":"vLogFile","value":{"type":"VARIABLE","variableName":"vLogFile"}},{"key":"vExtensionArchivo","value":{"type":"VARIABLE","variableName":"vExtensionArchivo"}},{"key":"vNombreArchivo","value":{"type":"VARIABLE","variableName":"vNombreArchivo"}},{"key":"vPathProcesados","value":{"type":"VARIABLE","variableName":"vPathProcesados"}},{"key":"vContratoValue","value":{"type":"VARIABLE","variableName":"vContratoValue"}},{"key":"vEntorno","value":{"type":"VARIABLE","variableName":"vEntorno"}},{"key":"vPathReporteProcesados","value":{"type":"VARIABLE","variableName":"vPathReporteProcesados"}},{"key":"vPathReporteNoProcesados","value":{"type":"VARIABLE","variableName":"vPathReporteNoProcesados"}}]}},{"uid":"bc155c86-452a-43ff-be2b-c09ff14bd56d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"75074230-8471-4f7d-87bb-c16885fe7c51","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"(FIN) Envío a DOMUS"}}]},{"uid":"2848663b-735f-410b-b7e8-2793e59940b9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]}],"branches":[{"uid":"de03ffbc-4636-46db-a9f7-4e0269cd55f3","commandName":"else","packageName":"If","attributes":[],"children":[{"uid":"5eac3466-8bee-47bf-a464-5e39d1788bd2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"No se obtuvieron todos los datos necesarios del Query, se anota al adjunto como no procesado."}}]},{"uid":"a2eec16b-b63d-4f58-9cab-d58d5a299c06","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"72df7388-84b1-4f18-9c16-41e54704a5f3","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"El archivo $Loop-Files-1{name}$ no se pudo procesar. Se detallará el caso en el reporte de no Procesados."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"1250025b-8469-4f73-a910-614a3a88169f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"7200d1e4-1719-41da-b6e6-b0fd1b77496f","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"\n---> El adjunto $Loop-Files-1{name}$.$Loop-Files-1{extension}$ no pudo subirse a DOMUS. \nMotivo: No se pudo obtener el Código Cliente o Código Sucursal.\nCodCliente: $vCodCliente$\nCodSucursal: $vCodSucursal$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]},{"uid":"5e5e0012-1e02-4fac-b6b9-6f6b6a40628d","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}}]}]},{"uid":"371cebe1-1bc0-4175-9f48-092010b622d0","commandName":"disconnect","packageName":"Database","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"redis"}}},{"name":"dosaveData","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"ae8a1975-5463-4e1d-8820-5b13fd3bf07b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"f1fd4a51-f30a-4a62-87a1-a60e7e57b556","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"7d3bd86c-75c0-4909-8ff0-82f842b8e107","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"7f765827-4162-44cd-b655-699cea695f95","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"FINALIZA MÓDULO DE ENVÍO A DOMUS"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"efe79965-aaa5-4923-83c3-f7f9a183c433","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"fc8b254b-d5fa-400c-b934-7cabf4bf2e4c","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"49ea523c-2185-4325-9f7b-c25e4d43b1f0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"1996775f-f09d-42ff-8467-e5c65b6077f4","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":" "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"20b3edb7-6879-47fd-b43e-ccaa930e638e","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFlagCarpetaVacia$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"True"}}]}],"children":[{"uid":"c7c3b042-8365-41f0-bd98-28c3893937ec","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"La carpeta estaba vacía, no se depositaron contratos."}}]},{"uid":"ad7d0c2f-24ea-41f2-8800-6145032222e7","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"ERROR"}},{"name":"content","value":{"type":"STRING","string":"CARPETA VACÍA"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"6a6b0b70-02da-4549-afed-d56c07fa71a6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"cd7f7d27-fbbf-419c-97d0-85b19a781c0a","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"La carpeta de Adjuntos se encontraba vacía, no se depositaron contratos."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5dad43b0-4242-4e90-be32-ddd48b39ff50","commandName":"SendMailV2","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vMailFrom$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vMailTo$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","expression":"$vMailError$"}},{"name":"subject","value":{"type":"STRING","string":"INCIDENTE - Carga de Adjuntos de Contratos"}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"La carpeta $vPathAdjuntos$ se encuentra vacía por lo que no se pudo subir ningún Contrato al Domus.\n\nSaludos, Equipo RPA."}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"940da7ec-0776-45a6-bb41-d90a9801f659","commandName":"stopTask","packageName":"TaskBot","attributes":[]}]},{"uid":"974ace3f-eebf-4985-bb7d-72178fa8f896","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"42d46f23-6a07-4a0d-91a4-9fbb63e0fc7c","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"2eeff388-3004-4743-b7de-1e3802f6d82a","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"4f5e7f08-c656-49a5-ba2b-2c20e1f58fc2","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"FINALIZA INFORME DE PROCESADOS "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"a2f5ffc5-9928-4f7f-92d2-d6b9c53722e5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"c5570e6f-e6c6-4360-a74e-e6493334fd2e","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"3c3b0a02-566f-48d0-b4b3-9b42f9be0cff","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"c2b7af44-ef26-4e7e-a9bf-d647eee1f5c0","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":" "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"478c043e-77b5-4ec7-b638-84a59c5598a3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"6e62b00d-a66d-491a-9abb-e2410ab3391e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Recorre la carpeta de Adjuntos para contar cuantos no fueron procesados."}}]},{"uid":"875e3056-7c2f-4338-a632-32b4558151a6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"================================="}}]},{"uid":"d34c47d4-f955-4abe-ba74-d5ea627e3dd7","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorNoProcesados"}},{"uid":"78610b72-2547-4fcc-9491-8d1ff88ba4e4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path-condition-1-1"}},{"uid":"58044647-7e6b-4544-9eaf-48de9200af34","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$m-string-start-in-path-condition-1-1.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"ed578bce-0182-492d-9969-e409965c4c87","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"8aa2aa1d-b354-462d-86cb-ae71c27d9c43","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"a53d3c75-cae7-4652-b1f1-0b088d1f8878","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Files-1"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"c316b5fa-ab91-4d84-98e9-20f6678a2cdc","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"28fbce84-6c25-4f17-a9d5-04230938bd42","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"1 + $vContadorNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorNoProcesados"}},{"uid":"a26f3e11-cc7f-4cdf-ac3f-1048c2e97eef","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vContadorNoProcesados.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorNoProcesados"}},{"uid":"3793c67c-3151-416f-9270-1fbb371946ad","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}}]}]},{"uid":"70fafa2a-5ec9-4410-9779-3eca0652202f","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vContadorNoProcesados$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThanOrEqualTo"}},{"name":"value","value":{"type":"STRING","string":"1"}}]}],"children":[{"uid":"79b064f7-9a47-4c70-84ce-ec9e2628c1fd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Hay al menos un adjunto no procesado, debe informar por correo al Equipo RPA."}}]},{"uid":"766f5d9b-036d-4620-a626-bc3bb2209403","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"SEND MAIL"}}]},{"uid":"32f09c8a-ac29-4610-9889-a44cef9de036","commandName":"SendMailV2","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vMailFrom$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vMailError$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"CONTRATOS NO PROCESADOS - Carga de Contratos."}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Se tienen $vContadorNoProcesados$ contratos no procesados.\nFavor verificar log de ejecución: $vLogFile$\n\ny el Reporte de No Procesados: $vPathReporteNoProcesados$.\n\nDocumentación: $vDocumentacion$\n"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}}]}]},{"uid":"323e10e2-4781-4639-b3f6-ecffff8f3e82","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"0413a33d-ffa3-411c-b861-dfbb1548b876","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":" "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"72d0e44b-f626-47e3-a8c2-0bacff1ced81","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"56bb6fdf-2022-4081-a8bd-91c0b7e45150","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"3aa65652-3e3f-4c32-8935-1788e708b8ac","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"7d375d80-2dfb-47e5-8e2f-8b8a4ff6cb13","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"FINALIZA INFORME DE NO PROCESADOS "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8b3a957d-6669-4cdb-9b1a-061c0256e2a0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"b71dd47f-2c48-488c-9ead-7063bb89c6b9","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"=========================================================="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"57061b06-f469-449e-96a7-dedf0e141ace","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"bc6b2e56-30a7-44e7-8370-37978df7a696","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":" "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"ae756093-28d6-40ee-b9e1-f727ec0745dc","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vContadorAdjuntos$ - $vContadorNoProcesados$"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorProcesados"}},{"uid":"c694f120-7c63-4d27-b4c4-4c384e09631f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vContadorProcesados.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vContadorProcesados"}},{"uid":"75918323-19c5-4dd5-a627-ca2079ebcfb7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Envia por correo el informe."}}]},{"uid":"f4fc5d6e-d8ec-42bd-9255-17378af4c7aa","commandName":"split","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathReporteProcesados$;$vPathReporteNoProcesados$"}},{"name":"delimiter","value":{"type":"STRING","string":";"}},{"name":"limit","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-list-string-1"}},{"uid":"16c440a1-d1fe-404a-84d4-1c3ce8ed68ff","commandName":"clear","packageName":"List","attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"m-email-attachment-list-file-1"}}]},{"uid":"db3d0661-a61b-46dd-8205-8a17ee3b63d6","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"},"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-item-string-1"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"m-email-attachment-list-string-1"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"6cc9c220-f27a-4bb9-97a1-b8add9e17359","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$m-email-attachment-item-string-1$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}]}],"children":[{"uid":"2ca90659-e727-4445-ac84-aefd7567a3a0","commandName":"assign","packageName":"File","attributes":[{"name":"sourceFile","value":{"type":"FILE","expression":"file://$m-email-attachment-item-string-1$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-item-file-1"}},{"uid":"41a00e70-1e35-4182-b88c-1f85220c5922","commandName":"addItem","packageName":"List","attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"m-email-attachment-list-file-1"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"m-email-attachment-item-file-1"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}]}]},{"uid":"3549a7f5-772b-42cf-af1a-98a6951f573c","commandName":"SendMailV2","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vMailFrom$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vMailTo$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","expression":"$vMailError$"}},{"name":"subject","value":{"type":"STRING","string":"Carga de Contratos"}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Buenas, se adjunta el reporte de Contratos Procesados y No Procesados.\n\nTotal de Adjuntos de Contratos: $vContadorAdjuntos$\nTotal de Contratos Procesados: $vContadorProcesados$\nTotal de Contratos No Procesados: $vContadorNoProcesados$\n\nLos Contratos que subieron correctamente al DOMUS se encuentran en la carpeta $vPathProcesados$ mientras que los que tuvieron errores se mantienen en la carpeta $vPathAdjuntos$.\n\nSaludos, Equipo RPA."}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fileList","value":{"type":"LIST","expression":"$m-email-attachment-list-file-1$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"746cdc9d-118c-482f-a974-3475659aa6fc","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"9fd6e64b-def2-42e3-bcfb-4f9afb41f061","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"Finalizó la generación de Informes de Procesados y No Procesados."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b9c2fb21-844b-4e4b-b7ff-d3e13047dc29","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"5f69b296-704b-4c1e-8f27-0983ed669e45","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":" "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"e163c5ad-8294-47fc-a4cc-58f5c0a5a353","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"ee079e64-4dff-402a-8ac5-87ae577685d5","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"***************************************************************************************"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"51e58f84-a089-4777-af4b-c5b154b487d0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"7e1f4745-c957-4a01-a919-0882b1e13c8c","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"FINALIZA EL PROCESO"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"18b44d2f-9b61-43e3-b537-ebea4cb79635","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"4bbacbfd-76ac-4fc7-8157-6ed9f028cfe8","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","string":"***************************************************************************************"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"fc10b0b4-0d13-493d-9711-905a16005010","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"a248a3d7-a952-4ccf-8789-5d09462816ed","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"bf8ad969-740e-41e7-bf97-89bb42bd96ed","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogFile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"8cafdebe-613f-4d00-b087-1a74317ce5ac","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"*****************************************\n[$Error-LineNumber.Number:toString$] - $Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"9d3493b8-6bed-4524-9a88-0007af44b3f0","commandName":"stopTask","packageName":"TaskBot","attributes":[]}]}]}],"branches":[{"uid":"306717a4-9046-45ec-a877-16db15efa9ad","commandName":"finally","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"4e4877f2-7732-4f75-946d-4d9365d4ce40","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}]}],"children":[{"uid":"e516f0e6-4651-49e2-a501-87a191b64a82","commandName":"throw","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vCodCliente","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCodSucursal","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathAdjuntoCarpeta","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathAdjuntoIndividual","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathProcesados","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathReportes","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaEjecucion","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathReporteProcesados","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathReporteNoProcesados","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vOCid","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTemplateId","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vContador","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"1"}},{"name":"vHeader","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"},{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"vTokenC4C","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vResponse","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vObjectID","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCodClienteSuc","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vRespuestaRest","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"},{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"vStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vServicioRest","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNombreArchivo","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vExtensionArchivo","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathNoProcesados","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMailTo","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMailFrom","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMailError","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathAdjuntos","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vEntorno","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFlagEjecucion","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vContratoValue","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogFile","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFlagCarpetaVacia","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDocumentacion","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vContadorAdjuntos","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vContadorNoProcesados","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vContadorProcesados","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Loop-Files","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"extension","value":{"type":"STRING","string":""}},{"key":"name","value":{"type":"STRING","string":""}}]}},{"name":"Loop-Files-1","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"extension","value":{"type":"STRING","string":""}},{"key":"name","value":{"type":"STRING","string":""}}]}},{"name":"Loop-Dataset-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-email-attachment-list-string-1","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[]}},{"name":"m-email-attachment-item-string-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"m-email-attachment-item-file-1","description":"","type":"FILE","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-email-attachment-list-file-1","description":"","type":"LIST","subtype":"FILE","input":true,"output":true,"defaultValue":{"type":"LIST","list":[]}},{"name":"m-string-start-in-path-condition-1-1","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"ErrorHandler","version":"2.11.3-20230316-162433"},{"name":"Number","version":"3.8.0"},{"name":"Comment","version":"2.14.0"},{"name":"String","version":"5.7.1"},{"name":"If","version":"3.6.2-20230316-161323"},{"name":"LegacyAutomation","version":"6.2.0"},{"name":"File","version":"6.7.0"},{"name":"TaskBot","version":"2.7.2-20230316-160508"},{"name":"LogToFile","version":"3.7.0"},{"name":"Email","version":"3.17.6"},{"name":"Database","version":"5.1.0"},{"name":"Folder","version":"6.7.0"},{"name":"Loop","version":"3.7.5-20230316-155504"},{"name":"Boolean","version":"2.9.0"},{"name":"Record","version":"1.8.2"},{"name":"MessageBox","version":"3.6.0"},{"name":"List","version":"2.11.0"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM","timeout":"0s"}}