{"nodes":[{"uid":"56723fc8-222e-4a68-bbdd-480c078ea0da","commandName":"connect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"redis"}},{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Password=SLKDILA583;Persist Security Info=True;User ID=RPAODBC;Extended Properties=\"DSN=Conti Procesadora Nuevo;SYSTEM=192.168.109.149;UID=RPAODBC;DBQ=QGPL *usrlibl;DFTPKGLIB=QGPL;LANGUAGEID=ENU;PKG=QGPL/DEFAULT(IBM),2,0,1,0,512;QRYSTGLMT=-1;\";Initial Catalog=S106C98E"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"3350ddca-cd7b-4d07-9941-03f48896ba1b","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Bancard\\Public\\ESCANEO DE CONTRATOS\\Procesados 17092022"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathAdjuntos"}},{"uid":"e7bb2862-f376-4d28-bd85-3dcd95843da5","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Bancard\\Public\\ESCANEO DE CONTRATOS\\"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathAdjuntos"}},{"uid":"d89e9ea8-0bff-4dce-803c-b9fe18841c84","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path-condition-1-1"}},{"uid":"62f23ecf-0b86-4f40-81dc-91e3af8621df","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$m-string-start-in-path-condition-1-1.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"dd2ee660-1e00-41ec-aba5-607121f7ce87","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"c92569fe-765a-4f15-9f2f-07e75b2cce61","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"e6c72b18-eb0e-4825-88ce-e9fcfa27306a","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Files-1"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"c0f38d55-167d-4919-b997-ad89182246ab","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"016ce5f7-ecfc-417a-b9bc-e0c9750791c9","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Files-1{name}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNombreArchivo"}},{"uid":"741cb0fa-0396-4d2d-becd-032af1f8c2f2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNombreArchivo.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNombreArchivo"}},{"uid":"6c3d1964-716f-4e99-96c6-103b4128e2d2","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"redis"}},{"name":"query","value":{"type":"STRING","expression":"SELECT ge23clicod, ge24clisuc FROM gxgedta.get024 where ge24codpro=$vNombreArchivo$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"eb6caeaa-1b05-4156-a394-ef9590685776","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vCodCliente"}},{"uid":"2ce8b1c9-0d4a-4923-9334-901ffd664162","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vCodSucursal"}},{"uid":"1f98acc0-29df-4af4-bdce-708c6551b890","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"2a3e811b-9c8a-4e84-92e1-06082ed5a4ef","commandName":"loop.commands.start","packageName":"Loop","disabled":true,"attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"STRING","string":"redis"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"748b4a3d-6634-4a84-bbf7-ecbc739560dc","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"9cec837f-4430-47cc-a8a0-28400cb3d7cd","commandName":"assign","packageName":"Record","disabled":true,"attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"3c842bf8-876f-4568-8112-9d9e141be98c","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCodCliente"}},{"uid":"71446b2c-916c-449f-8a53-79959bc7f5fe","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCodSucursal"}}]},{"uid":"e445efdb-5673-44f6-8bbb-cd2134c6b8ac","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vSalidaSoap"}},{"uid":"f96477d7-3e97-4164-8981-2dfff0649702","commandName":"soapCommand","packageName":"SoapWebService","disabled":true,"attributes":[{"name":"authenticationMode","value":{"type":"STRING","string":"Basic"}},{"name":"basicUserName","value":{"type":"STRING","string":"RPA"}},{"name":"basicPassword","value":{"type":"STRING","string":"Password*"}},{"name":"serviceName","value":{"type":"STRING","string":"IntegrationDoMUSWS"}},{"name":"operation","value":{"type":"STRING","string":"queryDomus"}},{"name":"scope","value":{"type":"STRING","string":"completeResponse"}},{"name":"radioValue","value":{"type":"STRING","string":"selectedResponse"}},{"name":"rawData","value":{"type":"STRING","expression":"<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:fac=\"http://facadeWS.accsa.com/\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <fac:queryDomus>\n         <!--Optional:-->\n         <login>\n            <host>10.50.30.20</host>\n            <module>0</module> \n            <password>Password*</password>\n            <port>1830</port>\n            <user>RPA</user>\n         </login>\n         <!--Optional:-->\n         <querySpec>\n            <!--1 or more repetitions:-->\n            <filters>\n               <!--Optional:-->\n               <firstArg>$vCodCliente$</firstArg>\n               <id></id>\n               <leftDelim>?</leftDelim>\n               <!--Optional:-->\n               <logicOperator>?</logicOperator>\n               <!--Optional:-->\n               <name>CodCliente</name>\n               <!--Optional:-->\n               <operator>eq</operator>\n               <rightDelim>?</rightDelim>\n               <!--Optional:-->\n               <secondArg>?</secondArg>\n            </filters>\n            <filters>\n               <!--Optional:-->\n               <firstArg>$vCodSucursal$</firstArg>\n               <id></id>\n               <leftDelim>?</leftDelim>\n               <!--Optional:-->\n               <logicOperator>?</logicOperator>\n               <!--Optional:-->\n               <name>CodSucursal</name>\n               <!--Optional:-->\n               <operator>eq</operator>\n               <rightDelim>?</rightDelim>\n               <!--Optional:-->\n               <secondArg>?</secondArg>\n            </filters>\n\t\t\t<filters>\n               <!--Optional:-->\n               <firstArg>6</firstArg>\n               <id></id>\n               <leftDelim>?</leftDelim>\n               <!--Optional:-->\n               <logicOperator>?</logicOperator>\n               <!--Optional:-->\n               <name>TIPOADJUNTO</name>\n               <!--Optional:-->\n               <operator>eq</operator>\n               <rightDelim>?</rightDelim>\n               <!--Optional:-->\n               <secondArg>?</secondArg>\n            </filters>\n            <!--1 or more repetitions:-->\n            <fields>\n               <id>1317</id>\n               <!--Optional:-->\n               <name>PK</name>\n               <!--Optional:-->\n               <order>?</order>\n            </fields>\n            <pageSize>?</pageSize>\n            <templateId>16328199</templateId>\n            <!--Optional:-->\n            <templateName>?</templateName>\n         </querySpec>\n      </fac:queryDomus>\n   </soapenv:Body>\n</soapenv:Envelope>"}},{"name":"portName","value":{"type":"STRING","string":"IntegrationDoMUSWSPort"}},{"name":"soapVersion","value":{"type":"STRING","string":"SOAP 1.1 Protocol"}},{"name":"radioValue","value":{"type":"STRING","string":"selectedResponse"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"wsdlUri","value":{"type":"STRING","string":"http://10.50.30.20:8080/domus-web/IntegrationDoMUSWS?WSDL"}},{"name":"uri","value":{"type":"STRING","string":"http://10.50.30.20:8080/domus-web/IntegrationDoMUSWS/queryDomus?parameters="}},{"name":"wsdlUriOption","value":{"type":"STRING","string":"uri"}},{"name":"timeout","value":{"type":"NUMBER","expression":"$@AASoapTimeOut$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSalidaSoap"}},{"uid":"043f7a72-43e4-42e6-8d46-ffd728ce5bfb","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","expression":"\nVariable : $vSalidaSoap$\nOperator : Includes\n\nFix : <documents>\nThen : \n\n\n"}}]},{"uid":"4cf87d52-68fc-41be-8880-fa76a9c5d9bf","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vFlag"}},{"uid":"908ab660-8b40-4d18-9749-4bc2f6e37516","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Else"}}]},{"uid":"9dfd132f-3a83-4808-9771-6e41d9300e73","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vFlag"}},{"uid":"5782e0da-9672-44a0-9d67-f2f4930eeab6","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"EndIf"}}]},{"uid":"a281f031-67c4-4c15-9001-93d28e77b2f1","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","expression":"If $vCodCliente$ Equal To (=) \"\" OR $vCodSucursal$ Equal To (=) \"\" Then\nOperator : \nOperator : 1\nValue : 1\nThen : \n\n\n\n\n\n\n"}}]},{"uid":"2cca2584-ec21-41d9-93a1-43d08170a3cf","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Tasks/Adjunto%20de%20Contratos%20V2/Logs/Cod%20Procesadora%20erroneo.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$vNombreArchivo$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"71ceb320-f170-470e-90fe-14e43f6d26bd","commandName":"copyFiles","packageName":"File","disabled":true,"attributes":[{"name":"destinationPath","value":{"type":"STRING","expression":"\\\\nas\\Bancard\\Public\\ESCANEO DE CONTRATOS\\$vNombreArchivo$.pdf"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}},{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vPathAdjuntos$/$vNombreArchivo$.pdf"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"7b607a70-89e9-47dd-9e7f-90710e9e57ce","commandName":"deleteFiles","packageName":"File","disabled":true,"attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vPathAdjuntos$/$vNombreArchivo$.pdf"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"cfe807c5-aaa5-48a1-8515-30c2c948ae04","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"EndIf"}}]},{"uid":"cd5d5916-963b-4477-a86b-12ad1c41a4a6","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Tasks/Adjunto%20de%20Contratos%20V2/Logs/Procesadora%20erroneo.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$vNombreArchivo$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]}],"variables":[{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vNombreArchivo","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathAdjuntos","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCodCliente","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCodSucursal","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"vSalidaSoap","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vObjectID","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFlag","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Files","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"extension","value":{"type":"STRING","string":""}},{"key":"name","value":{"type":"STRING","string":""}}]}},{"name":"Loop-Files-1","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"extension","value":{"type":"STRING","string":""}},{"key":"name","value":{"type":"STRING","string":""}}]}},{"name":"Loop-Dataset-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-start-in-path-condition-1-1","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"Database","version":"4.10.5-20221119-112148"},{"name":"String","version":"5.5.2-20221006-094641"},{"name":"If","version":"3.5.0-20220928-201537"},{"name":"LegacyAutomation","version":"5.6.1-20221027-080331"},{"name":"Folder","version":"6.5.0-20221003-160340"},{"name":"Loop","version":"3.6.0-20220928-191723"},{"name":"Number","version":"3.6.0-20220928-104414"},{"name":"File","version":"6.5.0-20221003-160340"},{"name":"Record","version":"1.6.3-20220919-051027"},{"name":"SoapWebService","version":"3.13.1-20221025-092212"},{"name":"Comment","version":"2.12.0"},{"name":"LogToFile","version":"3.5.0-20220416-233918"},{"name":"System","version":"3.10.0-20220921-062556"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM","timeout":"0s"}}