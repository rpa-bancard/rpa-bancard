{"nodes":[{"uid":"c489bf7a-827c-4a4e-9698-8dd742dd63ce","commandName":"connect","packageName":"Database","attributes":[{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Password=SLKDILA583;Persist Security Info=True;User ID=RPAODBC;Extended Properties=\"DSN=Conti Procesadora Nuevo;SYSTEM=192.168.109.149;UID=RPAODBC;DBQ=QGPL *usrlibl;DFTPKGLIB=QGPL;LANGUAGEID=ENU;PKG=QGPL/DEFAULT(IBM),2,0,1,0,512;QRYSTGLMT=-1;\";Initial Catalog=S106C98E"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"redis"},"sessionTarget":"LOCAL"}},{"uid":"1f4f0d2d-cf82-4f9d-a1f1-3dc95e61ec8e","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Bancard\\Public\\ESCANEO DE CONTRATOS\\Procesados 17092022"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathAdjuntos"}},{"uid":"7d33116e-58f7-47ab-911e-cec5bf5ff474","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Bancard\\Public\\ESCANEO DE CONTRATOS\\"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathAdjuntos"}},{"uid":"e1a4d897-6b8b-43d2-a86c-fcdcf6a74e8f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path-condition-1-1"}},{"uid":"23abeccb-8f42-4321-b424-e3d241830ceb","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$m-string-start-in-path-condition-1-1.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"8577ce8f-8d15-494f-acdd-847ce9234e24","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"8075de89-f19c-43eb-8469-cc4965c1c668","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"cdf86c01-d7e0-42a7-b2ca-5ead7e00bc47","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Files-1"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"4173841d-5bf9-4bdf-a529-24ef1fbd484c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"d649cacc-2686-4902-8e0c-336cf28eaaae","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Files-1{name}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNombreArchivo"}},{"uid":"9207b741-1b87-4f98-958b-f5eaba082f9a","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNombreArchivo.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNombreArchivo"}},{"uid":"4caf9bd3-58aa-4825-a8b7-70c3fc9212fd","commandName":"sqlQuery","packageName":"Database","disabled":true,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"redis"}}},{"name":"query","value":{"type":"STRING","expression":"SELECT ge23clicod, ge24clisuc FROM gxgedta.get024 where ge24codpro=$vNombreArchivo$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"noBlankCSV","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"af3d630e-9ec8-490f-b50a-9458a3157bc5","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vCodCliente"}},{"uid":"4e8192ae-cfae-4576-ab30-d63b22afa74d","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vCodSucursal"}},{"uid":"d6207fb3-c0f9-4352-b163-8282099c1504","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"6f6779db-c9e9-48c9-9217-7411938f113b","commandName":"loop.commands.start","packageName":"Loop","disabled":true,"attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"},"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"redis"}}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"8684c463-a8d7-4df8-af80-ec18fc96721c","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"fd9fd08d-448d-40a3-87b6-5f0efae3a128","commandName":"assign","packageName":"Record","disabled":true,"attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Dataset-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Dataset-Column"}},{"uid":"d11be252-e2a5-41d2-9fcd-052226654cd6","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCodCliente"}},{"uid":"d45a8d8c-5281-48a4-810a-ab680e5e16e9","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Dataset-Column-1[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCodSucursal"}}]},{"uid":"abc24bf1-7e77-45fa-8c91-7b17120968df","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vSalidaSoap"}},{"uid":"58a4da53-6f4e-4e02-bee9-fc24cfc4dad9","commandName":"soapCommand","packageName":"SoapWebService","disabled":true,"attributes":[{"name":"authenticationMode","value":{"type":"STRING","string":"Basic"}},{"name":"basicUserName","value":{"type":"STRING","string":"RPA"}},{"name":"basicPassword","value":{"type":"STRING","string":"Password*"}},{"name":"serviceName","value":{"type":"STRING","string":"IntegrationDoMUSWS"}},{"name":"operation","value":{"type":"STRING","string":"queryDomus"}},{"name":"scope","value":{"type":"STRING","string":"completeResponse"}},{"name":"radioValue","value":{"type":"STRING","string":"selectedResponse"}},{"name":"rawData","value":{"type":"STRING","expression":"<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:fac=\"http://facadeWS.accsa.com/\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <fac:queryDomus>\n         <!--Optional:-->\n         <login>\n            <host>10.50.30.20</host>\n            <module>0</module> \n            <password>Password*</password>\n            <port>1830</port>\n            <user>RPA</user>\n         </login>\n         <!--Optional:-->\n         <querySpec>\n            <!--1 or more repetitions:-->\n            <filters>\n               <!--Optional:-->\n               <firstArg>$vCodCliente$</firstArg>\n               <id></id>\n               <leftDelim>?</leftDelim>\n               <!--Optional:-->\n               <logicOperator>?</logicOperator>\n               <!--Optional:-->\n               <name>CodCliente</name>\n               <!--Optional:-->\n               <operator>eq</operator>\n               <rightDelim>?</rightDelim>\n               <!--Optional:-->\n               <secondArg>?</secondArg>\n            </filters>\n            <filters>\n               <!--Optional:-->\n               <firstArg>$vCodSucursal$</firstArg>\n               <id></id>\n               <leftDelim>?</leftDelim>\n               <!--Optional:-->\n               <logicOperator>?</logicOperator>\n               <!--Optional:-->\n               <name>CodSucursal</name>\n               <!--Optional:-->\n               <operator>eq</operator>\n               <rightDelim>?</rightDelim>\n               <!--Optional:-->\n               <secondArg>?</secondArg>\n            </filters>\n\t\t\t<filters>\n               <!--Optional:-->\n               <firstArg>6</firstArg>\n               <id></id>\n               <leftDelim>?</leftDelim>\n               <!--Optional:-->\n               <logicOperator>?</logicOperator>\n               <!--Optional:-->\n               <name>TIPOADJUNTO</name>\n               <!--Optional:-->\n               <operator>eq</operator>\n               <rightDelim>?</rightDelim>\n               <!--Optional:-->\n               <secondArg>?</secondArg>\n            </filters>\n            <!--1 or more repetitions:-->\n            <fields>\n               <id>1317</id>\n               <!--Optional:-->\n               <name>PK</name>\n               <!--Optional:-->\n               <order>?</order>\n            </fields>\n            <pageSize>?</pageSize>\n            <templateId>16328199</templateId>\n            <!--Optional:-->\n            <templateName>?</templateName>\n         </querySpec>\n      </fac:queryDomus>\n   </soapenv:Body>\n</soapenv:Envelope>"}},{"name":"portName","value":{"type":"STRING","string":"IntegrationDoMUSWSPort"}},{"name":"soapVersion","value":{"type":"STRING","string":"SOAP 1.1 Protocol"}},{"name":"radioValue","value":{"type":"STRING","string":"selectedResponse"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"wsdlUri","value":{"type":"STRING","string":"http://10.50.30.20:8080/domus-web/IntegrationDoMUSWS?WSDL"}},{"name":"uri","value":{"type":"STRING","string":"http://10.50.30.20:8080/domus-web/IntegrationDoMUSWS/queryDomus?parameters="}},{"name":"wsdlUriOption","value":{"type":"STRING","string":"uri"}},{"name":"timeout","value":{"type":"NUMBER","expression":"$@AASoapTimeOut$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSalidaSoap"}},{"uid":"512905cb-0689-46ce-8688-1d1745d59bf3","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\nVariable : $vSalidaSoap$\nOperator : Includes\n\nFix : <documents>\nThen : \n\n\n"}}]},{"uid":"0c00e46c-d63f-4aa2-b2ad-c432547bc1c1","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vFlag"}},{"uid":"b09c9743-04b7-4efc-a7da-5bf23a785ab4","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Else"}}]},{"uid":"92b38400-0ed9-48fa-8cf3-c8bd253ba10a","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vFlag"}},{"uid":"9e46a43d-d914-4a06-8441-30db7d89f32c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"EndIf"}}]},{"uid":"04dc0499-04b1-4eec-9d09-e51c5a18f6ed","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If $vCodCliente$ Equal To (=) \"\" OR $vCodSucursal$ Equal To (=) \"\" Then\nOperator : \nOperator : 1\nValue : 1\nThen : \n\n\n\n\n\n\n"}}]},{"uid":"33a3bb49-0d10-4c02-b889-3347a39c49dc","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Tasks/Adjunto%20de%20Contratos%20V2/Logs/Cod%20Procesadora%20erroneo.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$vNombreArchivo$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"bbed7471-e88c-4b6d-8a27-a56987616b6a","commandName":"copyFiles","packageName":"File","disabled":true,"attributes":[{"name":"destinationPath","value":{"type":"STRING","expression":"\\\\nas\\Bancard\\Public\\ESCANEO DE CONTRATOS\\$vNombreArchivo$.pdf"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}},{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vPathAdjuntos$/$vNombreArchivo$.pdf"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}},{"name":"isParallel","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"54400212-3cd7-4e5e-9ed5-71ccd833b79a","commandName":"deleteFiles","packageName":"File","disabled":true,"attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vPathAdjuntos$/$vNombreArchivo$.pdf"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"5f82e147-e60a-437e-90e8-7a082011966d","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"EndIf"}}]},{"uid":"8d577f25-eaa3-4e5b-908b-e8ad4ba9c599","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Tasks/Adjunto%20de%20Contratos%20V2/Logs/Procesadora%20erroneo.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$vNombreArchivo$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b6526d90-2e77-4448-87e2-7ee99cd5aaec","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathAdjuntos$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}}]}]}],"variables":[{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vNombreArchivo","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathAdjuntos","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCodCliente","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vCodSucursal","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"vSalidaSoap","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vObjectID","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFlag","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Files","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"extension","value":{"type":"STRING","string":""}},{"key":"name","value":{"type":"STRING","string":""}}]}},{"name":"Loop-Files-1","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"extension","value":{"type":"STRING","string":""}},{"key":"name","value":{"type":"STRING","string":""}}]}},{"name":"Loop-Dataset-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Dataset-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-start-in-path-condition-1-1","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"Database","version":"5.1.0"},{"name":"String","version":"5.7.1"},{"name":"If","version":"3.6.2-20230316-161323"},{"name":"LegacyAutomation","version":"6.2.0"},{"name":"Folder","version":"6.7.0"},{"name":"Loop","version":"3.7.5-20230316-155504"},{"name":"Number","version":"3.8.0"},{"name":"File","version":"6.7.0"},{"name":"Record","version":"1.8.2"},{"name":"SoapWebService","version":"3.17.0"},{"name":"Comment","version":"2.14.0"},{"name":"LogToFile","version":"3.7.0"},{"name":"System","version":"3.12.0"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM","timeout":"0s"}}