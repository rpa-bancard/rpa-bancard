{"nodes":[{"uid":"9206bc31-bca0-43dc-b93f-af449a80d434","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"9c4c7581-edc6-43cf-b84e-8587bfdfe65f","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"f84f641c-848b-4401-967a-3756cb0f039d","commandName":"OpenSpreadsheet","packageName":"Excel_MS","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vPathTemp$/$vNombreCierre$"}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"excelSourceOption","value":{"type":"STRING","string":"desktopfilepath"}},{"name":"secureToRead","value":{"type":"STRING","string":""}},{"name":"secureToEdit","value":{"type":"STRING","string":""}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"excludeHiddenSheets","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"},"sessionTarget":"LOCAL"}},{"uid":"1d7b3182-4d00-4688-a0e6-8c17cc423161","commandName":"OpenSpreadsheet","packageName":"Excel_MS","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vPathTemp$/$vNombreFlash$"}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"excelSourceOption","value":{"type":"STRING","string":"desktopfilepath"}},{"name":"secureToRead","value":{"type":"STRING","string":""}},{"name":"secureToEdit","value":{"type":"STRING","string":""}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"excludeHiddenSheets","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"},"sessionTarget":"LOCAL"}},{"uid":"3a07c238-38c1-4b45-ab8f-9adefaa1afd6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"80269daa-af12-414d-84a8-e2c3309303a0","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"},"attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$aHojas.DataTable:rowCount$"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"81a5c3bc-7c11-4398-b7ca-b916d61cfae3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"3c29fa42-ef42-4ea7-8cf8-6fdb9b15a3d3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*************************************************************************************Se busca la nueva columna en el archivo Flash\n*************************************************************************************"}}]},{"uid":"9a5bbb4a-5248-405c-b111-11f96064d0e8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$aHojas[$Loop-Counter-1.LegacyAutomation:getDecrementedNumber$][0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vHoja"}},{"uid":"18c3536b-6e5f-4327-b15e-cca9c43f2a3e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vHoja.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vHoja"}},{"uid":"77bd40a9-dbf4-4d46-ae75-f3b4509ba078","commandName":"SwitchToSheet","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$vHoja$"}}]},{"uid":"c3c3570e-d677-4d1d-8966-11e3c38804d0","commandName":"GoToCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}}]},{"uid":"8b7077b3-a791-4d28-9bf9-afbdf786e425","commandName":"GetSingleCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}}],"returnTo":{"type":"VARIABLE","variableName":"vCelda"}},{"uid":"8333afab-3d2e-4185-9f2e-0f73d620032c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"5a31a335-4aa0-43d9-9de5-3f07a24441f2","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"checkConditionAtEnd","value":{"type":"BOOLEAN","boolean":false}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCelda$"}},{"name":"operator","value":{"type":"STRING","string":"NOTINCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vNombreMesAnt$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}]},{"name":"loopType","value":{"type":"STRING","string":"WHILE"}}],"children":[{"uid":"e0b55d74-bed4-475f-b938-2fe94792d6f8","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"7744634c-ce9c-460d-b064-9c8e71bae29f","commandName":"GoToCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"c4003f6c-e4fe-48cc-8399-99e6f511b8ce","commandName":"GetSingleCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"activeCell","value":{"type":"STRING","string":"true"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_VALUE"}}],"returnTo":{"type":"VARIABLE","variableName":"vCelda"}}]},{"uid":"f8790992-841f-4958-a645-531de5821d48","commandName":"GetSingleColumnName","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"activeCell","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"m-excel-column-name"}},{"uid":"024eb66d-898e-4332-9320-4967634663b0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$m-excel-column-name$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNuevaColumna"}},{"uid":"14496ed4-9397-4e84-a251-c7cf53de665c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*************************************************************************************Se busca la ultima columna en el archivo Cierre\n*************************************************************************************"}}]},{"uid":"68d25880-7b9d-4472-a728-1a6bb38c791f","commandName":"SwitchToSheet","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$vHoja$"}}]},{"uid":"f504735d-1341-43ee-945f-470d447af4a3","commandName":"GoToCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}}]},{"uid":"47cedac8-6e1b-4e56-b059-a9657d971cd4","commandName":"GetSingleCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"activeCell","value":{"type":"STRING","string":"true"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_VALUE"}}],"returnTo":{"type":"VARIABLE","variableName":"vCelda"}},{"uid":"93818420-186c-4568-b655-1cdfaf93f361","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"43f5f3d4-a745-4558-992e-e39a621e0654","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"checkConditionAtEnd","value":{"type":"BOOLEAN","boolean":false}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCelda$"}},{"name":"operator","value":{"type":"STRING","string":"NOTINCLUDE"}},{"name":"value","value":{"type":"STRING","string":"variacion"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}]},{"name":"loopType","value":{"type":"STRING","string":"WHILE"}}],"children":[{"uid":"fb543765-8e8b-4fe2-b648-62f564122d4c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"d6ced3f7-2ccd-40dc-b360-91ef21bf7535","commandName":"GoToCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"d78090fb-1d77-41ef-8254-cee568ff8f00","commandName":"GetSingleCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"activeCell","value":{"type":"STRING","string":"true"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_VALUE"}}],"returnTo":{"type":"VARIABLE","variableName":"vCelda"}}]},{"uid":"93748816-6444-41c5-92ec-5e22cccdcdee","commandName":"GoToCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"6f0feb56-38b4-4a12-8683-e84c0d22c2d5","commandName":"GetSingleCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"activeCell","value":{"type":"STRING","string":"true"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_VALUE"}}],"returnTo":{"type":"VARIABLE","variableName":"vCelda"}},{"uid":"b9a0cf94-35f7-4c0c-828e-c5e1fcf7b482","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"3121bce0-a11c-431e-bcd4-a5189ad0df7b","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"checkConditionAtEnd","value":{"type":"BOOLEAN","boolean":false}},{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCelda$"}},{"name":"operator","value":{"type":"STRING","string":"NOTINCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vNombreMesAnt$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}]},{"name":"loopType","value":{"type":"STRING","string":"WHILE"}}],"children":[{"uid":"6b4fa349-0b68-4ca5-af70-ad3fadb2e739","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"fcce7cea-f78c-4bb9-9036-e7ad639286ad","commandName":"GoToCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"cellOption","value":{"type":"STRING","string":"ActiveCell"}},{"name":"selection","value":{"type":"STRING","string":"OneCellRight"}}]},{"uid":"716dfb3d-3035-4f9a-8732-20a3bd93d63f","commandName":"GetSingleCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"activeCell","value":{"type":"STRING","string":"true"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_VALUE"}}],"returnTo":{"type":"VARIABLE","variableName":"vCelda"}}]},{"uid":"6fc98289-6162-4796-ba84-e1632251e56f","commandName":"GetSingleColumnName","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"activeCell","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"m-excel-column-name"}},{"uid":"08821a51-39d8-4e1e-bc4a-4072e062e237","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$m-excel-column-name$"}}],"returnTo":{"type":"VARIABLE","variableName":"vUltimaColumna"}},{"uid":"92240ede-6ad6-4cca-a0b2-60cdd692d911","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*************************************************************************************Se busca la ultima fila en el archivo Cierre\n*************************************************************************************"}}]},{"uid":"38017d71-2457-4594-9021-f850eecc2a27","commandName":"find","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"from","value":{"type":"STRING","string":"BEGINNING"}},{"name":"till","value":{"type":"STRING","string":"END"}},{"name":"findText","value":{"type":"STRING","expression":"$aHojas[$Loop-Counter-1.LegacyAutomation:getDecrementedNumber$][1]$"}},{"name":"searchOptions","value":{"type":"STRING","string":"BYROWS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"matchEntireCell","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"lFilas"}},{"uid":"879824f9-ab5d-4f78-8f22-647693081429","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$lFilas.LegacyAutomation:getLegacyIndexValue($Loop-Counter-1.LegacyAutomation:getDecrementedNumber$)$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}]}],"children":[{"uid":"c8290f20-0b61-4c0e-a977-c91d7433c356","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$lFilas.LegacyAutomation:getLegacyIndexValue($Loop-Counter-1.LegacyAutomation:getDecrementedNumber$)$"}}],"returnTo":{"type":"VARIABLE","variableName":"vUltimaFila"}},{"uid":"f8a5b958-9fbf-45d6-94aa-9ec42ae31682","commandName":"subString","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vUltimaFila$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"2"}}],"returnTo":{"type":"VARIABLE","variableName":"vUltimaFila"}}],"branches":[{"uid":"820e5d5f-9b5a-4fc0-953c-0d472199e7af","commandName":"else","packageName":"If","attributes":[],"children":[{"uid":"64643f44-0e78-4976-8b03-9b8967ece1c9","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"200"}}],"returnTo":{"type":"VARIABLE","variableName":"vUltimaFila"}}]}]},{"uid":"6cc658ce-f84b-4ea9-8bb5-9d259be8a885","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*************************************************************************************Copia los valores del mes anterior a la nueva columna\n*************************************************************************************"}}]},{"uid":"600690f2-9200-4608-ae4f-f562f7e4798c","commandName":"GetMultipleCells","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"loopSelection","value":{"type":"STRING","string":"CELL_RANGE"}},{"name":"fromCell","value":{"type":"STRING","expression":"$vUltimaColumna$1"}},{"name":"toCell","value":{"type":"STRING","expression":"$vUltimaColumna$$vUltimaFila$"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_VALUE"}}],"returnTo":{"type":"VARIABLE","variableName":"m-temp-get-multiple-cells-1"}},{"uid":"7b97c435-6244-49a8-92b5-401a285fd6d1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"763cbf85-cda5-4259-ab0c-670e62e6fd4f","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Excel-Column-1"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"m-temp-get-multiple-cells-1"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"89456680-64a8-44c5-b88d-a4ea13444544","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"93cb235e-9228-4f66-ae25-4f0dfc2ef9fc","commandName":"assign","packageName":"Record","attributes":[{"name":"sourceRecord","value":{"type":"VARIABLE","variableName":"Loop-Excel-Column-1"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Excel-Column"}},{"uid":"84139948-4b5c-4073-bf2f-91908307f09e","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$Loop-Counter-2$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":"1"}}]}],"children":[{"uid":"1113527d-39b9-45d6-af00-430d936d480a","commandName":"SetCell","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"cell","value":{"type":"STRING","expression":"$vNuevaColumna$$Loop-Counter-2$"}},{"name":"value","value":{"type":"STRING","expression":"$Loop-Excel-Column-1[0]$"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}}]}]}]}]},{"uid":"aee769f5-1554-481b-a278-3861eee18d26","commandName":"CloseSpreadsheet","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Flash"}}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"b543b195-bd03-42f9-b919-b2e6002657a4","commandName":"CloseSpreadsheet","packageName":"Excel_MS","attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Cierre"}}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"da63fcda-b887-495e-b8a0-b08e73f7aa23","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"a3923b23-d07e-4221-876d-baa701155b49","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"de312345-fb2c-48c2-af18-6fcf3eea1847","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vPathLog$\\Log-$System:Year.Number:toString$-$System:Month.Number:toString$-$System:Day.Number:toString$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"0515c0bb-4140-4060-9179-879c2c087097","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Error al copiar los datos del mes pasado\nTarea: $System:AATaskName$ \nLinea: $Error-LineNumber.Number:toString$\nError: $Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"73807f80-beee-4ba4-b352-5775b0064633","commandName":"createFolder","packageName":"Folder","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Temp\\Error Handling"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"8ca66126-1ed3-4af0-9143-a41c717c1213","commandName":"captureDesktop","packageName":"Screen","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Temp/Error%20Handling/Error.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"958a2281-82e1-434e-a9fc-126211a5a87f","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Temp/Error%20Handling/Error%20Message.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"OVERWRITE_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"d3df54ca-9cd7-4931-8f91-85267b922f5b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"True"}}],"returnTo":{"type":"VARIABLE","variableName":"vError"}},{"uid":"50844970-105b-49d5-aa36-b5fb4fc17c4b","commandName":"toString","packageName":"Datetime","attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$System:Date$","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"1dae4f92-220d-4c5c-9bfb-45f424982d94","commandName":"split","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Temp\\Error Handling\\Error.png;$@AAApplicationPath$\\Temp\\Error Handling\\Error Message.txt"}},{"name":"delimiter","value":{"type":"STRING","string":";"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-list-string-1"}},{"uid":"812f2b71-806c-44f3-9eeb-754db53e7e7f","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"},"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-item-string-1"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"m-email-attachment-list-string-1"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"c5f2cb9c-b26a-4a38-acb0-63f87a9c77db","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$m-email-attachment-item-string-1$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}]}],"children":[{"uid":"53963cb7-fe97-4651-946d-b31d4e3a4484","commandName":"assign","packageName":"File","attributes":[{"name":"sourceFile","value":{"type":"FILE","expression":"file://$m-email-attachment-item-string-1$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-item-file-1"}},{"uid":"2614bae5-454d-4333-aab4-0932d98e4e9b","commandName":"addItem","packageName":"List","attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"m-email-attachment-list-file-1"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"m-email-attachment-item-file-1"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}]}]},{"uid":"00c4fece-60e4-4a7d-b8ca-dde3a9f4d089","commandName":"SendMailV2","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vMailFrom$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vMailSoporte$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $m-date-string$ \nError line number: $Error-LineNumber.Number:toString$ \nError message: $Error-Description$"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fileList","value":{"type":"LIST","expression":"$m-email-attachment-list-file-1$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"b881d8fb-5bbc-4247-b615-1e1ec6c55c80","commandName":"deleteFiles","packageName":"File","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Temp/Error%20Handling/Error.png"}}]},{"uid":"5f2da485-bf5d-4063-9931-ae330b05d2ab","commandName":"deleteFiles","packageName":"File","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Temp/Error%20Handling/Error%20Message.txt"}}]},{"uid":"664dc317-9d52-47be-a268-f97579ccf273","commandName":"stopTask","packageName":"TaskBot","attributes":[]}]}]}],"branches":[{"uid":"513a765f-bbbc-4ee6-b5c5-e2d46efd8b92","commandName":"finally","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"2ce19b99-80e0-4859-b1f9-b8b31f78401b","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}]}],"children":[{"uid":"08ed8064-a3ee-4514-9018-fbe6fca5b716","commandName":"throw","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vError","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMailSoporte","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMailFrom","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathLog","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNuevaColumna","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathTemp","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"C:\\Proceso48"}},{"name":"vHoja","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNombreMesAnt","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Diciembre"}},{"name":"vNombreFlash","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Flash Procard 01.2020.xlsx"}},{"name":"vCelda","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vUltimaColumna","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vRangoOrigen","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vRangoDestino","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNombreMes","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Enero"}},{"name":"vNombreCierre","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Cierre Procard 12.2019.xlsx"}},{"name":"vUltimaFila","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"aHojas","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"},{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":"Ingresos"},{"type":"STRING","string":"TOTAL INGRESOS"}]},{"values":[{"type":"STRING","string":"Egresos"},{"type":"STRING","string":"TOTAL EGRESOS"}]}]}}},{"name":"lFilas","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"0"}]}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Loop-Excel-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Excel-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-excel-column-name","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-temp-get-multiple-cells-1","description":"","type":"TABLE","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-email-attachment-list-string-1","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[]}},{"name":"m-email-attachment-item-string-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"m-email-attachment-item-file-1","description":"","type":"FILE","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-email-attachment-list-file-1","description":"","type":"LIST","subtype":"FILE","input":true,"output":true,"defaultValue":{"type":"LIST","list":[]}},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"ErrorHandler","version":"2.10.0-20220929-040735"},{"name":"System","version":"3.10.0-20220921-062556"},{"name":"Number","version":"3.6.0-20220928-104414"},{"name":"Excel_MS","version":"6.11.0-20220919-135308"},{"name":"String","version":"5.5.2-20221006-094641"},{"name":"Loop","version":"3.6.0-20220928-191723"},{"name":"LegacyAutomation","version":"5.6.1-20221027-080331"},{"name":"DataTable","version":"4.6.0-20220920-155212"},{"name":"Comment","version":"2.12.0"},{"name":"If","version":"3.5.0-20220928-201537"},{"name":"Record","version":"1.6.3-20220919-051027"},{"name":"Boolean","version":"2.6.4-20220919-050851"},{"name":"LogToFile","version":"3.5.0-20220416-233918"},{"name":"Folder","version":"6.5.0-20221003-160340"},{"name":"Screen","version":"2.8.0-20220426-033753"},{"name":"Datetime","version":"2.10.3-20220919-051216"},{"name":"List","version":"2.9.2-20220919-103920"},{"name":"File","version":"6.5.0-20221003-160340"},{"name":"Email","version":"3.15.2-20221006-075826"},{"name":"TaskBot","version":"2.5.0-20221020-114450"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM","timeout":"0s"}}