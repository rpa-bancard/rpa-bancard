{"triggers":[],"nodes":[{"uid":"225bc2ad-23a5-4ea0-9d27-e69ba9bcb3b7","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d11742de-1ba2-48b5-bd2c-f27964ea694e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Tecnologia\\RPA_prd\\calendarioRPA\\nohabiles.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathNoHabiles"}},{"uid":"8da39de0-d6aa-41c7-983d-c3c7e560db7a","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Persist Security Info=False;Extended Properties=\"DSN=PostgreSQL35W;DATABASE=rpa-desa;SERVER=10.100.14.49;PORT=5432;UID=postgres;SSLmode=disable;ReadOnly=0;Protocol=7.4;FakeOidIndex=0;ShowOidColumn=0;RowVersioning=0;ShowSystemTables=0;Fetch=100;UnknownSizes=0;MaxVarcharSize=255;MaxLongVarcharSize=8190;Debug=0;CommLog=0;UseDeclareFetch=0;TextAsLongVarchar=1;UnknownsAsLongVarchar=0;BoolsAsChar=1;Parse=0;ExtraSysTablePrefixes=;LFConversion=1;UpdatableCursors=1;TrueIsMinus1=0;BI=0;ByteaAsLongVarBinary=1;UseServerSidePrepare=1;LowerCaseIdentifier=0;D6=-101;XaOpt=1\""}},{"name":"use64BitDriver","value":{"type":"BOOLEAN","boolean":false}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"retardo"},"sessionTarget":"GLOBAL"}},{"uid":"35ff1092-ec04-41bf-a605-8491253c7b29","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6704ce54-e579-41b3-94b4-17710c8a4f01","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"35ce215b-92b7-4dec-9051-bab907387287","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"UPDATE $tablaQuery$\nSET bldat = bldat + interval '$cantDiasRetardo$ day'\nWHERE blart = '$tipoDoc$';"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"retardo"}}}]}],"branches":[{"uid":"2cfd0a8f-8a4f-4009-af5b-1949b9024bba","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"1c37e5e3-ae2d-4f94-951d-d50aa8965731","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"UPDATE $tablaQuery$\nSET bldat = bldat + interval '$cantDiasRetardo$ day'\nWHERE blart = '$tipoDoc$';"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"retardo"}}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$claseDoc$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"\"_Clase_i_\""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"9442fc07-8de7-4108-a56d-d4edf92f704b","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"2e452709-ebf3-4787-89aa-b842337fbe67","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select * from $tablaQuery$ where blart = '$tipoDoc$'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"retardo"}}}]},{"uid":"681690cf-3da3-4b83-a75f-b85135f1002a","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"b42f223a-a4a4-4ca9-9809-be75d590a7d6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaPartidasAbiertas[15]$"}}],"returnTo":{"type":"VARIABLE","variableName":"record_id"}},{"uid":"1870cff0-f12d-4d9d-a70a-361ad12de083","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaPartidasAbiertas[4]$"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaPartidaAbierta"}},{"uid":"1e269b92-1393-4ab2-b4b3-a332af2946d7","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fechaPartidaAbierta$"}},{"name":"getCharacters","value":{"type":"STRING","string":"AFTER"}},{"name":"afterString","value":{"type":"STRING","string":"/"}},{"name":"afterOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"diaPartidaAbierta"}},{"uid":"f29ba46a-caf7-4dd7-9421-0c05bef6c543","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fechaPartidaAbierta$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"/"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"/"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"mesPartidaAbierta"}},{"uid":"7671e6e5-bc9a-4b7e-8030-8d1612bfe267","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fechaPartidaAbierta$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFORE"}},{"name":"beforeString","value":{"type":"STRING","string":"/"}},{"name":"beforeOccurrence","value":{"type":"NUMBER","number":"2"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"añoPartidaAbierta"}},{"uid":"fb704f82-e177-4e41-ac2f-c5fc20008583","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"f20323a5-3b41-4284-a7e2-f48f8619c246","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"vInputTXT","value":{"type":"STRING","expression":"$vPathNoHabiles$"}},{"key":"vFechaSistema","value":{"type":"STRING","expression":"$mesPartidaAbierta$/$diaPartidaAbierta$/$añoPartidaAbierta$"}},{"key":"vDomingoHabil","value":{"type":"STRING","string":"false"}},{"key":"vSabadoHabil","value":{"type":"STRING","string":"false"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Metabots/DateTime/DiaHabil_siguiente"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"vFechaHabilSiguiente","value":{"type":"VARIABLE","variableName":"fechaRetardoIncluido"}}]}},{"uid":"97a2b7b5-9b48-4e0e-aa15-613ed824a216","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fechaRetardoIncluido$"}},{"name":"getCharacters","value":{"type":"STRING","string":"AFTER"}},{"name":"afterString","value":{"type":"STRING","string":"."}},{"name":"afterOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"diaPartidaAbierta"}},{"uid":"c057c1b6-3a8a-4b0b-a3ed-43175d75f4cf","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fechaRetardoIncluido$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"mesPartidaAbierta"}},{"uid":"a06408c2-cce6-41ec-b7cc-70a7c6bee44c","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fechaRetardoIncluido$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFORE"}},{"name":"beforeString","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrence","value":{"type":"NUMBER","number":"2"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"añoPartidaAbierta"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$cantDiasRetardo.String:toNumber$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}}]},{"uid":"a952e519-5818-4f50-9247-f5990fd1342f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$añoPartidaAbierta$-$mesPartidaAbierta$-$diaPartidaAbierta$"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaQuery"}},{"uid":"ab3bed10-f4dc-419f-998f-bf586b5bdf1d","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"UPDATE $tablaQuery$\nSET bldat = '$fechaQuery$'\nWHERE record_id = '$record_id$'"}},{"name":"timeOut","value":{"type":"NUMBER","number":"6000"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"retardo"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"filaPartidasAbiertas"},"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"retardo"}}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$retardoHabil$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"FALSE"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"06e241f7-636c-48ba-8653-be5a6e23b751","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"dosaveData","value":{"type":"BOOLEAN","boolean":false}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"retardo"}}}]}],"branches":[{"uid":"95008e33-feba-4921-a057-25e258b556ef","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"c2054544-e787-4258-a1d1-e6a744b525fa","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"rpa@bancard.com.py"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","string":"Compensaciones - Retardo Inverso ERROR"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$ErrorLineNumber.Number:toString$ - $ErrorMessage$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"variables":[{"name":"cantDiasRetardo","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"retardoHabil","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"tipoDoc","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"claseDoc","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"filaPartidasAbiertas","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"fechaPartidaAbierta","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mesPartidaAbierta","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"diaPartidaAbierta","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"añoPartidaAbierta","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaLunesMetabot","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathNoHabiles","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"respuestaMetabot","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"diaRetardoIncluido","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"fechaRetardoIncluido","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mesRetardoIncluido","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"añoRetardoIncluido","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"tablaQuery","description":"Tabla de la BD cuyas fechas serán editadas.","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaHabilSiguiente","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"fechaQuery","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"record_id","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Database","version":"5.1.0","settingsAttributes":[]},{"name":"Email","version":"3.18.2","settingsAttributes":[]},{"name":"ErrorHandler","version":"2.12.1-20231117-175338","settingsAttributes":[]},{"name":"If","version":"3.6.2-20230316-161323","settingsAttributes":[]},{"name":"Loop","version":"3.7.5-20230316-155504","settingsAttributes":[]},{"name":"Number","version":"3.8.0","settingsAttributes":[]},{"name":"String","version":"5.8.0","settingsAttributes":[]},{"name":"TaskBot","version":"2.4.0-20220628-195240","settingsAttributes":[]}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"4","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}