{"triggers":[],"nodes":[{"uid":"e3d05964-eeca-4523-8673-205b48dda4d3","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d888d13e-f868-4bd6-b27f-7952d5c8654a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6bbccf70-78fa-4c36-a6b5-f2b035cba4b8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Dia, mes y año son recibidos desde el main task"}}]},{"uid":"06926c4e-8857-41ce-be72-822c9ac36d68","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDia$.$vMes$.$vAño$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaProceso"}},{"uid":"75747ff1-cf6e-4451-b712-78a45b00b3b2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMes$/$vDia$/$vAño$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaMetabot"}},{"uid":"4dc9e7b0-5b57-4d95-8b03-443bf0abd00d","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"vInputTXT","value":{"type":"STRING","expression":"$vPathNoHabiles$"}},{"key":"vFechaSistema","value":{"type":"STRING","expression":"$vFechaMetabot$"}},{"key":"vDomingoHabil","value":{"type":"STRING","string":"false"}},{"key":"vSabadoHabil","value":{"type":"STRING","string":"false"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Metabots/DateTime/DiaHabil"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"dRespuestaMetabot"}},{"uid":"0eddb8b7-ea98-45f5-b824-a316cf9c0261","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$dRespuestaMetabot{vIsWorkingDay}$\n$dRespuestaMetabot{vDayOfWeek}$\n$dRespuestaMetabot{vFechaHabilAnterior}$\n$dRespuestaMetabot{vDayOfWeek_DiaHabilAnterior}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"63ac72b2-9328-457e-9d44-2424cb554bc1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dRespuestaMetabot{vFechaHabilAnterior}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaHabilAnterior"}},{"uid":"35373ed9-f0e9-4cad-a476-08462dfe718e","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaHabilAnterior$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vMes2"}},{"uid":"309a2178-5adb-416f-be6e-d7372fb22ddc","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaHabilAnterior$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":""}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vDia2"}},{"uid":"a4797f3e-689b-4734-93f9-a8f8aed6c77d","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaHabilAnterior$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"."}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"2"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":""}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"true"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vAño2"}},{"uid":"1496e737-cb5e-43cf-ae8c-876df8e1117e","commandName":"replace","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFechaHabilAnterior$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaHabilAnterior"}},{"uid":"b8c34fdc-2705-4f18-9a54-c58f27908220","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0000140000"}}],"returnTo":{"type":"VARIABLE","variableName":"vCuentaSAP"}},{"uid":"00d8e5a4-39b8-45d4-90cf-2354720d3bc5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1000"}}],"returnTo":{"type":"VARIABLE","variableName":"vSociedad"}},{"uid":"336d2808-bd73-4ad5-b604-8e1c3503c2db","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\\\\\nas\\\\tecnologia\\\\listados\\\\"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathListado"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Formateo de variables general"}}]},{"uid":"8c72478e-7e5b-4b73-ac92-40d99f87eed5","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"2c8740e1-64fd-40d8-9c95-49013ed36ab5","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"158687e0-5190-4f32-beaf-1cce9c4d899c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"MASTERCARD OUTGOING DIF CAMBIOS - $vAño$$vMes$$vDia$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vNombreArchivo"}},{"uid":"d92ce56c-71f7-4db0-980b-6e0aa9bc2b2f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"\\\\nas\\tecnologia\\listados\\$vNombreArchivo$"}}],"returnTo":{"type":"VARIABLE","variableName":"vPathArchivoNas"}},{"uid":"e357fdc9-eb46-476f-8dc6-3e6267de2a01","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vAño2$-$vMes2$-$vDia2$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaDesde"}},{"uid":"4b8f8a7c-e43b-4f59-8629-f85122e9cf5f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vAño$-$vMes$-$vDia$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaHasta"}},{"uid":"652071c5-71da-45c5-b12c-a736d647b733","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vFechaDesde$\n\n$vFechaHasta$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Formateo de variables"}}]},{"uid":"ca5cb616-9e9b-4828-925f-fa6ee8620cfb","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"2fb63473-e4c4-4f90-81cc-0c53e78bc702","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"62df4ff9-147b-48aa-8185-5eb0531f4608","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vPathArchivoNas$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vPathArchivoNas$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]},{"uid":"1fbd0531-eeec-43ad-a1e6-0f14cfed9beb","commandName":"restGet","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","expression":"https://sap-erp-prd-1.bancardnet.dom:44300/sap/bc/zwsfbl3nrpa?sap-client=400&entrada={\"zentrd\":\"$vPathListado$$vNombreArchivo$\",\"zbukrs\":\"$vSociedad$\",\"zgjahr\":$vAño$,\"zsaknr\":\"$vCuentaSAP$\",\"zbuda1\":\"$vFechaDesde$\",\"zbuda2\":\"$vFechaHasta$\"}"}},{"name":"proxyType","value":{"type":"STRING","string":"SYSTEM"}},{"name":"authenticationMode","value":{"type":"STRING","string":"Basic"}},{"name":"basicUserName","value":{"type":"CREDENTIAL","credential":{"name":"RPA 1","lockerName":"SAP PASS","attributeName":"RPA 1 ID"}}},{"name":"basicPassword","value":{"type":"CREDENTIAL","credential":{"name":"RPA 1","lockerName":"SAP PASS","attributeName":"RPA 1 PASS"}}},{"name":"captureFailureResponse","value":{"type":"BOOLEAN","boolean":true}},{"name":"allowInsecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","expression":"$@AARestTimeOut$"}}],"returnTo":{"type":"VARIABLE","variableName":"dRespuestaServicio"}},{"uid":"3df1e9fe-d914-43c7-a570-be28b3bda851","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Se le da un màximo de 5min al servicio para generar el archivo"}}]},{"uid":"2e574822-2c22-4b4d-9895-606ae51ba901","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dRespuestaServicio{Body}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vRespuestaServicio"}},{"uid":"97e154b2-a587-49fe-b341-a2bda9313136","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vRespuestaServicio$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ba8b5723-93c0-44ba-883e-fa6e73a0aecf","commandName":"pauseTask","packageName":"TaskBot","disabled":true},{"uid":"d22a90c5-008c-4531-83cc-3b082abc66c9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Se le da un màximo de 5min al servicio para generar el archivo"}}]},{"uid":"70ba60d6-c98a-405f-bd97-36786366e966","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"5eee137b-77c2-403c-b2e1-fec72251efbf","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Se analiza solo los mvimientos con la clase de documento PS."}}]},{"uid":"e609c2ff-4c45-4a73-be3e-8166e5260e3a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"OI"}}],"returnTo":{"type":"VARIABLE","variableName":"vTextoBusqueda"}},{"uid":"cc58a60d-0406-4d4a-b61f-2ae644b23605","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"PT"}}],"returnTo":{"type":"VARIABLE","variableName":"vTextoBusqueda2"}},{"uid":"b47a68d1-b7f2-4f5b-b244-aa25ef85c9e0","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vPathArchivoNas$"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"other"}},{"name":"specificDelimiter","value":{"type":"STRING","string":";"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"4bc67e27-054f-4370-8bb9-6665a8139841","commandName":"ReadFromCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"returnTo":{"type":"VARIABLE","variableName":"vCsvPartidasSAP"}},{"uid":"fce96b9f-0e7a-47ec-afca-f98d6f05c456","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"c7a384d2-1681-4179-9f06-edbad58d3c74","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"4b06ab46-d9b4-4c81-8af9-70e73c93be3a","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$TableRow[6]$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"e4338376-141c-4fe8-af0c-4decc29e00d8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"9ddb5796-227e-4dc6-8e54-16ab0e46d744","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"No existen registros"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"748f22c6-645d-4fc6-a778-f790ed800437","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"rpa@bancard.com.py"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Diferencia de Cambios - Error - SAP MASTERCARD DIF C. OUTGOING"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"No existen registros en SAP para la cuenta $vCuentaSAP$.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"14554de0-e553-48f4-a471-42a8b8c1ffbc","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"El proceso se detiene por un error en SAP ya que se utiliza para completar la planilla."}}]},{"uid":"078a5bc1-3e2e-4fd3-b508-7930473768c1","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TableRow[0]$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"No existen registros"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"7b0b24aa-0a24-4b24-93aa-c9f26692b9a2","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e0e5ce4d-8d51-4b14-8bb2-4957da10c337","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vExistenMovimientosOI"}},{"uid":"35f478bf-5dce-4e08-b775-6fb53872dcad","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c5d39a3e-098a-40a7-94f0-eeb5308bcb31","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vExistenMovimientoOIFechaHabilAnterior"}},{"uid":"895b14f5-c41c-43a3-907d-ec4385666b5d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[9]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoOIString"}},{"uid":"c62514ed-64c5-4094-956d-ed75412d5b7c","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoOIString$"}},{"name":"find","value":{"type":"STRING","string":"[.-]"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoOIString"}},{"uid":"0f135c0b-3abc-44b1-b1d5-edbc725d1a96","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoOIString$"}},{"name":"find","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"."}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoOIString"}}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TableRow[7]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$vFechaHabilAnterior$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TableRow[6]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$vTextoBusqueda$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"c8be3a9d-3026-49a9-9331-eee743c46030","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"41edbbea-9570-4e26-9d6e-ae359b926c49","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vExistenMovimientosPT"}},{"uid":"d2e3ccbb-2f14-4ce2-acd9-c82526fd6488","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$TableRow[7]$\n$vFechaProceso$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f0407ca2-4cbf-4c9a-b17b-a07cbeb1282e","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"bc75e417-8ff5-4fe4-ae43-c10b5f2be773","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$TableRow[16]$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ee640538-1092-4d94-a8d2-768c69f64975","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"16bf3579-07c2-45a2-aa7d-6a198d0e374a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Entonces habria dos mensajes, uno que existen movimientos PT pero no PT con el texto MC Intern. y otro que no existe PT directamente. Tambien cuando no hay PT con la fecha buscada."}}]},{"uid":"471815e5-b4ba-4fb2-b906-9df66cd70068","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vExistenMovimientoPTFechaProceso"}},{"uid":"b211747a-cf53-4f49-b18e-82a406251ad7","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$TableRow[11]$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"efa6bac3-b521-47c5-824f-c7becffa3708","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[11]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoPTString"}},{"uid":"88a2bdb2-216e-4e0a-9ef4-5d3a1cf355f6","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoPTString$"}},{"name":"find","value":{"type":"STRING","string":"[.-]"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoPTString"}},{"uid":"dca72b45-a905-444c-bb92-dbcb0b75f6b1","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMontoPTString$"}},{"name":"find","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"."}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoPTString"}}],"branches":[{"uid":"9a787ddd-5900-46d2-9a71-beb0e04bacfb","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"66272637-6602-4303-8c53-7ae5a379505e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[9]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMontoACompararString"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TableRow[16]$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":"MC Intern. Dif. Cambio Outg"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TableRow[7]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$vFechaProceso$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TableRow[6]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$vTextoBusqueda2$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"vCsvPartidasSAP"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"7bfcba3c-4b55-4ddb-962e-dedc6778fdd5","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"OI: $vMontoOIString$\nPT: $vMontoPTString$\nMonto a Comparar: $vMontoACompararString$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"b069a785-1036-4b0a-b04c-6e95fc83066e","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"bd816e92-1aee-46a5-84e5-7438fb5f4f29","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"El proceso no se detiene por un error en SAP"}}]},{"uid":"68395df3-ac88-4135-8cd2-49be8765d8fc","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"rpa@bancard.com.py"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Diferencia de Cambios - Error - SAP MASTERCARD Dif C. Outgoing"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"No se pudo generar el archivo correspondiente a la cuenta $vCuentaSAP$ utilizando SAP.\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]}]}],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vPathArchivoNas$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"300"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Control de archivo y llamada al servicio"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Columna A Guaraníes Enviados - SAP"}}]}],"branches":[{"uid":"50942540-157b-4b41-a913-2ef42bc97aea","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"9e539934-be47-4de7-be68-25bbe0f5d599","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$System:Date$"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"RFC_1123_DATE_TIME"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaError"}},{"uid":"5be168d0-8049-4e24-bc6d-8579fe638ac5","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"rpa@bancard.com.py"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $vFechaError$\nError line number: $vErrorLineNumber.Number:toString$\nError Description: $vErrorMessage$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]},{"uid":"96744292-d3ed-445f-8b61-cd4534a3c692","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"06"}}],"returnTo":{"type":"VARIABLE","variableName":"vDia"}},{"uid":"774654a4-a9ab-4b47-ab11-22f663870d35","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"02"}}],"returnTo":{"type":"VARIABLE","variableName":"vMes"}},{"uid":"fabd3bee-ecc3-4b20-942c-2fd109ac46a4","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"2023"}}],"returnTo":{"type":"VARIABLE","variableName":"vAño"}}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"vFechaProceso","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCuentaSAP","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSociedad","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDia","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAño","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathListado","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"TableRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vNombreArchivo","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathArchivoNas","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaDesde","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaHasta","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dRespuestaServicio","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vRespuestaServicio","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTextoBusqueda","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCsvPartidasSAP","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vMontoACompararString","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMontoPString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vValorUsdString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vExistenMovimientosPN","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vMontoPNString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaMetabot","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dRespuestaMetabot","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vFechaHabilAnterior","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAño2","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDia2","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes2","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vGsEnviadosString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTextoBusqueda2","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vExistenMovimientosOI","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vMontoOIString","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vExistenMovimientosPT","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vMontoPTString","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vExistenMovimientoOIFechaHabilAnterior","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vExistenMovimientoPTFechaProceso","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vPathNoHabiles","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaError","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.7.0-20230104-120816"},{"name":"Comment","version":"2.13.2"},{"name":"CsvTxt","version":"2.11.1-20221229-045349"},{"name":"DataTable","version":"4.7.2-20230106-071425"},{"name":"Datetime","version":"2.11.1-20230104-114826"},{"name":"Email","version":"3.15.2-20221006-075826"},{"name":"ErrorHandler","version":"2.11.2-20230106-100001"},{"name":"File","version":"6.6.1-20230105-072958"},{"name":"If","version":"3.6.1-20230106-055132"},{"name":"Loop","version":"3.7.4-20230214-021503"},{"name":"MessageBox","version":"3.5.0-20221223-065722"},{"name":"Number","version":"3.7.1-20230105-092807"},{"name":"Rest","version":"3.13.3-20230111-084505"},{"name":"Step","version":"2.5.0-20230105-135537"},{"name":"String","version":"5.7.1"},{"name":"System","version":"3.11.2-20230106-081933"},{"name":"TaskBot","version":"2.7.1-20230106-103206"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"4","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}