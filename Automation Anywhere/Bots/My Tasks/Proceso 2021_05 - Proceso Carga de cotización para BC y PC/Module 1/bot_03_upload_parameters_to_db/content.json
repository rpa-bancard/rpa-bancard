{"nodes":[{"uid":"52ed7fee-9873-4f07-8910-a303741b8301","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"a5a50391-61c1-45c0-8d63-d4d0ca1fec37","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Dev: Pablo Escobar"}}]},{"uid":"16f4b95e-1ae5-49fa-8370-7e156b9a0a77","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Date: 27/04/22"}}]},{"uid":"4108abe3-b567-4a50-ae8f-a6330aff28ce","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"}}]},{"uid":"f1ee21fa-d2c1-4aff-97fe-2453fb553473","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Parámetros\n"}}]},{"uid":"a819eb8f-b118-4fe5-9da3-88505e9a6d51","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","expression":"Fecha de ejecución: \t$vMatrizDatas[0][0]$\n"}}]},{"uid":"aa980116-8183-4856-a37d-9d1aca735e8a","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","expression":"Fecha hábil anterior: \t$vMatrizDatas[0][2]$\n"}}]},{"uid":"2e238546-bd2c-4fbe-b9a0-710b7e035384","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","expression":"Mes en Palabra:        \t$vMatrizDatas[0][1]$\n"}}]},{"uid":"7538732c-efea-47e3-8a7f-ef5b8be7dc9e","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","expression":"$vTitle$"}},{"name":"content","value":{"type":"STRING","expression":"\nFecha de ejecución: \t$vMatrizDatas[0][0]$\nMes en Palabra:        \t$vMatrizDatas[0][1]$\nFecha hábil anterior: \t$vMatrizDatas[0][2]$\nMes en Palabra:        \t$vMatrizDatas[0][3]$\nInicio de Mes: \t\t$vMatrizDatas[0][4]$\nSheetname:\t\t$vMatrizDatas[0][5]$\nPath:          \t\t$vMatrizDatas[0][6]$\n\nContinua el proceso?: \t$vContinuaProceso$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"1"}}]},{"uid":"5f55ed86-9685-4a20-83d2-00acb7f4af3e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"}}]},{"uid":"eaa2bff0-96fe-4f4f-8dc3-d43a41489b81","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\NAS\\Tecnologia\\RPA_prd\\05 - Proceso Carga de cotización para BC y PC"}}],"returnTo":{"type":"VARIABLE","variableName":"vNasProceso"}},{"uid":"2ce8e269-3f25-4d13-a3ea-b2a4b4f27882","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNasProceso.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNasProceso"}},{"uid":"1621e2e0-64be-4aff-b515-412ee3bc2c62","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNasProceso$\\Logs\\logfile $System:Day.Number:toString$$System:Month.Number:toString$$System:Year.Number:toString$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogfile"}},{"uid":"d39af039-2221-4979-ad74-52d05ac8055f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogfile"}},{"uid":"694b796a-60b6-45ed-a4b6-85b839909df3","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vContinuaProceso"}},{"uid":"1674b683-a67a-4bcc-8f28-1570046e5c4e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"}}]},{"uid":"850ed332-8ec6-4cb3-81d5-d3e3f50b45ac","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"c1d979d7-2581-4587-8667-964beeef2064","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"\n##########################################################################\nINICIA: 03_upload_parameters_to_db.atmx\n##########################################################################\n[Ambiente de ejecución]: $vEntorno$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"01cedf5a-e9fd-4254-8f84-2b4beae97d0e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"}}]},{"uid":"bec73bed-a3bf-4667-8d9a-20646e3c892c","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"55c6eb53-2c67-4b97-bef8-926aee1ec212","commandName":"connect","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"bd"}},{"name":"connectionURL","value":{"type":"STRING","string":"Provider=MSDASQL.1;Persist Security Info=False;Extended Properties=\"DSN=PostgreSQL35W;DATABASE=rpa-desa;SERVER=10.100.14.49;PORT=5432;UID=postgres;SSLmode=disable;ReadOnly=0;Protocol=7.4;FakeOidIndex=0;ShowOidColumn=0;RowVersioning=0;ShowSystemTables=0;Fetch=100;UnknownSizes=0;MaxVarcharSize=255;MaxLongVarcharSize=8190;Debug=0;CommLog=0;UseDeclareFetch=0;TextAsLongVarchar=1;UnknownsAsLongVarchar=0;BoolsAsChar=1;Parse=0;ExtraSysTablePrefixes=;LFConversion=1;UpdatableCursors=1;TrueIsMinus1=0;BI=0;ByteaAsLongVarBinary=1;UseServerSidePrepare=1;LowerCaseIdentifier=0;D6=-101;XaOpt=1\""}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"18ace263-56b4-43cf-bc6e-32f9d7fab29b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"proceso05_save_execute_parameters"}}],"returnTo":{"type":"VARIABLE","variableName":"vNameTable"}},{"uid":"68730915-a6f4-4809-b65e-a151ebe09a00","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"________________________________________________________________________________________________"}}]},{"uid":"561addbd-2f65-4060-a6ea-b7a0f8ec2fc0","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"False"}}],"returnTo":{"type":"VARIABLE","variableName":"vCreateTable"}},{"uid":"8ae2b689-ae43-4317-9858-0fc73e301996","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"96a5b97f-1327-424e-923d-a13ec8466b46","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"Create Table $vNameTable$?: $vCreateTable$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f0915aed-13f2-4f5b-a51e-f382c4b08911","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCreateTable$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"True"}}]}],"children":[{"uid":"05f2f966-dd9f-4e0c-96a5-5826f5a64317","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Creación de tabla save_execute_parameters"}}]},{"uid":"9c95010c-a323-472e-87f5-f7aa842c4354","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Comentado porque ya existe la tabla creada no hace falta crear de nuevo."}}]},{"uid":"82c5ac24-be45-4e3b-be19-932f356cb877","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"CREATE TABLE $vNameTable$\n(\ni_id SERIAL NOT NULL,\nd_date_now VARCHAR(12) NOT NULL,\nd_date_previous VARCHAR(12) NOT NULL,\ns_name_file VARCHAR(25) NOT NULL,\ni_name_sheet DECIMAL(3) NOT NULL,\nb_enabled BOOLEAN NOT NULL,\ns_path_file  VARCHAR(200) NOT NULL,\ns_env VARCHAR(4) NOT NULL,\nt_created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW() NOT NULL,\nt_updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW() NOT NULL\n);"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"cd75b54a-c19e-450f-9386-3f20c13db308","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSql.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"a8b93626-dbf3-470a-9641-c0d9f3740979","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"CREATE TABLE $vNameTable$\n(\ni_id SERIAL NOT NULL,\nd_date_now VARCHAR(12) NOT NULL,\nd_date_previous VARCHAR(12) NOT NULL,\ns_name_file VARCHAR(25) NOT NULL,\ni_name_sheet VARCHAR(3) NOT NULL,,\nb_enabled BOOLEAN NOT NULL,\ns_path_file  VARCHAR(200) NOT NULL,\ns_env VARCHAR(4) NOT NULL,\nt_created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW() NOT NULL,\nt_updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW() NOT NULL\n);"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"f5b77e6a-5e7f-4f72-8dc6-457d54f9d05c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSql.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"e9511e2d-337b-483b-9e2d-e441a27a3ee1","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vSql$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"aff88404-9d45-4d74-a024-0ece2a8d451f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"8bd789a4-51e2-41c9-a2fb-a04769af13be","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$vSql$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"e7724d0f-6063-4097-9a55-2ebb176881ef","commandName":"insertUpdateDelete","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"bd"}},{"name":"query","value":{"type":"STRING","expression":"$vSql$"}}]},{"uid":"a8d229a3-a6c8-4fb9-86f8-94c2996d3343","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"____"}}]},{"uid":"21487214-941f-4521-a0f1-48883d7f3e39","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Función que actualizará el campo t_updated_at "}}]},{"uid":"049989ab-f376-48d4-b71d-778c2b2d3d8b","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"CREATE OR REPLACE FUNCTION set_updated_at()\n    RETURNS TRIGGER AS\n$$\nBEGIN\n    OLD.t_updated_at = NOW();\n    RETURN OLD;\nEND;\n$$ LANGUAGE 'plpgsql'\n;"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"24d46b0c-461b-4d9d-a3fe-9ee84308807b","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vSql$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"e6272da6-400f-4341-b30e-dcda9da1926e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"9147b6e0-8dcf-454c-b6e4-7fa7acf8b6d9","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$vSql$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"21d03464-d4d2-495d-bedf-f0d5b589c71f","commandName":"insertUpdateDelete","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"bd"}},{"name":"query","value":{"type":"STRING","expression":"$vSql$"}}]},{"uid":"4a5bfed7-d59f-4da0-8481-03df52c2a0fe","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"____"}}]},{"uid":"fe36f19c-9967-40ed-91c0-2f5921fc5882","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Trigger que se disparará para actualizar el campo \" t_updated_at\" cada vez que se actualice un registro en particular en la tabla \"proceso05_save_execute_parameters\""}}]},{"uid":"63fe899a-4462-44bc-a0c6-9a6193192358","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"CREATE TRIGGER set_updated_at\n    BEFORE UPDATE\n    ON $vNameTable$\n    FOR EACH ROW\nEXECUTE PROCEDURE set_updated_at()\n;"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"1df497ad-76d6-4b24-9427-af01514c380e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSql.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"2cb4489e-8f6b-4612-9159-402015c4fedb","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vSql$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"6510b712-f03a-4724-a9ee-3e894cd46937","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"9bf29c1b-1ead-4f38-8110-542455d1b6eb","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$vSql$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"1154dca8-5e98-4148-9fa2-129aaccf355e","commandName":"insertUpdateDelete","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"bd"}},{"name":"query","value":{"type":"STRING","expression":"$vSql$"}}]}]},{"uid":"79be70ed-3c85-4c21-bf00-7b467f6c8389","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"________________________________________________________________________________________________"}}]},{"uid":"5540f077-9a98-4f8d-96d3-1d1ba555465d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Para insertar los parámetros en la tabla"}}]},{"uid":"0b58dab1-4365-4e14-81ad-5784f4c82671","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"INSERT INTO $vNameTable$\n(\nd_date_now,\nd_date_previous,\ns_name_file,\ni_name_sheet,\nb_enabled,\ns_path_file, \ns_env\n)VALUES(\n'$vMatrizDatas[0][0]$', '$vMatrizDatas[0][2]$', '$vMatrizDatas[0][1]$',  '$vMatrizDatas[0][5]$', true, '$vMatrizDatas[0][6]$','$vEntorno$'\n);"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"fd9e07e6-efd4-4e27-89c7-e7ee24cbafe4","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSql.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSql"}},{"uid":"a3e80bc2-80e0-48a6-8333-d85c62218af7","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vSql$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"1"}}]},{"uid":"c58b9c24-bbf5-43cc-bd74-4b0cd05ce2aa","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"ad2b625a-39c9-4742-8e9b-0a365add0bbe","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$vSql$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"0becdac0-ac61-4808-ac8f-37725e5a1f7f","commandName":"insertUpdateDelete","packageName":"Database","attributes":[{"name":"session","value":{"type":"STRING","string":"bd"}},{"name":"query","value":{"type":"STRING","expression":"$vSql$"}}]},{"uid":"ac388d05-e191-4f92-bfd5-a6a9978b672e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vContinuaProceso"}},{"uid":"b81aa92e-1ed8-421a-ab8e-f19ef3f78341","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"75eedf60-087e-40ec-8751-a90f71444e31","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$vSql$\n\n##########################################################################\nFINALIZACIÓN: 03_upload_parameters_to_db.atmx\n##########################################################################\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"496dc00d-de70-42df-93aa-ff3c63dd5621","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"7ed0f9e1-622a-4c06-a022-6b8cea63b02a","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"285d8cc5-0a80-497d-b5f6-a43ec9f82723","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogfile$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-start-in-path"}},{"uid":"77f3a68c-f1fb-4680-96b4-3ecf0406f38c","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$m-string-start-in-path.LegacyAutomation:getAbsolutePath($@AABasePath$)$"}},{"name":"logContent","value":{"type":"STRING","expression":"$Error-LineNumber.Number:toString$ - $Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"9a145745-b555-4655-a9cb-6daab018cccb","commandName":"createFolder","packageName":"Folder","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Temp\\Error Handling"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"b06cbceb-bf49-43f4-b848-6db5132a9e8d","commandName":"captureDesktop","packageName":"Screen","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Temp/Error%20Handling/Error.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"463dc2b3-5bff-4cc3-9986-56dfd5e8bdc1","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Temp/Error%20Handling/Error%20Message.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"OVERWRITE_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"945a6326-c00b-4086-a050-419988c399e4","commandName":"toString","packageName":"Datetime","attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$System:Date$","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"920e22de-ad0d-4b9c-8ba0-6fcaf1f09387","commandName":"split","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Temp\\Error Handling\\Error.png;$@AAApplicationPath$\\Temp\\Error Handling\\Error Message.txt"}},{"name":"delimiter","value":{"type":"STRING","string":";"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-list-string-1"}},{"uid":"bf190995-434a-47c8-8e99-e022cd273404","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"},"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-item-string-1"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"m-email-attachment-list-string-1"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"5f1ad1c0-dcc1-4443-8fbd-0bce5c433ca7","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$m-email-attachment-item-string-1$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}]}],"children":[{"uid":"8da480dc-ae7a-42c7-a2dd-7de0578c722f","commandName":"assign","packageName":"File","attributes":[{"name":"sourceFile","value":{"type":"FILE","expression":"file://$m-email-attachment-item-string-1$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-email-attachment-item-file-1"}},{"uid":"a69272f2-0fc9-481e-9a9e-2600b30cae84","commandName":"addItem","packageName":"List","attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"m-email-attachment-list-file-1"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"m-email-attachment-item-file-1"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}]}]},{"uid":"c986a1ab-b709-44f0-a64b-0f38404a298c","commandName":"SendMailV2","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vTo_rpa$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $m-date-string$ \nError line number: $Error-LineNumber.Number:toString$ \nError message: $Error-Description$"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fileList","value":{"type":"LIST","expression":"$m-email-attachment-list-file-1$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"8badd386-36d5-447f-9072-9a7446ea75c1","commandName":"deleteFiles","packageName":"File","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Temp/Error%20Handling/Error.png"}}]},{"uid":"8001a7d3-6477-45dd-b84b-65c79d11ef13","commandName":"deleteFiles","packageName":"File","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Temp/Error%20Handling/Error%20Message.txt"}}]},{"uid":"e908969b-c12e-4491-8068-7b2ecd5b8611","commandName":"stopTask","packageName":"TaskBot","attributes":[]}]}]}],"branches":[{"uid":"712c831f-02af-4726-bd47-e2ebfa57004a","commandName":"finally","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"56975f59-49c9-4056-987b-3f90166adf86","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}]}],"children":[{"uid":"5d5fea90-aee2-494b-ab49-72947675efc6","commandName":"throw","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vTo_rpa","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableName","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vSql","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNameTable","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTitle","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vConfigFolder","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNasProceso","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vContinuaProceso","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMes","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogVariables","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDia","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAnio","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vEntorno","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogfile","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMatrizDatas","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"vCreateTable","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-email-attachment-list-string-1","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[]}},{"name":"m-email-attachment-item-string-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"m-email-attachment-item-file-1","description":"","type":"FILE","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-email-attachment-list-file-1","description":"","type":"LIST","subtype":"FILE","input":true,"output":true,"defaultValue":{"type":"LIST","list":[]}},{"name":"m-string-start-in-path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true}],"breakpoints":[],"packages":[{"name":"ErrorHandler","version":"2.10.0-20220929-040735"},{"name":"Comment","version":"2.12.0"},{"name":"MessageBox","version":"3.4.0-20220416-233919"},{"name":"String","version":"5.5.2-20221006-094641"},{"name":"LegacyAutomation","version":"5.6.1-20221027-080331"},{"name":"Number","version":"3.6.0-20220928-104414"},{"name":"System","version":"3.10.0-20220921-062556"},{"name":"LogToFile","version":"3.5.0-20220416-233918"},{"name":"Database","version":"4.10.5-20221119-112148"},{"name":"If","version":"3.5.0-20220928-201537"},{"name":"Boolean","version":"2.6.4-20220919-050851"},{"name":"Folder","version":"6.5.0-20221003-160340"},{"name":"Screen","version":"2.8.0-20220426-033753"},{"name":"Datetime","version":"2.10.3-20220919-051216"},{"name":"Loop","version":"3.6.0-20220928-191723"},{"name":"List","version":"2.9.2-20220919-103920"},{"name":"File","version":"6.5.0-20221003-160340"},{"name":"Email","version":"3.15.2-20221006-075826"},{"name":"TaskBot","version":"2.5.0-20221020-114450"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM","timeout":"0s"}}