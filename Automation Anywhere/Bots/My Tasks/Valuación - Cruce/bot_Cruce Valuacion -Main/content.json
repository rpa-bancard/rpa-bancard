{"triggers":[],"nodes":[{"uid":"65ef6d34-9378-4f54-8cac-dad6d6173db0","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"01886d96-5498-409d-9ed1-3f11213efac0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Year.Number:toString$-01-01 "}}],"returnTo":{"type":"VARIABLE","variableName":"fechaDesde"}},{"uid":"09510853-6322-4548-a5b5-9639d8838315","commandName":"length","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Day.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"diaLength"}},{"uid":"d1461f46-20a5-4ad2-9f60-cf2a2c889e16","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b482586b-9f50-4e57-8259-695216aad52a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"0$System:Day.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"dia"}}],"branches":[{"uid":"aadef04e-728d-4cbc-aba9-15ea98d9be30","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"8e2fdba8-d15c-4bed-949c-91680b75bca3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Day.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"dia"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$diaLength$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"1"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"fab0c775-899f-484d-8f83-6744768360d0","commandName":"length","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Month.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"mesLength"}},{"uid":"e96beb93-3bfb-406d-a5e5-8ec84aedba68","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6e8e851a-1fa2-4349-a438-76a9d167161a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"0$System:Month.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"mes"}}],"branches":[{"uid":"b84de524-1887-48eb-89aa-c46e15d1141d","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"e7c11706-e540-4851-ad1e-2eabac3b1cb5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Month.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"mes"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$mesLength$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"1"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"eb7b58f0-9e99-4aaf-8309-8eed14a54a95","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Year.Number:toString$-$mes$-$dia$"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaHasta"}},{"uid":"4863a744-2500-4da5-9799-9d4095edb5ef","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$tablaMesLetra[$mes.String:toNumber$][0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"mesLetra"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Preparación de fechas"}}]},{"uid":"7bf556e6-91a7-4f3e-8980-80e05dff5877","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b5b23bb9-83b1-48f2-bf88-cd9cf775ead7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Tasks\\Cruce Valuacion\\Log\\CRUCE $System:Year.Number:toString$$mes$$dia$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"rutaLog"}},{"uid":"45e8a416-095b-4363-962b-5e8e47067291","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Tecnologia\\RPA_360\\Automation Anywhere\\My Tasks\\TesVal\\Config\\OperFile.csv"}}],"returnTo":{"type":"VARIABLE","variableName":"rutaOperfile"}},{"uid":"1f6587cc-9abd-4b4e-9097-21e38f204200","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Administracion\\Tesoreria\\1 Principal Tesoreria\\BANCARD\\Operaciones de Cambio\\Tipo de Cambio Promedio"}}],"returnTo":{"type":"VARIABLE","variableName":"rutaBancard"}},{"uid":"acafb12e-8f3b-4ac1-8604-cf5427304f11","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Administracion\\Tesoreria\\1 Principal Tesoreria\\PROCARD\\Operaciones de Cambio PR\\Tipo de Cambio Promedio PR"}}],"returnTo":{"type":"VARIABLE","variableName":"rutaProcard"}},{"uid":"12cff5c6-ff96-427b-8f36-a163fd3c8fc4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Tecnologia\\RPA_360\\Automation Anywhere\\My Tasks\\Cruce Valuacion\\Plantilla\\Plantilla cruce valuacion.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"rutaPlantilla"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Definición de variables"}}]},{"uid":"38cd9e40-6d62-4236-8c32-2f45fea8e6af","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e80e26cc-ed46-43a2-b205-6320a16681cb","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$rutaLog$"}},{"name":"logContent","value":{"type":"STRING","string":"Recorre el archivo OperFile"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"457b6312-ec47-4985-92c6-70e1739b18d1","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"operfile"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$rutaOperfile$"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"other"}},{"name":"specificDelimiter","value":{"type":"STRING","string":";"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":true}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":true}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"505334b7-ed21-46c4-91e1-dc982da3c57f","commandName":"ReadFromCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"operfile"}}],"returnTo":{"type":"VARIABLE","variableName":"operFile"}},{"uid":"5d8734ea-287e-4159-ab9d-f89d6b4b6e83","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"operfile"}}]},{"uid":"99ec9589-9f10-4862-aa83-d148525e4ccc","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"22685942-0294-45cb-bd80-63fe3cab8fbd","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaOperFile[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"cuentaBancaria"}},{"uid":"333d5899-3927-4142-ae70-014a9690d972","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaOperFile[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sociedad"}},{"uid":"06d57409-ce32-4f37-98f0-a17e9019d679","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaOperFile[4]$"}}],"returnTo":{"type":"VARIABLE","variableName":"entidad"}},{"uid":"d4fa9be8-229c-4964-b665-c26ca0c2e503","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"7e8fde09-b9ca-417b-971b-daa724b3b887","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rutaBancard$\\$entidad$\\$System:Year.Number:toString$\\$cuentaBancaria$\\$mesLetra$"}}],"returnTo":{"type":"VARIABLE","variableName":"rutaExport"}}],"branches":[{"uid":"38e7ee87-d8b6-47e8-9e42-9f6c5766faa2","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"dd69956e-efce-4b43-98ef-a6c1a0e83b8c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rutaProcard$\\$entidad$\\$System:Year.Number:toString$\\$cuentaBancaria$\\$mesLetra$"}}],"returnTo":{"type":"VARIABLE","variableName":"rutaExport"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sociedad$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"4000"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sociedad$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"1000"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"62eea5b6-fc61-4f46-b883-b460e0340115","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ca1cee06-2232-42de-b195-14ee8d95ea77","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$rutaExport$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$rutaExport$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"cf19c0e5-cbb8-4a50-a2b1-e6fc1eafb270","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"cuentaBancaria","value":{"type":"STRING","expression":"$cuentaBancaria$"}},{"key":"sociedad","value":{"type":"STRING","expression":"$sociedad$"}},{"key":"fechaDesde","value":{"type":"STRING","expression":"$fechaDesde$"}},{"key":"fechaHasta","value":{"type":"STRING","expression":"$fechaHasta$"}},{"key":"rutaLog","value":{"type":"STRING","expression":"$rutaLog$"}},{"key":"rutaPlantilla","value":{"type":"STRING","expression":"$rutaPlantilla$"}},{"key":"rutaExport","value":{"type":"STRING","expression":"$rutaExport$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Valuaci%C3%B3n%20-%20Cruce/Obtener%20datos%20por%20cuenta"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"0d46c8af-2fdc-4b40-ad5c-ce0c41048ea7","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$rutaLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Ruta Export: $rutaExport$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"0cd714a9-a6e1-45ee-ac38-22fdf6646e4d","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","expression":"$rutaExport$"}},{"name":"content","value":{"type":"STRING","expression":"$rutaExport$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"filaOperFile"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"operFile"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Recorre OPERFILE en la carpeta Valuacion"}}]}],"variables":[{"name":"fechaDesde","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"fechaHasta","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mesLength","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"diaLength","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"dia","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mes","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rutaLog","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rutaOperfile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"operFile","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"filaOperFile","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"cuentaBancaria","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sociedad","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"entidad","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rutaProcard","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rutaBancard","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rutaExport","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mesLetra","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"tablaMesLetra","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":"01 Enero"}]},{"values":[{"type":"STRING","string":"02 Febrero"}]},{"values":[{"type":"STRING","string":"03 Marzo"}]},{"values":[{"type":"STRING","string":"04 Abril"}]},{"values":[{"type":"STRING","string":"05 Mayo"}]},{"values":[{"type":"STRING","string":"06 Junio"}]},{"values":[{"type":"STRING","string":"07 Julio"}]},{"values":[{"type":"STRING","string":"08 Agosto"}]},{"values":[{"type":"STRING","string":"09 Septiembre"}]},{"values":[{"type":"STRING","string":"10 Octubre"}]},{"values":[{"type":"STRING","string":"11 Noviembre"}]},{"values":[{"type":"STRING","string":"12 Diciembre"}]}]}}},{"name":"rutaPlantilla","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"CsvTxt","version":"2.13.0","settingsAttributes":[]},{"name":"DataTable","version":"4.10.0","settingsAttributes":[]},{"name":"Folder","version":"6.10.1","settingsAttributes":[]},{"name":"If","version":"3.5.0-20220928-201537","settingsAttributes":[]},{"name":"LogToFile","version":"3.8.0","settingsAttributes":[]},{"name":"Loop","version":"3.8.1-20231117-175130","settingsAttributes":[]},{"name":"MessageBox","version":"3.7.0","settingsAttributes":[]},{"name":"Number","version":"3.6.0-20220928-104414","settingsAttributes":[]},{"name":"Step","version":"2.6.0","settingsAttributes":[]},{"name":"String","version":"5.7.1","settingsAttributes":[]},{"name":"System","version":"3.14.0","settingsAttributes":[]},{"name":"TaskBot","version":"2.8.0-20230530-152744","settingsAttributes":[]}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"5","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}