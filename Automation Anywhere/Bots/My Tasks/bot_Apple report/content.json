{"triggers":[],"nodes":[{"uid":"d0d405a2-6a14-4f75-a848-5f4c0809c5f0","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"2fac82c5-8aee-4e9c-b15a-e29a4d7b72a9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"65220b57-266b-42a8-8641-28b5fe4377d4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@entorno$"}}],"returnTo":{"type":"VARIABLE","variableName":"entorno"}},{"uid":"6fba476a-321a-49f9-be97-9549502e354b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"rpa@bancard.com.py"}}],"returnTo":{"type":"VARIABLE","variableName":"rpaEmail"}},{"uid":"43ca6a54-6786-4cff-b611-eac085b662d7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Month.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"mes"}},{"uid":"ac85d95e-ba59-42cc-b618-b3556d966122","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Year.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"año"}},{"uid":"dd311aa5-08db-4570-9ffc-10cfaa2dcff7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"[entidad] Metrics Report.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"filename"}},{"uid":"6f958932-9ab9-49c1-951e-97767107d7a6","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d41a57c9-9082-4333-a826-6c66213d3765","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Agregar"}}]}],"branches":[{"uid":"23f20d08-5d56-4e34-adfc-29c1c90313b2","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"de00c282-c0e4-4361-bda4-919adeee4690","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Tecnologia\\RPA_dev\\Apple Report"}}],"returnTo":{"type":"VARIABLE","variableName":"path"}},{"uid":"f5a4e08e-bd9a-42f2-8a43-811e198c88b3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$\\template\\Metrics Report Template.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"templateFile"}},{"uid":"ea7d84a9-cfd5-44a3-a42a-15519e9068b7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"10.10.17.48"}}],"returnTo":{"type":"VARIABLE","variableName":"ip"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$entorno$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"prd"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"5fc9eb2e-f9a6-4e94-b395-19ec605411d3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$\\logs\\$año$$mes$ log.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"log"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Seteo de variables"}}]},{"uid":"71b7de54-2c34-49e6-bb22-edc036a0a197","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"34d79664-9615-414c-9ac8-55039333b662","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"4518f705-182a-48ee-b838-3ab9da83f4da","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"b89a85bf-e8a3-4686-b2ca-3e58b72808b4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c75dc760-f441-48c8-b938-1d4e36629486","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\$año$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\$año$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"1"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"40f58ec9-2dd6-417a-b210-45cb3b54fded","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"f1792ecd-d452-4838-83e5-5b0e39eb43af","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\$año$\\$mes$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\$año$\\$mes$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"1"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"726b0bbe-bebc-4e7b-a120-592b651d1879","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$\\$año$\\$mes$"}}],"returnTo":{"type":"VARIABLE","variableName":"pathDestino"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Creacion de directorios"}}]},{"uid":"41864e7e-4026-4239-81a6-7ed229de81a2","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"586fdb5a-4ef8-427a-90dc-68715e3e2f81","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Inicio de generación de reportes de fecha $año$-$mes$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"7e32a98e-78f8-479c-8fc8-4b502d06d568","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Conexión a base de datos"}}]},{"uid":"1266b568-b9a7-40ce-9b63-e6c4e4c397d7","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a3a60c7c-ca07-4966-a155-d7051d081a30","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Agregar"}}]}],"branches":[{"uid":"9c992920-70d8-4a2e-a049-1ef1dd408d2b","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"54070d85-f4ed-4a58-b08c-a89190b88274","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","expression":"$ip$"}},{"name":"database","value":{"type":"STRING","string":""}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"Credenciales DWH TEST","lockerName":"Apple Report","attributeName":"user"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"Credenciales DWH TEST","lockerName":"Apple Report","attributeName":"password"}}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"},"sessionTarget":"LOCAL"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$entorno$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"prd"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"a9433171-9c68-4e84-8e63-1d952bb890d2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtiene todos los códigos de las entidades"}}]},{"uid":"4f15dd85-aa9f-47a6-a4b3-dc6859e3d844","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"SELECT DISTINCT COD_ENTIDAD, NOMBRE_ENTIDAD\nFROM ODS.dbo.REPORTE_APPLE_FINAL\nwhere YYYYMM = $año$$mes$;\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"entidades"}},{"uid":"2a894603-8c42-4723-ac84-bebc79bde6ea","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Por cada entidad"}}]},{"uid":"b9e03acf-3273-4040-994d-9a8ee837565e","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"659328dd-7dbc-4b15-b18d-c73130f08cdb","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filename$"}}],"returnTo":{"type":"VARIABLE","variableName":"filenameAux"}},{"uid":"e58b965b-3d0f-4645-bcb5-fd510d2acc21","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filenameAux$"}},{"name":"find","value":{"type":"STRING","string":"[entidad]"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$entidad[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"filenameAux"}},{"uid":"66b477cd-67b6-4b10-91f6-f94e147de66d","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$templateFile$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$pathDestino$\\$filenameAux$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isParallel","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ed5ca526-0b46-47d3-b263-032ac631ea3e","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"excelSourceOption","value":{"type":"STRING","string":"desktopfilepath"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$pathDestino$/$filenameAux$"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"excludeHiddenSheets","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsChart","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"},"sessionTarget":"LOCAL"}},{"uid":"83c7f25d-b1a7-43ee-aa7f-42c63c1434b2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Para cada hoja del excel"}}]},{"uid":"e9e9d994-ec16-4ffe-9262-087a93580ae4","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Se escriben los datos en la hoja correspondiente"}}]},{"uid":"6d5a034b-67ff-4316-bc24-cb632a5f9887","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"43fc252d-4aae-4a2d-ae74-43a085e980ca","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Metrics"}}],"returnTo":{"type":"VARIABLE","variableName":"hoja"}},{"uid":"db956039-1662-4190-bfe1-df73b8fd00cf","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select\nGRUPO, ITEM, VALOR, YYYYMM, COD_ENTIDAD, HOJA\nfrom\nODS.dbo.REPORTE_APPLE_FINAL\nwhere\nYYYYMM = $año$$mes$ and \nCOD_ENTIDAD =$entidad[0]$ \norder by \nGRUPO ASC, ITEM ASC;\n\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"resultadoConsulta"}},{"uid":"b19ae220-ee3b-455a-81d5-1efffadc7e39","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$hoja$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"69d06290-c78e-4c5b-9742-4d82d99a74cc","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"d3b4965a-2fa5-47ce-a637-bd553cc92ac8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"GRUPO"}},{"uid":"5c34869f-4781-408a-a67c-fa0f4191b1f7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"ITEM"}},{"uid":"744fc85e-d82c-4f3c-84fd-02d543058579","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}},{"uid":"d838afce-6f5e-48a2-a693-fd75a5bc3c58","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$ITEM$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcel"}},{"uid":"8d023ad3-7779-4e64-bbb7-37c038529c50","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":","}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}},{"uid":"9cc3481d-cdd2-4c9a-b6d9-4fd71ddb97b0","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3efc7426-3242-4eda-8329-0e2bea61eee9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Si el dato es porcentaje"}}]},{"uid":"4181429c-a33f-4f96-b49e-7d9a3365539b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$%"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$filaExcel.String:toNumber$"}},{"name":"operator","value":{"type":"STRING","string":"GTE"}},{"name":"value","value":{"type":"NUMBER","number":"9"}}],"operatorAttribute":{"operator":"AND","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"},"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$filaExcel.String:toNumber$"}},{"name":"operator","value":{"type":"STRING","string":"LTE"}},{"name":"value","value":{"type":"NUMBER","number":"14"}}]},"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"3645d6d2-b61d-4351-8aaf-0143d420f56f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"01148b1c-bd9c-4fc0-abfa-64d6781b79ad","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"B"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"branches":[{"uid":"ef882b4c-44fa-438d-8c51-d05e1002f06a","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"d5cb9846-bd3f-4770-85d4-b3e59dbb3c5d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$GRUPO$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"CREDIT"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"8220189a-6998-4738-911e-8aa6da1146df","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7ffff90b-deb7-4376-879a-600e64c425b3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"D"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$GRUPO$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"DEBIT"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"650c9014-b218-4fe3-acc0-7df50488c671","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colExcel$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$VALOR$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"resultadoConsulta"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Hoja METRICS"}}]},{"uid":"5edebfd5-ad57-426f-9b23-0c179ebff792","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"102cebde-4a6e-44e9-a73a-030aad65a579","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Declines"}}],"returnTo":{"type":"VARIABLE","variableName":"hoja"}},{"uid":"ee538681-8abb-49c7-831a-725658b59029","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select GRUPO, TX,TX_SIZE, VALOR,YYYYMM,HOJA\nfrom \nODS.dbo.REPORTE_APPLE_FINAL_DECLINES\nwhere\nYYYYMM =$año$$mes$ and \nCOD_ENTIDAD = $entidad[0]$\norder by GRUPO, TX, TX_SIZE;\n\n\n\n\n\n\n\n\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"resultadoConsulta"}},{"uid":"569af7e5-cbb6-4e8f-8a3d-b67ded49d24b","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$hoja$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"3fa79da9-5fdd-4fb0-81be-8d10bdf17a90","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"7"}}],"returnTo":{"type":"VARIABLE","variableName":"filaBase"}},{"uid":"914bc320-8c6f-4e71-b7d2-4484637c3f03","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"b07dc6f4-bcf9-4cc9-9310-92e0a2d47f6e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"GRUPO"}},{"uid":"35cd7ac8-40ee-469f-8f09-ec6a4ba0e57c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"TX"}},{"uid":"5e133a21-7d65-49ea-895c-7d0f2d021524","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$TableRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"TX_SIZE"}},{"uid":"e53347a7-4afc-458a-9b68-556b799eeb70","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[3]$"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}},{"uid":"7ca6cb23-25f4-409c-a06e-5dba7652f129","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":","}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}},{"uid":"a4056714-e13c-4a35-b67b-5dc793aaa0aa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a603a618-5f7c-4a04-9685-96231b70d2c9","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a5cfabaa-3be8-4f8b-9948-4620d81d3d32","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"B"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"branches":[{"uid":"e8540ac4-5632-4b20-b804-a4221073202d","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"38eafea8-a487-4fd2-b1a7-7c515dab99b1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TX$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"TOTAL_DECLINADAS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"eaf15e8e-c87e-403d-9fff-7c6fef59e9d3","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"57bc7f2c-ceab-436b-b610-fe3ad0090d28","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"TOTAL_TX_RATE"}}]},{"uid":"4108854f-a2ec-4406-ac93-1ec84ba27e66","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"D"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}},{"uid":"160d89e5-cd80-497c-8a04-f7e6ae93d1a8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$%"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TX$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"TOTAL_TX"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"eeffdb94-fa37-46ca-97fe-37edb4af8100","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"fcb60746-67bf-4b94-837e-94b96c38ab53","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"REMOTE"}}]},{"uid":"2e4c5c2c-a619-4144-ba98-cdd21cbc61c4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ac26a6e8-aa07-4d24-a5b1-a5dc57b16f9e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"F"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"branches":[{"uid":"b475549b-f5f9-4038-9dd8-ff6ea446a84d","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"8fef3436-4c11-4b5c-b1ed-1c4fd21ab9f0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"G"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TX$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"TOTAL_DECLINADAS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"b24d0f19-7ffd-48f4-aab5-82a22fc55368","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"c76dc4a2-96d6-48a6-8f8a-4e3c5d9664e6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"TOTAL_TX_RATE"}}]},{"uid":"6a266641-d8ae-4a43-9678-447a4656efab","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"H"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}},{"uid":"1a2f933c-c9ae-434d-985f-ec9106196db7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$%"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TX$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"TOTAL_TX"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$GRUPO$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"POS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"c8eaaaca-efe7-4786-a70a-bb1dcb6b85b1","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$filaBase$+$TX_SIZE$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcelNum"}},{"uid":"f3e662ee-1492-457a-a5bb-5a30c7c4534d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaExcelNum.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcel"}},{"uid":"ad2e78bb-566f-4619-ae59-5cf72a08c3c5","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colExcel$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$VALOR$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"resultadoConsulta"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"828ff7b9-2e64-4748-bca3-f9c80e1d7177","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Hoja DECLINES"}}]},{"uid":"aeaf16a7-b0b7-4f17-9553-5e4f3caea714","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6a6c0fc8-5955-4976-9fe6-cd94a64cd3b7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Usage Frequency"}}],"returnTo":{"type":"VARIABLE","variableName":"hoja"}},{"uid":"05f511e4-c917-4428-8507-2fc10b029cda","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select \nGRUPO, CATEGORIA, CANTIDAD, YYYYMM, COD_ENTIDAD, HOJA \nfrom \nODS.dbo.REPORTE_APPLE_FINAL_FREQUENCY\nWHERE \nYYYYMM = $año$$mes$ and COD_ENTIDAD = $entidad[0]$\norder by CATEGORIA asc;\n\n\n\n\n\n\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"resultadoConsulta"}},{"uid":"34be2838-13c0-45f0-88ca-1c81c2415cdd","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$hoja$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"c878aa88-2a1d-4a18-a126-f2948812c028","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"8"}}],"returnTo":{"type":"VARIABLE","variableName":"filaBase"}},{"uid":"702555e6-b5b1-4bdb-9a61-aac15acee3ee","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"7dea319e-7a2e-4c5d-b0f4-706c5727d382","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$TableRow[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"CATEGORIA"}},{"uid":"bbce9f89-3275-4bb0-be56-842c6bbd6055","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$TableRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"CANTIDAD"}},{"uid":"bb5ebffa-551c-440b-923d-3b9404572baf","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"D"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}},{"uid":"9f7c5c67-8c45-42b5-b01f-03fa78338a65","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$filaBase$+$CATEGORIA$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcelNum"}},{"uid":"6a6c7998-f883-498c-9ba5-c7862e0a22ab","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaExcelNum.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcel"}},{"uid":"3e1fb499-64d2-479e-8790-4d0631c232e1","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colExcel$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$CANTIDAD.Number:toString$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"resultadoConsulta"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"b7a15c72-6889-4840-881b-2cbcec84c835","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Hoja USAGE FRECUENCY"}}]},{"uid":"f02e0f0b-c548-4189-8f92-be2ad8b2f2a8","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5a70ba2a-3d0b-4a64-83c9-407639f95f42","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"AMR_TopMerchants"}}],"returnTo":{"type":"VARIABLE","variableName":"hoja"}},{"uid":"fbb85158-efb8-4dd2-b02f-c7655d181168","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select \nGRUPO, ITEM, DENOMINACION_MERCHANT, COUNT_TX, VALOR_TX \nfrom \nODS.dbo.REPORTE_APPLE_TOP_MERCHANTS\nWHERE \nYYYYMM = $año$$mes$ and COD_ENTIDAD = $entidad[0]$\norder by GRUPO asc, ITEM asc;\n\n\n\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"resultadoConsulta"}},{"uid":"e7520f15-8b19-4551-aee2-ccb763a02b9c","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$hoja$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"7761789c-a4b7-4c4d-9899-71be93af0fbc","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"8"}}],"returnTo":{"type":"VARIABLE","variableName":"filaRankBase"}},{"uid":"d3ad1316-ca86-4374-9bf9-b578821d2993","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"c7e0843d-b889-4374-b04b-b02276920408","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"GRUPO"}},{"uid":"33943045-5098-4ac8-84e7-ad8ce8b0b0a7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"ITEM"}},{"uid":"35281b03-623a-4304-abc4-5f4ca977818c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"DENOMINACION"}},{"uid":"f2009bc2-ab84-4eca-9d5e-b50f4c5f545c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[3]$"}}],"returnTo":{"type":"VARIABLE","variableName":"COUNT_TX"}},{"uid":"571c6448-4bb1-4833-83c4-359856d53c99","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[4]$"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR_TX"}},{"uid":"ebfad5f0-df91-4744-9fe2-9ea68e11595a","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$COUNT_TX$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":","}}],"returnTo":{"type":"VARIABLE","variableName":"COUNT_TX"}},{"uid":"21cd39b7-a0b1-4803-9712-cbf05f281483","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$COUNT_TX$"}},{"name":"find","value":{"type":"STRING","string":",00"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"COUNT_TX"}},{"uid":"e4658713-821f-432d-9fbf-66c60e30d632","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR_TX$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":","}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR_TX"}},{"uid":"6898e070-f5d6-4b00-b406-3ebb8d719d6f","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$DENOMINACION$"}},{"name":"find","value":{"type":"STRING","string":"\\s+"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":" "}}],"returnTo":{"type":"VARIABLE","variableName":"DENOMINACION"}},{"uid":"f2640ba7-901c-4cbe-aacc-36e821d63b4e","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ab1fb587-0e86-44b5-9e0f-eec0921c8c2d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"B"}}],"returnTo":{"type":"VARIABLE","variableName":"colMerchantName"}},{"uid":"48f1e953-9f92-4075-a409-53f51d1613fa","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C"}}],"returnTo":{"type":"VARIABLE","variableName":"colTransactionCount"}},{"uid":"1e9e647e-c020-4cf8-a39d-f2161e30c0c0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"D"}}],"returnTo":{"type":"VARIABLE","variableName":"colSpendAmout"}}],"branches":[{"uid":"9b44e46c-407c-48e9-8646-452b62bcfbff","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"804163fc-02e3-4d55-ba51-d731fe7a9021","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"DEBIT"}}]},{"uid":"d9d5305e-8486-40c9-80a5-4d97de98ff85","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"G"}}],"returnTo":{"type":"VARIABLE","variableName":"colMerchantName"}},{"uid":"4af42707-00a2-4bbf-b1bf-c4325a7612ae","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"H"}}],"returnTo":{"type":"VARIABLE","variableName":"colTransactionCount"}},{"uid":"3aa051e8-ffb0-4cd2-b546-14b6a14669a8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"I"}}],"returnTo":{"type":"VARIABLE","variableName":"colSpendAmout"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$GRUPO$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"CREDIT"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"dd5b2242-c569-46b4-964a-51a739e58f38","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$filaRankBase$+$ITEM.String:toNumber$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcelNum"}},{"uid":"e9dbd82f-0c27-4084-9598-a26a7f9ea52a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaExcelNum.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcel"}},{"uid":"ffeea6a2-e048-4de5-9dc5-da0245dd2337","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colMerchantName$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$DENOMINACION$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"5bad4c91-af44-4819-92e1-62731c7125cf","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colTransactionCount$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$COUNT_TX$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"29b584d2-a047-4f3d-a051-9473576753dc","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colSpendAmout$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$VALOR_TX$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"resultadoConsulta"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"8611524f-7288-489c-a2b4-3d2b7e6c1adf","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Hoja TO MERCHANTS"}}]},{"uid":"c1115e03-fea0-4351-82a1-01f9b21895d2","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","string":"Metrics"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"05baeb28-55ee-4b07-945e-a668dc7231ff","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"b6076520-7c43-4906-85d7-49e07f31acf4","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"entidad"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"entidades"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"b8acd649-cb53-4943-b08d-e235051b45c9","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"dosaveData","value":{"boolean":false,"type":"BOOLEAN"}},{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}}]},{"uid":"dc33d904-5e8d-4868-8c7c-64f7eef8e152","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Generación de reportes de fecha $año$-$mes$ finalizado con éxito"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Consulta y llenado del excel"}}]}],"branches":[{"uid":"9c42efdb-536d-413b-a736-f2ac0b4c53f8","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"6050965e-013c-4434-a39c-fed790b42474","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Error en línea $ErrorLineNumber.Number:toString$. $ErrorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"301a6e0c-837f-46f1-814b-c5d2e0b12d3f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Generación de reportes de fecha $año$-$mes$, finalizado con error"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4e4117e1-8517-4f26-ab8a-26bfccff8a70","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"17312144-7469-4e9a-aa6a-ff4c4d69568c","commandName":"SendMailV2","packageName":"Email","disabled":true,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$rpaEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","string":"Apple report - Error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Linea: $ErrorLineNumber.Number:toString$\nError: $ErrorMessage$ "}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}}]}],"branches":[{"uid":"d42984d8-20d6-42ac-8534-a1fb818d292c","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"a46afa95-154e-49fd-a240-fd22ac60674b","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Error en línea $ErrorLineNumber.Number:toString$. $ErrorMessage$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"dfe01c51-5b2b-44ee-9845-ecb7f459eeec","commandName":"SendMailV2","packageName":"Email","disabled":true,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$rpaEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","string":"[TEST] Apple report - Error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Linea: $ErrorLineNumber.Number:toString$\nError: $ErrorMessage$ "}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$entorno$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"prd"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"e8e008db-3249-4e9b-a51c-8986697a49ec","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0c019c74-42ec-4e35-8a04-e738579b6f8f","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e2c78e96-ac6c-4774-b3aa-68bf411692d2","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"dosaveData","value":{"boolean":false,"type":"BOOLEAN"}},{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}}]}],"branches":[{"uid":"510ebea9-fbc0-40c7-a492-d9df7e4271a5","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"498a7ac1-c042-4941-8f13-280f39159d51","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Linea: $ErrorLineNumber.Number:toString$\nMsg: $ErrorMessage$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Cierre de conexión a base de datos"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"path","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"templateFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"año","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mes","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rpaEmail","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"filename","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ip","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"resultadoConsulta","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"hojas","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"hoja","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pathDestino","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"filenameAux","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"Fila","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"dummy","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"TableRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"filaExcel","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"colExcel","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"entorno","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"entidades","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"entidad","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"celdaExcel","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"celdasExcel","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"GRUPO","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"TX","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"tx_","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"TX_SIZE","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"CATEGORIA","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"CANTIDAD","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"ITEM","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"VALOR","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"DENOMINACION","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"COUNT_TX","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"VALOR_TX","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"colMerchantName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"colTransactionCount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"colSpendAmout","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"filaRankBase","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"filaExcelNum","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"filaBase","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"logFilename","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"logPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"logDummyName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"log","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"packages":[{"name":"Comment","version":"2.16.0","settingsAttributes":[]},{"name":"Database","version":"5.4.0","settingsAttributes":[]},{"name":"DataTable","version":"4.12.1","settingsAttributes":[]},{"name":"Email","version":"3.23.2","settingsAttributes":[]},{"name":"ErrorHandler","version":"2.12.1-20231117-175338","settingsAttributes":[]},{"name":"Excel_MS","version":"6.20.0","settingsAttributes":[]},{"name":"File","version":"6.11.0","settingsAttributes":[]},{"name":"Folder","version":"6.11.0","settingsAttributes":[]},{"name":"If","version":"3.7.14-20231116-000453","settingsAttributes":[]},{"name":"LogToFile","version":"3.8.0","settingsAttributes":[]},{"name":"Loop","version":"3.8.1-20231117-175130","settingsAttributes":[]},{"name":"MessageBox","version":"3.7.0","settingsAttributes":[]},{"name":"Number","version":"3.9.1","settingsAttributes":[]},{"name":"Step","version":"2.6.0","settingsAttributes":[]},{"name":"String","version":"5.10.0","settingsAttributes":[]},{"name":"System","version":"3.14.0","settingsAttributes":[]}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"6","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}