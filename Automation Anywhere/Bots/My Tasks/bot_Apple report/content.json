{"triggers":[],"nodes":[{"uid":"d0d405a2-6a14-4f75-a848-5f4c0809c5f0","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"2fac82c5-8aee-4e9c-b15a-e29a4d7b72a9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"65220b57-266b-42a8-8641-28b5fe4377d4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@entorno$"}}],"returnTo":{"type":"VARIABLE","variableName":"entorno"}},{"uid":"dd311aa5-08db-4570-9ffc-10cfaa2dcff7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"[entidad] APPLE PAY REPORT [fecha].xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"filename"}},{"uid":"68860084-a5b0-41a9-a43c-695b0df18a0b","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"dev"}}],"returnTo":{"type":"VARIABLE","variableName":"entorno"}},{"uid":"bdbe4307-ea94-4c2c-9e46-93b5bf7c95f0","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"a341dc34-da00-4042-9ec2-1f880498d1da","commandName":"assignToNumber","packageName":"Number","disabled":true,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$System:Day$"}}],"returnTo":{"type":"VARIABLE","variableName":"diaActual"}},{"uid":"4c8f3946-7d95-44c8-a633-44ee72541ecc","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"10"}}],"returnTo":{"type":"VARIABLE","variableName":"diaActual"}},{"uid":"05b2819b-3299-41c8-90e6-6edf9c8b06b0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"11"}}],"returnTo":{"type":"VARIABLE","variableName":"mes"}},{"uid":"5a9f0583-409e-476a-bc37-2b433f025426","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"2024"}}],"returnTo":{"type":"VARIABLE","variableName":"año"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Seteo de fecha TEST"}}]},{"uid":"2fc3e1b5-a3ca-4c8b-ad4f-f9d8458bc6b8","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"2ce0bcb3-85df-4639-a484-2fc8123b0ce3","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$System:Day$"}}],"returnTo":{"type":"VARIABLE","variableName":"diaActual"}},{"uid":"80caadbd-89a3-4724-8cb2-ee99ebd156ac","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1d106966-71fe-439c-825f-e395cbb6d96b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"12"}}],"returnTo":{"type":"VARIABLE","variableName":"mes"}},{"uid":"42859078-0d40-4688-a340-89c949ded155","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$System:Year$-1"}}],"returnTo":{"type":"VARIABLE","variableName":"añoNumerico"}},{"uid":"9bd9eb4c-199f-4546-84a4-530b91e092c6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$añoNumerico.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"año"}}],"branches":[{"uid":"dabd16d0-ef57-4f3f-86c2-3881792bbc23","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"27d4c895-69a3-4fa6-bf9a-dd7095490f97","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$System:Month$-1"}}],"returnTo":{"type":"VARIABLE","variableName":"mesNumerico"}},{"uid":"59815783-f211-4b76-9f9c-a05360dda53a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$mesNumerico.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"mes"}},{"uid":"5c9a6614-04d1-4525-b43b-ba531a370e39","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:Year.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"año"}},{"uid":"cdc19f2d-de12-42f3-bc43-1180bec11708","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"f8d6236a-e25b-47ad-9376-e46c12e0e924","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"0$mes$"}}],"returnTo":{"type":"VARIABLE","variableName":"mes"}}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$mesNumerico$"}},{"name":"operator","value":{"type":"STRING","string":"LTE"}},{"name":"value","value":{"type":"NUMBER","number":"9"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$System:Month$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"1"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Seteo de fecha"}}]},{"uid":"7879ee5a-5a15-45c8-94f8-e86dff2d54ba","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"d6725e20-b870-4e7c-9d71-bccc22c245c4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"402d8415-b0ca-44ab-b129-13e7c56abaff","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$diaActual$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"NUMBER","number":"10"}}],"operatorAttribute":{"operator":"AND","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"},"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$diaActual$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"NUMBER","number":"15"}}]},"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Verificación fecha"}}]},{"uid":"f4b08b38-3f19-4582-af88-959e1240b020","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"2b8925d9-d5e0-42fb-a6bd-db7d2ae4de1b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"15dfc0fe-41f7-4950-99fb-91b844b42c16","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"January"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"branches":[{"uid":"c54a65a4-16e0-423f-a8d5-68f9d5b62438","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"f9b48b7b-4832-4a5d-81b8-0b3655d7494b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"February"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"02"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"fa38010a-31e3-42ce-a510-9429a0e80493","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"98343f8f-2dde-4256-928b-f4c697b2bb6a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"March"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"03"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"307be441-e9f2-4a27-b4f6-afc18cbc08db","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"147bb7d4-7fe8-4f5a-a54d-8d264bd2bdbe","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"April"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"04"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"90baaff0-61b7-4616-980a-95af694ef253","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"87a97252-03bb-4b74-bc50-740d81c312bd","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"May"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"05"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"86b3fc45-5f7f-4c1a-91f2-a94a40540092","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"a5b87b48-fd3d-4239-b610-f3c8fb87ea7d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"June"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"06"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"13d73db8-4579-4831-87dc-7ecdc367c98f","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"31bed846-7ad0-42e1-b714-4dccd4fec6a1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"July"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"07"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"ecd3e35d-b6fb-4701-94dc-a44e5bbaec6f","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"9df4ae15-fcdd-4e57-ac56-1d174a87656c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"August"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"08"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"97c5ced9-bf5c-45a8-b507-1681fde3eaa7","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"5da9d034-8a3d-48af-b170-561b6413ea0a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"September"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"09"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"8fa3e5af-9626-4ad0-8a5f-ba2ebe686e4f","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"cf3d27b5-8ed7-46a7-9caf-2a566c64cebd","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"October"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"10"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"e5206006-3cba-4d08-9a75-735c97ab5833","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"44b7dec9-e3c6-4c5d-86f5-81cc6da3b0c4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"November"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"11"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"6a46eb89-d8ad-4af5-93fe-02737257c0ab","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"c69dd5ca-7173-4dbd-b61f-567f48fca91d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"December"}}],"returnTo":{"type":"VARIABLE","variableName":"nombreMes"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$mes$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"01"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"obtencion nombre del mes"}}]},{"uid":"6f958932-9ab9-49c1-951e-97767107d7a6","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cdccff37-a469-49aa-bfdd-76d1d2f3df80","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Tecnologia\\RPA_prd\\Apple Report"}}],"returnTo":{"type":"VARIABLE","variableName":"path"}},{"uid":"5849d5d8-0a2a-4980-96f0-dfaee613883c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Para pruebas en prd"}}]},{"uid":"0aeb54df-7e82-4792-98db-6af90665b00a","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$"}}],"returnTo":{"type":"VARIABLE","variableName":"pathDestinoReportes"}},{"uid":"1f2abb09-0515-4e33-86eb-7a541a8f15a7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Directorio productivo. Solo se puede depositar 1 vez el reporte. Si hay reproceso se debe de comunicar a Ingeniería"}}]},{"uid":"246e85e0-4a80-4b67-ad69-476d10eb0717","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\FS-PROCESOS\\Reporte Apple RPA"}}],"returnTo":{"type":"VARIABLE","variableName":"pathDestinoReportes"}},{"uid":"8496fc96-b37b-4e34-95de-23aa52393cbb","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$\\template\\Metrics Report Template.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"templateFile"}},{"uid":"fc8b87b8-35e8-48c0-b1b2-77ba04a0d3b8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"10.30.24.30"}}],"returnTo":{"type":"VARIABLE","variableName":"ip"}}],"branches":[{"uid":"23f20d08-5d56-4e34-adfc-29c1c90313b2","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"de00c282-c0e4-4361-bda4-919adeee4690","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\nas\\Tecnologia\\RPA_dev\\Apple Report"}}],"returnTo":{"type":"VARIABLE","variableName":"path"}},{"uid":"182d482a-26da-4557-b561-6e3295d3c135","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$"}}],"returnTo":{"type":"VARIABLE","variableName":"pathDestinoReportes"}},{"uid":"f5a4e08e-bd9a-42f2-8a43-811e198c88b3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$\\template\\Metrics Report Template.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"templateFile"}},{"uid":"ea7d84a9-cfd5-44a3-a42a-15519e9068b7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"10.10.17.48"}}],"returnTo":{"type":"VARIABLE","variableName":"ip"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$entorno$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"prd"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"5fc9eb2e-f9a6-4e94-b395-19ec605411d3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$\\logs\\$año$$mes$ log.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"log"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Seteo de variables"}}]},{"uid":"71b7de54-2c34-49e6-bb22-edc036a0a197","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"82c46ad4-6c06-4b64-9c15-099298cf532d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"7c16aa7a-6bf6-486d-8eee-09de932f8707","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"34d79664-9615-414c-9ac8-55039333b662","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b5c26e16-e7c5-4193-bae2-417e8b1db534","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\historial"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\historial"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"afebca8d-54dc-49a2-8bc9-dc1d1593fc1c","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"84903b32-3121-4559-bd08-58a3c4ccf62b","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\historial\\$año$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\historial\\$año$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"b6ef0218-cfeb-47f3-9c66-bcf04a2e22fe","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"f6fab30b-86ff-4d88-802c-539abb221162","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\historial\\$año$\\$mes$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$path$\\historial\\$año$\\$mes$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"f3834aa4-9a79-48a4-931e-2e1061415bd4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$path$\\historial\\$año$\\$mes$"}}],"returnTo":{"type":"VARIABLE","variableName":"pathHistorial"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Creacion de directorios"}}]},{"uid":"41864e7e-4026-4239-81a6-7ed229de81a2","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"586fdb5a-4ef8-427a-90dc-68715e3e2f81","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Inicio de generación de reportes de fecha $año$-$mes$\nConectando a $ip$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"7e32a98e-78f8-479c-8fc8-4b502d06d568","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Conexión a base de datos"}}]},{"uid":"1266b568-b9a7-40ce-9b63-e6c4e4c397d7","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a3a60c7c-ca07-4966-a155-d7051d081a30","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Mismas credenciales que test"}}]},{"uid":"44b5fd46-aa31-4701-8064-b9e83ee9e9b8","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","expression":"$ip$"}},{"name":"database","value":{"type":"STRING","string":""}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"Credenciales DWH TEST","lockerName":"Apple Report","attributeName":"user"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"Credenciales DWH TEST","lockerName":"Apple Report","attributeName":"password"}}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"},"sessionTarget":"LOCAL"}}],"branches":[{"uid":"9c992920-70d8-4a2e-a049-1ef1dd408d2b","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"54070d85-f4ed-4a58-b08c-a89190b88274","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","expression":"$ip$"}},{"name":"database","value":{"type":"STRING","string":""}},{"name":"user","value":{"type":"CREDENTIAL","credential":{"name":"Credenciales DWH TEST","lockerName":"Apple Report","attributeName":"user"}}},{"name":"auth","value":{"type":"CREDENTIAL","credential":{"name":"Credenciales DWH TEST","lockerName":"Apple Report","attributeName":"password"}}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"},"sessionTarget":"LOCAL"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$entorno$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"prd"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"a9433171-9c68-4e84-8e63-1d952bb890d2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Obtiene todos los códigos de las entidades"}}]},{"uid":"4f15dd85-aa9f-47a6-a4b3-dc6859e3d844","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"SELECT DISTINCT COD_ENTIDAD, NOMBRE_ENTIDAD\nFROM ODS.dbo.REPORTE_APPLE_FINAL\nwhere YYYYMM = $año$$mes$ \nand COD_ENTIDAD =17 ;"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"entidades"}},{"uid":"4dfe5af4-6561-411a-9016-025bd2e52758","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"3fb47949-b4e2-4354-a023-b592a1d27ada","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b9b1d41a-7116-4288-9e0b-15bc63bea71b","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","string":"Eliminación de reportes"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"25658e6d-188f-4977-9860-f981f1696f72","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"1e8fd30d-aca1-4b05-b799-203f10ddeece","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pathDestinoReportes$\\$entidad[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"pathDestino"}},{"uid":"ce5296c4-5a29-4847-a686-a82fab115f83","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cef0ce8b-ec63-437d-b765-f7861a06d056","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$pathDestino$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$pathDestino$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"aa71ec23-1bef-4d25-9131-e4e8c898e611","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"46df95f4-11bf-4ab1-9452-53e6f50fc9a7","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$pathDestino$/$archivo{name}$.$archivo{extension}$"}},{"name":"isParallelDelete","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"archivo"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$pathDestino$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"entidad"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"entidades"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"97518489-64ed-4b99-a76e-f9271eb96148","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$@rpaEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","string":"Apple report - Limpieza de directorios"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Se eliminaron los reportes del directorio \"$pathDestinoReportes$\" \n\nEl historial se encuentra en \"$pathHistorial$\""}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}}]},{"uid":"86f7e940-6437-4292-a2c5-d6f14a577c55","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$diaActual$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"15"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Eliminacion de reportes generados del mes"}}]},{"uid":"2a894603-8c42-4723-ac84-bebc79bde6ea","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Por cada entidad"}}]},{"uid":"03bf62af-8255-4d1e-adaf-95be60b1e048","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"207afb32-2081-4eeb-ba8c-ead1204da88f","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"pararProceso"}},{"uid":"14527375-1834-4b63-b528-9e93eeaff086","commandName":"assign","packageName":"Datetime","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"variable"}},{"name":"dateTime","value":{"type":"DATETIME","expression":"$System:Date$"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaActual"}},{"uid":"ded01785-1436-4c8d-8cd0-1f9ebe2458b0","commandName":"assign","packageName":"Datetime","disabled":true,"attributes":[{"name":"option","value":{"type":"STRING","string":"variable"}},{"name":"dateTime","value":{"type":"DATETIME","string":"2025-06-01T00:00:00-04:00[America/Asuncion]"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaActual"}},{"uid":"8a0a255f-9a0a-4777-bd2a-d1344015c520","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b9e5cffb-cba9-4ff7-a636-880d36e5f776","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","string":"Se procede a verificar la cantidad de transacciones"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"7ebe7cb1-98c7-4c78-859a-8d896214943c","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"bc5894a2-4f5a-4401-b17e-68485b0b9eb6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Cálculo para entidad $entidad[1]$\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"2c64968c-5854-41ed-bf1c-a005ca5a8525","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Se calcula el promedio de transacciones de 6 meses vs las transacciones del mes actual, si el número de transacciones del mes es menor al promedio de 6 meses, no se debe generar reporte ya que posiblemente sea un problema"}}]},{"uid":"c6162e29-bdd8-4968-8a71-f24c902e113c","commandName":"assign","packageName":"Datetime","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"variable"}},{"name":"dateTime","value":{"type":"DATETIME","expression":"$fechaActual$"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaBusqueda"}},{"uid":"f53d9961-f09c-451d-84d8-4888452d7118","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"506582e9-5e10-49bd-9740-f3f4d2cdc6e1","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"totalTransaccionesMes"}},{"uid":"6f068383-d328-4b5a-ba57-b55de880effd","commandName":"subtract","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$fechaBusqueda$"}},{"name":"val","value":{"type":"NUMBER","number":"1"}},{"name":"unit","value":{"type":"STRING","string":"MONTHS"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaBusqueda"}},{"uid":"e04fe159-65e4-4048-b8ac-5381430ee729","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$fechaBusqueda$"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyyMM"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaConsulta"}},{"uid":"4333b931-f309-4b1d-a0d4-894431f2ce7d","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select \nVALOR\nFROM ODS.dbo.REPORTE_APPLE_FINAL\nwhere \nYYYYMM = $fechaConsulta$ and COD_ENTIDAD =$entidad[0]$ and ITEM=7;"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"cantidadTransaccionesQueryResult"}},{"uid":"01aa0576-1789-4543-8104-b1be642bfab8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"select \nVALOR\nFROM ODS.dbo.REPORTE_APPLE_FINAL\nwhere \nYYYYMM = $fechaConsulta$ and COD_ENTIDAD =$entidad[0]$ and ITEM=7;\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"946d4a91-020e-4155-8afd-7bb90f1129c6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Sumatoria de las transacciones de crédito, débito y prepago"}}]},{"uid":"99a9b8d4-5fb8-410a-84ec-28b5636f2698","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"e43dae44-8766-4b39-a517-dc8afbd728cf","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"8aecacf0-051b-4d4e-afdb-075706b3975d","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$cantidadTransaccionesRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"cantidadTransacciones"}},{"uid":"abfd605b-2c0f-401e-83e8-309ba937c152","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$totalTransaccionesMes$+$cantidadTransacciones$"}}],"returnTo":{"type":"VARIABLE","variableName":"totalTransaccionesMes"}},{"uid":"d6d0837d-d1ac-4279-936a-fad3c960b1a4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"$cantidadTransacciones.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"9bdb9768-0999-4c52-b0d0-79d9e93fb460","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4a958ba3-f04f-40dc-a102-0242bd580435","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Error al convertir la cantidad de transacciones de $entidad[1]$ a numerico.\nError en linea $ErrorLineNumber.Number:toString$. $ErrorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"cantidadTransaccionesRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"cantidadTransaccionesQueryResult"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"ab48230c-88f8-4f90-b65b-1dcdb9cafc38","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Total transacciones del mes: $totalTransaccionesMes.Number:toString$\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Total de transacciones del mes (anterior)"}}]},{"uid":"f9cc574c-b3f8-41af-a06e-27b1660e8f95","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5a3abaa5-1a0e-4a8d-a443-05caaf9534df","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","string":"Cálculo del promedio"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b6a89c08-b67f-4bdd-8bea-f5fdf681caff","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sumatoria"}},{"uid":"80b09ddf-00bf-4f2e-90ec-c8b3b93468b9","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"50b97e37-f3dc-42c6-9312-ac59a0e411a8","commandName":"subtract","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$fechaBusqueda$"}},{"name":"val","value":{"type":"NUMBER","number":"1"}},{"name":"unit","value":{"type":"STRING","string":"MONTHS"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaBusqueda"}},{"uid":"36451ede-7576-4b81-94a3-54d133a1b5ac","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$fechaBusqueda$"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyyMM"}}],"returnTo":{"type":"VARIABLE","variableName":"fechaConsulta"}},{"uid":"bdec1203-02a5-4f20-a929-8d8f735e2d92","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select \nVALOR\nFROM ODS.dbo.REPORTE_APPLE_FINAL\nwhere \nYYYYMM = $fechaConsulta$ and COD_ENTIDAD =$entidad[0]$ and ITEM=7;"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"cantidadTransaccionesQueryResult"}},{"uid":"3302f1d5-233e-45d7-b670-012638ad55c1","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"select \nVALOR\nFROM ODS.dbo.REPORTE_APPLE_FINAL\nwhere \nYYYYMM = $fechaConsulta$ and COD_ENTIDAD =$entidad[0]$ and ITEM=7;"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"69e147c1-b27a-4b8f-85ac-5c33fc09e32a","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"68047f84-bb61-4d66-9a53-49614937718b","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"fe3193a8-cb6a-45df-b477-c90185ebc947","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$cantidadTransaccionesRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"cantidadTransacciones"}},{"uid":"2415e233-1ea1-4031-abc9-e2cd7eb99136","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$sumatoria$+$cantidadTransacciones$"}}],"returnTo":{"type":"VARIABLE","variableName":"sumatoria"}},{"uid":"cad8f01f-b80a-47ab-a6ee-a29aaaa1dcbf","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Cantidad transacciones: $cantidadTransacciones.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"85bd836e-ede7-463b-9569-99e75c071163","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"1dec125d-cbf2-4a2d-a49b-bb14c171273c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Error al convertir la cantidad de transacciones de $entidad[1]$ a numerico.\nError en linea $ErrorLineNumber.Number:toString$. $ErrorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"cantidadTransaccionesRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"cantidadTransaccionesQueryResult"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","attributes":[{"name":"times","value":{"type":"NUMBER","number":"6"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Sumatoria de las transacciones de los ultimos 6 meses para la entidad"}}]},{"uid":"ee7769cd-8913-4b97-b889-f97b3c226db2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Cálculo diferencia porcentual"}}]},{"uid":"8fb48503-2806-4815-a4e2-6e5c36b6dbc9","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$sumatoria$/6"}}],"returnTo":{"type":"VARIABLE","variableName":"promedio"}},{"uid":"487a7ba6-9c78-45d0-a6ae-20001a630480","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"($promedio$-$totalTransaccionesMes$)/$promedio$"}}],"returnTo":{"type":"VARIABLE","variableName":"diferenciaPorcentual"}},{"uid":"b6f643a5-29b0-4f45-b2a4-75d936d0d5fb","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Promedio: $sumatoria.Number:toString$/6 = $promedio.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b71188c0-cdc7-46c0-98bb-e9a8b0780c06","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Diferencia porcentual: ($promedio.Number:toString$-$totalTransaccionesMes.Number:toString$)/$promedio.Number:toString$ = $diferenciaPorcentual.Number:toString$\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"2dc6fcb4-bcda-4c10-b3d5-faf839298190","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ecaef7ed-6e1b-41eb-aee2-7eb4a6578bb0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"\n\nNo se generó el reporte para $entidad[1]$. La diferencia porcentual entre el promedio de los últimos 6 meses y el total de transacciones del $mes$ $año$, supera el 10%.\n \nTotal transacciones: $totalTransaccionesMes.Number:toString$\nPromedio de transacciones (6 meses): $promedio.Number:toString$\nDiferencia porcentual: (Promedio - Total transacciones)/Promedio = $diferenciaPorcentual.Number:toString$\n\n\n\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5d5c4270-54ec-41da-93ed-81b8b5609a23","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"pararProceso"}}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$diferenciaPorcentual$"}},{"name":"operator","value":{"type":"STRING","string":"GT"}},{"name":"value","value":{"type":"NUMBER","number":"0.10"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"entidad"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"entidades"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"b2e64952-d38a-4c45-8626-0ce45bfcf4b3","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"18203a6a-88a8-4562-bf8f-fa977aacb169","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$@rpaEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","string":"Apple report - Interrupción de generación de reportes"}},{"name":"fileList","value":{"type":"LIST","list":[{"type":"FILE","expression":"file://$log$"}]}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Se interrumpió el proceso de generación de reportes para la fecha $mes$ $año$, durante  la verificacion de cantidad de transacciones\nSe adjunta el log para mas detalle.\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}}]},{"uid":"fe43c8ad-8ff4-4c97-b486-9648a0fda4f7","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$pararProceso$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"sourceDateOption","value":{"type":"STRING","string":"DATETIME"}},{"name":"sourceDateTime","value":{"type":"DATETIME","expression":"$fechaActual$"}},{"name":"operator","value":{"type":"STRING","string":"GTE"}},{"name":"destDateOption","value":{"type":"STRING","string":"FIXED VALUE"}},{"name":"destFixedDate","value":{"type":"STRING","string":"01/06/2025"}},{"name":"destDateFormat","value":{"type":"STRING","string":"dd/MM/yyyy"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"dateVariable","packageName":"Datetime"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Verificación de nro de transacciones"}}]},{"uid":"f0a34c37-65bb-432b-868d-1c860ccc6531","commandName":"assign","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"LIST","list":[]}}],"returnTo":{"type":"VARIABLE","variableName":"listadoReportes"}},{"uid":"b9e03acf-3273-4040-994d-9a8ee837565e","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"08bd7514-d68e-473f-9431-334a5a70e5cf","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Generación de reporte para entidad $entidad[1]$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"659328dd-7dbc-4b15-b18d-c73130f08cdb","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filename$"}}],"returnTo":{"type":"VARIABLE","variableName":"filenameAux"}},{"uid":"e58b965b-3d0f-4645-bcb5-fd510d2acc21","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filenameAux$"}},{"name":"find","value":{"type":"STRING","string":"[entidad]"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$entidad[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"filenameAux"}},{"uid":"60c71d93-3282-4ce7-b535-0843815aaa02","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filenameAux$"}},{"name":"find","value":{"type":"STRING","string":"[fecha]"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$mes$ $año$"}}],"returnTo":{"type":"VARIABLE","variableName":"filenameAux"}},{"uid":"3cda1fa9-3400-4ba2-a1c1-ce6ef56c8d10","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$pathDestinoReportes$\\$entidad[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"pathDestino"}},{"uid":"de91fffe-6642-413a-9bc8-d3bf3340fea7","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"025ff89f-b04e-47e5-80a9-d40899f956c6","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$pathDestino$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$pathDestino$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"66b477cd-67b6-4b10-91f6-f94e147de66d","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$templateFile$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$pathDestino$\\$filenameAux$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isParallel","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ed5ca526-0b46-47d3-b263-032ac631ea3e","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"excelSourceOption","value":{"type":"STRING","string":"desktopfilepath"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$pathDestino$/$filenameAux$"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"excludeHiddenSheets","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsChart","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"},"sessionTarget":"LOCAL"}},{"uid":"83c7f25d-b1a7-43ee-aa7f-42c63c1434b2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Para cada hoja del excel"}}]},{"uid":"e9e9d994-ec16-4ffe-9262-087a93580ae4","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Se escriben los datos en la hoja correspondiente"}}]},{"uid":"6d5a034b-67ff-4316-bc24-cb632a5f9887","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"43fc252d-4aae-4a2d-ae74-43a085e980ca","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Metrics"}}],"returnTo":{"type":"VARIABLE","variableName":"hoja"}},{"uid":"db956039-1662-4190-bfe1-df73b8fd00cf","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select\nGRUPO, ITEM, VALOR, YYYYMM, COD_ENTIDAD, HOJA\nfrom\nODS.dbo.REPORTE_APPLE_FINAL\nwhere\nYYYYMM = $año$$mes$ and \nCOD_ENTIDAD =$entidad[0]$ \norder by \nGRUPO ASC, ITEM ASC;\n\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"resultadoConsulta"}},{"uid":"b19ae220-ee3b-455a-81d5-1efffadc7e39","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$hoja$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"05f0d399-a20d-431b-b547-8f640ee9716b","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"B1"}},{"name":"value","value":{"type":"STRING","expression":"$entidad[1]$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"ad5164d1-ed4b-4e99-a9bf-3876eeef47ca","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"B2"}},{"name":"value","value":{"type":"STRING","expression":"$nombreMes$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"69d06290-c78e-4c5b-9742-4d82d99a74cc","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"d3b4965a-2fa5-47ce-a637-bd553cc92ac8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"GRUPO"}},{"uid":"5c34869f-4781-408a-a67c-fa0f4191b1f7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"ITEM"}},{"uid":"744fc85e-d82c-4f3c-84fd-02d543058579","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}},{"uid":"d838afce-6f5e-48a2-a693-fd75a5bc3c58","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$ITEM$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcel"}},{"uid":"8d023ad3-7779-4e64-bbb7-37c038529c50","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":","}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}},{"uid":"9cc3481d-cdd2-4c9a-b6d9-4fd71ddb97b0","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3efc7426-3242-4eda-8329-0e2bea61eee9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Si el dato es porcentaje"}}]},{"uid":"4181429c-a33f-4f96-b49e-7d9a3365539b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$%"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$filaExcel.String:toNumber$"}},{"name":"operator","value":{"type":"STRING","string":"GTE"}},{"name":"value","value":{"type":"NUMBER","number":"9"}}],"operatorAttribute":{"operator":"AND","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"},"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$filaExcel.String:toNumber$"}},{"name":"operator","value":{"type":"STRING","string":"LTE"}},{"name":"value","value":{"type":"NUMBER","number":"14"}}]},"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"3645d6d2-b61d-4351-8aaf-0143d420f56f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"01148b1c-bd9c-4fc0-abfa-64d6781b79ad","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"B"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"branches":[{"uid":"ef882b4c-44fa-438d-8c51-d05e1002f06a","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"d5cb9846-bd3f-4770-85d4-b3e59dbb3c5d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$GRUPO$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"CREDIT"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"8220189a-6998-4738-911e-8aa6da1146df","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7ffff90b-deb7-4376-879a-600e64c425b3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"D"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$GRUPO$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"DEBIT"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"650c9014-b218-4fe3-acc0-7df50488c671","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colExcel$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$VALOR$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"resultadoConsulta"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Hoja METRICS"}}]},{"uid":"5edebfd5-ad57-426f-9b23-0c179ebff792","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"102cebde-4a6e-44e9-a73a-030aad65a579","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Declines"}}],"returnTo":{"type":"VARIABLE","variableName":"hoja"}},{"uid":"ee538681-8abb-49c7-831a-725658b59029","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select GRUPO, TX,TX_SIZE, VALOR,YYYYMM,HOJA\nfrom \nODS.dbo.REPORTE_APPLE_FINAL_DECLINES\nwhere\nYYYYMM =$año$$mes$ and \nCOD_ENTIDAD = $entidad[0]$\norder by GRUPO, TX, TX_SIZE;\n\n\n\n\n\n\n\n\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"resultadoConsulta"}},{"uid":"569af7e5-cbb6-4e8f-8a3d-b67ded49d24b","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$hoja$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"3fa79da9-5fdd-4fb0-81be-8d10bdf17a90","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"7"}}],"returnTo":{"type":"VARIABLE","variableName":"filaBase"}},{"uid":"914bc320-8c6f-4e71-b7d2-4484637c3f03","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"b07dc6f4-bcf9-4cc9-9310-92e0a2d47f6e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"GRUPO"}},{"uid":"35cd7ac8-40ee-469f-8f09-ec6a4ba0e57c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"TX"}},{"uid":"5e133a21-7d65-49ea-895c-7d0f2d021524","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$TableRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"TX_SIZE"}},{"uid":"e53347a7-4afc-458a-9b68-556b799eeb70","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[3]$"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}},{"uid":"7ca6cb23-25f4-409c-a06e-5dba7652f129","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":","}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}},{"uid":"a4056714-e13c-4a35-b67b-5dc793aaa0aa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a603a618-5f7c-4a04-9685-96231b70d2c9","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a5cfabaa-3be8-4f8b-9948-4620d81d3d32","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"B"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"branches":[{"uid":"e8540ac4-5632-4b20-b804-a4221073202d","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"38eafea8-a487-4fd2-b1a7-7c515dab99b1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TX$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"TOTAL_DECLINADAS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"eaf15e8e-c87e-403d-9fff-7c6fef59e9d3","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"57bc7f2c-ceab-436b-b610-fe3ad0090d28","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"TOTAL_TX_RATE"}}]},{"uid":"4108854f-a2ec-4406-ac93-1ec84ba27e66","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"D"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}},{"uid":"160d89e5-cd80-497c-8a04-f7e6ae93d1a8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$%"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TX$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"TOTAL_TX"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"eeffdb94-fa37-46ca-97fe-37edb4af8100","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"fcb60746-67bf-4b94-837e-94b96c38ab53","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"REMOTE"}}]},{"uid":"2e4c5c2c-a619-4144-ba98-cdd21cbc61c4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ac26a6e8-aa07-4d24-a5b1-a5dc57b16f9e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"F"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"branches":[{"uid":"b475549b-f5f9-4038-9dd8-ff6ea446a84d","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"8fef3436-4c11-4b5c-b1ed-1c4fd21ab9f0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"G"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TX$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"TOTAL_DECLINADAS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"b24d0f19-7ffd-48f4-aab5-82a22fc55368","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"c76dc4a2-96d6-48a6-8f8a-4e3c5d9664e6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"TOTAL_TX_RATE"}}]},{"uid":"6a266641-d8ae-4a43-9678-447a4656efab","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"H"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}},{"uid":"1a2f933c-c9ae-434d-985f-ec9106196db7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR$%"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$TX$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"TOTAL_TX"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$GRUPO$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"POS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"c8eaaaca-efe7-4786-a70a-bb1dcb6b85b1","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$filaBase$+$TX_SIZE$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcelNum"}},{"uid":"f3e662ee-1492-457a-a5bb-5a30c7c4534d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaExcelNum.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcel"}},{"uid":"ad2e78bb-566f-4619-ae59-5cf72a08c3c5","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colExcel$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$VALOR$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"resultadoConsulta"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"828ff7b9-2e64-4748-bca3-f9c80e1d7177","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Hoja DECLINES"}}]},{"uid":"aeaf16a7-b0b7-4f17-9553-5e4f3caea714","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6a6c0fc8-5955-4976-9fe6-cd94a64cd3b7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Usage Frequency"}}],"returnTo":{"type":"VARIABLE","variableName":"hoja"}},{"uid":"05f511e4-c917-4428-8507-2fc10b029cda","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select \nGRUPO, CATEGORIA, CANTIDAD, YYYYMM, COD_ENTIDAD, HOJA \nfrom \nODS.dbo.REPORTE_APPLE_FINAL_FREQUENCY\nWHERE \nYYYYMM = $año$$mes$ and COD_ENTIDAD = $entidad[0]$\norder by CATEGORIA asc;\n\n\n\n\n\n\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"resultadoConsulta"}},{"uid":"34be2838-13c0-45f0-88ca-1c81c2415cdd","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$hoja$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"c878aa88-2a1d-4a18-a126-f2948812c028","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"8"}}],"returnTo":{"type":"VARIABLE","variableName":"filaBase"}},{"uid":"702555e6-b5b1-4bdb-9a61-aac15acee3ee","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"7dea319e-7a2e-4c5d-b0f4-706c5727d382","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$TableRow[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"CATEGORIA"}},{"uid":"bbce9f89-3275-4bb0-be56-842c6bbd6055","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$TableRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"CANTIDAD"}},{"uid":"bb5ebffa-551c-440b-923d-3b9404572baf","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"D"}}],"returnTo":{"type":"VARIABLE","variableName":"colExcel"}},{"uid":"9f7c5c67-8c45-42b5-b01f-03fa78338a65","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$filaBase$+$CATEGORIA$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcelNum"}},{"uid":"6a6c7998-f883-498c-9ba5-c7862e0a22ab","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaExcelNum.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcel"}},{"uid":"3e1fb499-64d2-479e-8790-4d0631c232e1","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colExcel$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$CANTIDAD.Number:toString$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"resultadoConsulta"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"b7a15c72-6889-4840-881b-2cbcec84c835","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Hoja USAGE FRECUENCY"}}]},{"uid":"f02e0f0b-c548-4189-8f92-be2ad8b2f2a8","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5a70ba2a-3d0b-4a64-83c9-407639f95f42","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"AMR_TopMerchants"}}],"returnTo":{"type":"VARIABLE","variableName":"hoja"}},{"uid":"fbb85158-efb8-4dd2-b02f-c7655d181168","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"query","value":{"type":"STRING","expression":"select \nGRUPO, ITEM, DENOMINACION_MERCHANT, COUNT_TX, VALOR_TX \nfrom \nODS.dbo.REPORTE_APPLE_TOP_MERCHANTS\nWHERE \nYYYYMM = $año$$mes$ and COD_ENTIDAD = $entidad[0]$\norder by GRUPO asc, ITEM asc;\n\n\n\n"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"resultadoConsulta"}},{"uid":"e7520f15-8b19-4551-aee2-ccb763a02b9c","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","expression":"$hoja$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"7761789c-a4b7-4c4d-9899-71be93af0fbc","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"8"}}],"returnTo":{"type":"VARIABLE","variableName":"filaRankBase"}},{"uid":"d3ad1316-ca86-4374-9bf9-b578821d2993","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"c7e0843d-b889-4374-b04b-b02276920408","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"GRUPO"}},{"uid":"33943045-5098-4ac8-84e7-ad8ce8b0b0a7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"ITEM"}},{"uid":"35281b03-623a-4304-abc4-5f4ca977818c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"DENOMINACION"}},{"uid":"f2009bc2-ab84-4eca-9d5e-b50f4c5f545c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[3]$"}}],"returnTo":{"type":"VARIABLE","variableName":"COUNT_TX"}},{"uid":"571c6448-4bb1-4833-83c4-359856d53c99","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$TableRow[4]$"}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR_TX"}},{"uid":"ebfad5f0-df91-4744-9fe2-9ea68e11595a","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$COUNT_TX$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":","}}],"returnTo":{"type":"VARIABLE","variableName":"COUNT_TX"}},{"uid":"21cd39b7-a0b1-4803-9712-cbf05f281483","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$COUNT_TX$"}},{"name":"find","value":{"type":"STRING","string":",00"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"COUNT_TX"}},{"uid":"e4658713-821f-432d-9fbf-66c60e30d632","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$VALOR_TX$"}},{"name":"find","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":","}}],"returnTo":{"type":"VARIABLE","variableName":"VALOR_TX"}},{"uid":"6898e070-f5d6-4b00-b406-3ebb8d719d6f","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$DENOMINACION$"}},{"name":"find","value":{"type":"STRING","string":"\\s+"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":" "}}],"returnTo":{"type":"VARIABLE","variableName":"DENOMINACION"}},{"uid":"f2640ba7-901c-4cbe-aacc-36e821d63b4e","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ab1fb587-0e86-44b5-9e0f-eec0921c8c2d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"B"}}],"returnTo":{"type":"VARIABLE","variableName":"colMerchantName"}},{"uid":"48f1e953-9f92-4075-a409-53f51d1613fa","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C"}}],"returnTo":{"type":"VARIABLE","variableName":"colTransactionCount"}},{"uid":"1e9e647e-c020-4cf8-a39d-f2161e30c0c0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"D"}}],"returnTo":{"type":"VARIABLE","variableName":"colSpendAmout"}}],"branches":[{"uid":"9b44e46c-407c-48e9-8646-452b62bcfbff","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"804163fc-02e3-4d55-ba51-d731fe7a9021","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"DEBIT"}}]},{"uid":"d9d5305e-8486-40c9-80a5-4d97de98ff85","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"G"}}],"returnTo":{"type":"VARIABLE","variableName":"colMerchantName"}},{"uid":"4af42707-00a2-4bbf-b1bf-c4325a7612ae","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"H"}}],"returnTo":{"type":"VARIABLE","variableName":"colTransactionCount"}},{"uid":"3aa051e8-ffb0-4cd2-b546-14b6a14669a8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"I"}}],"returnTo":{"type":"VARIABLE","variableName":"colSpendAmout"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$GRUPO$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"CREDIT"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"dd5b2242-c569-46b4-964a-51a739e58f38","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$filaRankBase$+$ITEM.String:toNumber$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcelNum"}},{"uid":"e9dbd82f-0c27-4084-9598-a26a7f9ea52a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$filaExcelNum.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"filaExcel"}},{"uid":"ffeea6a2-e048-4de5-9dc5-da0245dd2337","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colMerchantName$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$DENOMINACION$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"5bad4c91-af44-4819-92e1-62731c7125cf","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colTransactionCount$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$COUNT_TX$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"29b584d2-a047-4f3d-a051-9473576753dc","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"$colSpendAmout$$filaExcel$"}},{"name":"value","value":{"type":"STRING","expression":"$VALOR_TX$"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"TableRow"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"resultadoConsulta"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"8611524f-7288-489c-a2b4-3d2b7e6c1adf","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Hoja TO MERCHANTS"}}]},{"uid":"c1115e03-fea0-4351-82a1-01f9b21895d2","commandName":"SwitchToSheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"sheetOption","value":{"type":"STRING","string":"BYNAME"}},{"name":"sheetName","value":{"type":"STRING","string":"Metrics"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"05baeb28-55ee-4b07-945e-a668dc7231ff","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"b6076520-7c43-4906-85d7-49e07f31acf4","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"excelSession"}}}]},{"uid":"291573c4-8c12-464c-af12-c4c967f5e794","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Copia de archivo para historial"}}]},{"uid":"d31d8719-ef85-4883-8eef-b6a8dcf84262","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$pathDestino$/$filenameAux$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$pathHistorial$/$filenameAux$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isParallel","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"9ef6882d-4c6c-47d4-b298-3a056900249a","commandName":"assign","packageName":"File","disabled":false,"attributes":[{"name":"sourceFile","value":{"type":"FILE","expression":"file://$pathDestino$/$filenameAux$"}}],"returnTo":{"type":"VARIABLE","variableName":"reporteFile"}},{"uid":"bb4af957-4542-4941-a513-758a0e5a6fd3","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"listadoReportes"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"reporteFile"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"entidad"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"entidades"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]},{"uid":"b8acd649-cb53-4943-b08d-e235051b45c9","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"dosaveData","value":{"boolean":false,"type":"BOOLEAN"}},{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}}]},{"uid":"dc33d904-5e8d-4868-8c7c-64f7eef8e152","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Generación de reportes de fecha $año$-$mes$ finalizado con éxito"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b05a2936-e5d8-4332-be0f-e43419fb19fc","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$@rpaEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","expression":"Apple report - Reportes $mes$ $año$"}},{"name":"fileList","value":{"type":"LIST","expression":"$listadoReportes$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Se generaron los reportes de fecha $mes$-$año$ y fueron depositados en \"$pathDestinoReportes$\".\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Consulta y llenado del excel"}}]}],"branches":[{"uid":"9c42efdb-536d-413b-a736-f2ac0b4c53f8","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"6050965e-013c-4434-a39c-fed790b42474","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Error en línea $ErrorLineNumber.Number:toString$. $ErrorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"301a6e0c-837f-46f1-814b-c5d2e0b12d3f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$log$"}},{"name":"logContent","value":{"type":"STRING","expression":"Generación de reportes de fecha $año$-$mes$, finalizado con error"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4e4117e1-8517-4f26-ab8a-26bfccff8a70","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"7dc12b81-be62-495b-8fb9-de48c7fd12f8","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$@rpaEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","string":"Apple report - Error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Linea: $ErrorLineNumber.Number:toString$\nError: $ErrorMessage$ "}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}}]}],"branches":[{"uid":"d42984d8-20d6-42ac-8534-a1fb818d292c","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"a46afa95-154e-49fd-a240-fd22ac60674b","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Error en línea $ErrorLineNumber.Number:toString$. $ErrorMessage$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"7"}}]},{"uid":"e10d353b-5780-4c99-91f5-6ba0622b9dfd","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$@rpaEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","string":"[Test] Apple report - Error"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Linea: $ErrorLineNumber.Number:toString$\nError: $ErrorMessage$ "}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}},{"name":"fromAddress","value":{"type":"STRING","string":"noreply@bancard.com.py"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerAuthType","value":{"type":"STRING","string":"Basic"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$entorno$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"prd"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"e8e008db-3249-4e9b-a51c-8986697a49ec","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0c019c74-42ec-4e35-8a04-e738579b6f8f","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e2c78e96-ac6c-4774-b3aa-68bf411692d2","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"dosaveData","value":{"boolean":false,"type":"BOOLEAN"}},{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}}]}],"branches":[{"uid":"510ebea9-fbc0-40c7-a492-d9df7e4271a5","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Cierre de conexión a base de datos"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"path","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"templateFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"año","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mes","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"filename","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ip","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"resultadoConsulta","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"hojas","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"hoja","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pathDestino","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"filenameAux","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"Fila","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"dummy","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"TableRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"filaExcel","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"colExcel","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"entorno","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"entidades","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"entidad","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"celdaExcel","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"celdasExcel","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"GRUPO","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"TX","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"tx_","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"TX_SIZE","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"CATEGORIA","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"CANTIDAD","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"ITEM","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"VALOR","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"DENOMINACION","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"COUNT_TX","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"VALOR_TX","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"colMerchantName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"colTransactionCount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"colSpendAmout","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"filaRankBase","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"filaExcelNum","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"filaBase","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"logFilename","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"logPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"logDummyName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"log","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dia","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mesNumerico","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"añoNumerico","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"nombreMes","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"pathDestinoReportes","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"diaActual","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"archivo","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"pathHistorial","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"listadoReportes","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"FILE","defaultValue":{"type":"LIST","list":[]}},{"name":"reporteFile","description":"","type":"FILE","readOnly":false,"input":false,"output":false},{"name":"currentDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sumatoria","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"fechaActual","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"fechaBusqueda","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"fechaConsulta","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"cantidadTransaccionesQueryResult","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"cantidadTransaccionesRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"cantidadTransacciones","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"promedio","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"totalTransaccionesMes","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"diferenciaPorcentual","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"pararProceso","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"fechaStr","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"packages":[{"name":"Boolean","version":"2.11.0","settingsAttributes":[]},{"name":"Comment","version":"2.16.0","settingsAttributes":[]},{"name":"Database","version":"5.4.0","settingsAttributes":[]},{"name":"DataTable","version":"4.12.1","settingsAttributes":[]},{"name":"Datetime","version":"2.15.0","settingsAttributes":[]},{"name":"Email","version":"3.23.2","settingsAttributes":[]},{"name":"ErrorHandler","version":"2.12.1-20231117-175338","settingsAttributes":[]},{"name":"Excel_MS","version":"6.20.0","settingsAttributes":[]},{"name":"File","version":"6.11.0","settingsAttributes":[]},{"name":"Folder","version":"6.11.0","settingsAttributes":[]},{"name":"If","version":"3.7.14-20231116-000453","settingsAttributes":[]},{"name":"List","version":"2.13.0","settingsAttributes":[]},{"name":"LogToFile","version":"3.8.0","settingsAttributes":[]},{"name":"Loop","version":"3.8.1-20231117-175130","settingsAttributes":[]},{"name":"MessageBox","version":"3.7.0","settingsAttributes":[]},{"name":"Number","version":"3.9.1","settingsAttributes":[]},{"name":"Step","version":"2.6.0","settingsAttributes":[]},{"name":"String","version":"5.10.0","settingsAttributes":[]},{"name":"System","version":"3.14.0","settingsAttributes":[]},{"name":"TaskBot","version":"2.8.0-20230530-152744","settingsAttributes":[]}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"6","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}